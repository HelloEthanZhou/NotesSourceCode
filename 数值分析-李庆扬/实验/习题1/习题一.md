**姓名：周梦轩**

**班级：数学212**

**学号：212483**

# 习题一

## 第一题

已知区间$[-1,1]$，Runge函数$\displaystyle f(x)=\frac{1}{1+25x^2}$，分别取$n=6$和$n=10$。

用区间$n$等分产生的等距节点对作Newton插值，要求对每个$n$，画出插值多项式和函数$f(x)$的曲线。

用$n+1$次Chebyshev多项式的零点为插值节点，作Newton插值，要求对每个$n$，画出插值多项式和函数$f(x)$的曲线。

解：差商公式为
$$
f[x_0,\cdots,x_n]=\sum_{i=0}^{n}\frac{f(x_i)}{\displaystyle\prod_{j\ne i}(x_i-x_j)}
$$
Newton插值公式为
$$
P_n(x)=f(x_0)+\sum_{i=1}^{n}f[x_0,\cdots,x_{i}]\prod_{j=0}^{i-1}(x-x_j)
$$
Chebyshev多项式$C_{n+1}$的$n+1$个零点为
$$
x_k=\cos\frac{2k+1}{2(n+1)}\pi
$$
其中$k=0,\cdots,n$。

定义差商函数

```matlab
function result = dividedDifference(fun, points)

    % 名称：差商
    % 输入：
    %      fun：   匿名函数
    %      points：需要求解差商的点
    % 输出：
    %      result：差商值

    %% 函数

    % 初始化结果
    result = 0;

    % 外层循环
    for i = 1: length(points)
        % 初始化积
        product = 1;
        % 内层循环
        for j = 1: length(points)
            if j ~= i
                product = product * (points(i) - points(j));
            end
        end
        result = result + fun(points(i)) / product;
    end

end

```

Newton插值函数

```matlab
function NewtonInterpolationFormula(fun, a, b, points)

    % 名称：          Newton插值公式
    % 输入：
    %      fun：      匿名函数
    %      a：        插值左端点
    %      b：        插值右端点
    %      points：   插值节点
    % 输出：          插值图像

    %% 函数

    % 横坐标
    x = linspace(a, b, 1000);
    
    % 初始化纵坐标
    y = fun(a);
    % 求和
    for i = 1: length(points) - 1
        % 求解差商
        dividedDif = dividedDifference(fun, points(1: i + 1));
        % 初始化积
        prod = 1;
        % 求积
        for j = 0: i-1
            prod = prod .* (x - points(j + 1));
        end
        y = y + dividedDif .* prod;
    end

    % 绘图
    figure
    plot(x, y, x, fun(x))

end

```

主函数

```matlab
clear; clc

% 定义函数
fun = @(x) 1 ./ (1 + 25 .* x .^ 2);
a = -1;
b = 1;

% n=6时等距节点Newton插值
n = 6;
points = 0: n;
points = a + (b - a) / n .* points;
NewtonInterpolationFormula(fun, a, b, points)
title('等距节点Newton插值')
legend('等距节点Newton插值图像','原图像')

% n=10时等距节点Newton插值
n = 10;
points = 0: n;
points = a + (b - a) / n .* points;
NewtonInterpolationFormula(fun, a, b, points)
title('等距节点Newton插值')
legend('等距节点Newton插值图像','原图像')

% n=6时Chebyshev节点Newton插值
n = 6;
points = 0: n;
points = cos((2 .* points + 1) ./ (2 * (n + 1)) .* pi);
NewtonInterpolationFormula(fun, a, b, points)
title('Chebyshev节点Newton插值')
legend('Chebyshev节点Newton插值图像','原图像')

% n=10时Chebyshev节点Newton插值
n = 10;
points = 0: n;
points = cos((2 .* points + 1) ./ (2 * (n + 1)) .* pi);
NewtonInterpolationFormula(fun, a, b, points)
title('Chebyshev节点Newton插值')
legend('Chebyshev节点Newton插值图像','原图像')

```

$n=6$时等距节点Newton插值输出图像

![n=6 等距节点Newton插值](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题1\第一题\n=6 等距节点Newton插值.svg)

$n=10$时等距节点Newton插值输出图像

![n=10 等距节点Newton插值](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题1\第一题\n=10 等距节点Newton插值.svg)

$n=6$时Chebyshev节点Newton插值输出图像

![n=6 Chebyshev节点Newton插值](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题1\第一题\n=6 Chebyshev节点Newton插值.svg)

$n=10$时等Chebyshev节点Newton插值输出图像

![n=10 Chebyshev节点Newton插值](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题1\第一题\n=10 Chebyshev节点Newton插值.svg)

## 第二题

下列数据点的插值

|  $x_k$   | $0.001$ | $1$  | $8$  | $27$ | $64$ | $125$ | $216$ |
| :------: | :-----: | :--: | :--: | :--: | :--: | :---: | :---: |
| $f(x_k)$ |  $0.1$  | $1$  | $2$  | $3$  | $4$  |  $5$  |  $6$  |

可以得到立方根函数$f(x)=\sqrt[3]{x}$的近似函数， 要求用上述$7$个点作$6$次插值多项式$L_6(x)$，画出的曲线$L_6(x)$，并计算$\sqrt[3]{100}$的近似值。

解：定义多项式插值函数

```matlab
function fun = polynomialInterpolationFormula(x0, y0)

    % 名称：          多项式插值公式
    % 输入：
    %      x0：       插值点横坐标
    %      y0：       插值点纵坐标
    % 输出：          多项式插值公式

    %% 函数

    N = length(x0);

    % 初始化系数矩阵
    A = ones(N, N);
    for n = 2: N
        A(n, :) = x0 .^ (n-1); 
    end
    A = A';

    % 求解系数
    coefficient = A \ y0';

    % 输出多项式插值函数
    syms x
    fun = coefficient(1);
    for n = 2: N
        fun = fun + coefficient(n) .* x .^ (n - 1);
    end
    fun = matlabFunction(fun);

end

```

定义主函数

```matlab
clear; clc

% 定义函数
fun = @(x) x .^ (1 / 3);

% 定义插值点
x0 = [0.001, 1, 8, 27, 64, 125, 216];
y0 = fun(x0);

% 求解插值公式
fun = polynomialInterpolationFormula(x0, y0);

% 求解插值
x = linspace(0, 220, 1000);
y = fun(x);

% 求解近似值
fprintf('100^(1/3)的近似值为：%.3f', fun(100 ^ (1 / 3)))

% 绘图
figure
plot(x, y)
hold on
plot(x0, y0, 'bo', 'MarkerSize', 5, 'MarkerFaceColor', 'r')
hold off

```

输出结果

100^(1/3)的近似值为：2.373

输出图像

![Q2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题1\第二题\Q2.svg)

## 第三题

已知函数在下列各点的值为

| $x_i$ | $0.2$  | $0.4$  | $0.6$  | $0.8$  | $1.0$  |
| :---: | :----: | :----: | :----: | :----: | :----: |
| $y_i$ | $0.98$ | $0.92$ | $0.81$ | $0.64$ | $0.39$ |

要求给出在自然边界条件下的三次样条插值多项式$S(x)$的表达式，并由插值多项式分别计算节点$x_k^*=0.2+0.08k$的近似值，其中$k=1,3,7,9,11$。

解：MatLab代码如下

```matlab
clear;clc
% 已知数据点
x = [0.2, 0.4, 0.6, 0.8, 1.0];
y = [0.98, 0.92, 0.81, 0.64, 0.39];

% 计算三次样条插值多项式的系数
cubicSplineInterpolation = spline(x, [0, y, 0]);

% 显示插值多项式的系数
disp(round(cubicSplineInterpolation.coefs, 2))

```

输出结果

```matlab
  2.61          -2.02           0            0.98
  0.92          -0.46          -0.5          0.92
- 7.52           0.09          -0.57         0.81
 26.67          -4.42          -1.43         0.64
```

因此三次样条插值函数为
$$
S(x)=\begin{cases}
2.61-2.02(x-0.2)+0.98(x-0.2)^3,\qquad & x<0.4\\
0.92-0.46(x-0.4)-0.5(x-0.4)^2+0.92(x-0.4)^3,\qquad & 0.4\le x<0.6\\
-7.52+0.09(x-0.6)-0.57(x-0.6)^2+0.81(x-0.6)^3,\qquad & 0.6\le x<0.8\\
26.67-4.42(x-0.8)-1.43(x-0.8)+0.64(x-0.8)^3,\qquad & x\ge 0.8
\end{cases}
$$
代入数据
$$
\small{
S(x_1^*)=2.45,\qquad
S(x_3^*)=0.90,\qquad
S(x_7^*)=-7.52,\qquad
S(x_9^*)=25.97,\qquad
S(x_{11}^*)=25.05
}
$$

## 第四题

下列数据点

| $x_i$ | $0$      |   $1$    |    $2$    |    $3$    |    $4$    |   $5$    | $6.2832$ |
| :---: | -------- | :------: | :-------: | :-------: | :-------: | :------: | :------: |
| $y_i$ | $1.0000$ | $0.5403$ | $-0.4161$ | $-0.9900$ | $-0.6536$ | $0.2837$ | $1.0000$ |

是根据$y=\cos x$给出的，要求用上述数据在周期边界条件下作三次样条插值，并计算$x=1.5$和$x=1.8$时的近似值。

解：MatLab代码如下

```matlab
clear; clc
% 给定数据点
x0 = [0, 1, 2, 3, 4, 5, 6.2832];
y0 = [1.0000, 0.5403, -0.4161, -0.9900, -0.6536, 0.2837, 1.0000];

% 为了满足周期边界条件，将第一个点和最后一个点连接起来
x0 = [x0, x0(1) + 2*pi];
y0 = [y0, y0(1)];

% 进行三次样条插值，使用周期边界条件
cubicSplineInterpolation = csape(x0, y0, 'periodic');

% 计算在x=1.5和x=1.8时的近似值
x = [1.5, 1.8];
y = ppval(cubicSplineInterpolation, x);

% 输出结果
fprintf('cos1.5为：%.3f\n', y(1))
fprintf('cos1.8为：%.3f', y(2))

```

输出结果

cos1.5为：0.071

cos1.8为：-0.228