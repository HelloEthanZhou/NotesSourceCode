# 习题二

## 第一题

已知函数$y=f(x)$在下列各点的值为

| $x_i$ |  $-1$  | $-0.75$  | $-0.5$ |  $0$   |  $0.25$  | $0.5$  |  $0.75$  |
| :---: | :----: | :------: | :----: | :----: | :------: | :----: | :------: |
| $y_i$ | $1.00$ | $0.8125$ | $0.75$ | $1.00$ | $1.3125$ | $1.75$ | $2.3125$ |

根据最小二乘法，分别用一次、二次、三次多项式拟合上述数据，画出所给数据点和最小二乘拟合多项式的图像。

解：代码如下

```matlab
clear; clc

%% 准备数据

% 输入原始数据
x0 = [-1, -0.75, -0.5, 0, 0.25, 0.5, 0.75];
y0 = [1.00, 0.8125, 0.75, 1.00, 1.3125, 1.75, 2.3125];

%% 计算最小二乘拟合多项式系数

% 利用polyfit函数，分别用一、二、三次多项式对数据点进行最小二乘拟合
p1 = polyfit(x0, y0, 1); % 一次多项式的系数向量
p2= polyfit(x0, y0, 2); % 二次多项式的系数向量
p3 = polyfit(x0, y0, 3); % 三次多项式的系数向量

% 输出拟合多项式的系数
disp('一次多项式的系数向量为：')
disp(p1)
disp('二次多项式的系数向量为：')
disp(p2)
disp('三次多项式的系数向量为：')
disp(p3)

%%  绘图

% 计算拟合曲线的值
x = linspace(-1.25, 1, 1000);
y1 = polyval(p1, x);
y2 = polyval(p2, x);
y3 = polyval(p3, x);

% 绘制图形
figure
plot(x, y1, 'b-') % 一次拟合曲线，蓝色实线
hold on
plot(x, y2, 'r--') % 二次拟合曲线，红色虚线
plot(x, y3, 'g-.') % 三次拟合曲线，绿色点划线
plot(x0, y0, 'k+') % 原始数据点，黑色加号
hold off

% 添加图例，标题和网格线
legend('一次拟合曲线', '二次拟合曲线', '三次拟合曲线', '原始数据点')
title('多项式拟合')
grid on

%% 计算误差

% 计算一次拟合曲线的均方误差、最大绝对误差、平均绝对误差
mse1 = mean((y0 - polyval(p1, x0)).^2); % 均方误差
mae1 = max(abs(y0 - polyval(p1, x0))); % 最大绝对误差
mape1 = mean(abs(y0 - polyval(p1, x0))); % 平均绝对误差

% 计算二次拟合曲线的均方误差、最大绝对误差、平均绝对误差
mse2 = mean((y0 - polyval(p2, x0)).^2); % 均方误差
mae2 = max(abs(y0 - polyval(p2, x0))); % 最大绝对误差
mape2 = mean(abs(y0 - polyval(p2, x0))); % 平均绝对误差

% 计算三次拟合曲线的均方误差、最大绝对误差、平均绝对误差
mse3 = mean((y0 - polyval(p3, x0)).^2); % 均方误差
mae3 = max(abs(y0 - polyval(p3, x0))); % 最大绝对误差
mape3 = mean(abs(y0 - polyval(p3, x0))); % 平均绝对误差

% 输出结果
disp('一次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：')
disp([mse1 mae1 mape1])
disp('二次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：')
disp([mse2 mae2 mape2])
disp('三次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：')
disp([mse3 mae3 mape3])
```

输出结果如下

```matlab
一次多项式的系数向量为：
         0.732876712328767          1.35530821917808

二次多项式的系数向量为：
                         1                         1                         1

三次多项式的系数向量为：
     -9.74992473134766e-17                         1                         1                         1

一次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：
        0.0776969178082192         0.407534246575342         0.234344422700587

二次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：
      2.46519032881566e-32      3.33066907387547e-16      9.51619735392991e-17

三次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：
       1.5847652113815e-32      2.22044604925031e-16      7.93016446160826e-17
```

输出图像如下

![Q1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题2\Q1.svg)

## 第二题

已知一组实验数据如下

| $x_k$ |  $0.0$  |  $0.2$  |  $0.5$  |  $0.7$  | $0.85$  |  $1.0$  |
| :---: | :-----: | :-----: | :-----: | :-----: | :-----: | :-----: |
| $y_k$ | $1.000$ | $1.221$ | $1.649$ | $2.014$ | $2.340$ | $2.718$ |
| $w_k$ |  $0.1$  |  $0.2$  |  $0.3$  |  $0.1$  |  $0.2$  |  $0.1$  |

求二次最小二乘拟合多项式，并计算均方误差。

解：定义加权最小二乘函数

```matlab
function c = weightedLeastSquaresFit(x, y, w, n)

    % 名称：  加权最小二乘拟合
    % 输入：
    %      x：拟合点横坐标
    %      y：拟合点纵坐标
    %      w：拟合权重
    %      n：拟合多项式次数
    % 输出：
    %      c：拟合多项式系数

    %% 函数

    % 计算系数矩阵
    A = zeros(n + 1, n + 1);
    b = zeros(n + 1, 1);
    for i = 1: n + 1
        b(i) = sum(w .* y .* x .^ (i - 1));
        for j = 1: n + 1
            A(i, j) = sum(w .* x .^ (i + j - 2));
        end
    end
    % 求解多项式系数
    c = A \ b;

end
```

主函数

```matlab
clear; clc

%% 准备数据

% 输入原始数据
x0 = [0.0, 0.2, 0.5, 0.7, 0.85, 1.0];
y0 = [1.000, 1.221, 1.649, 2.014, 2.340, 2.718];
w = [0.1, 0.2, 0.3, 0.1, 0.2, 0.1];

%%  计算加权最小二乘拟合多项式系数
n = 2; % 拟合多项式次数
c = weightedLeastSquaresFit(x0, y0, w, n);
% 输出拟合多项式的系数
disp('二次多项式的系数向量为：')
disp(c)

%%  绘图

% 计算拟合曲线的值
x = linspace(-0.25, 1.25, 1000);
y = c(1) * ones(1, 1000);
for k = 1: n
    y = y + c(k) * x .^ k;
end

% 绘制图形
figure
plot(x, y, 'b-') % 二次拟合曲线，蓝色实线
hold on
plot(x0, y0, 'k+') % 原始数据点，黑色加号
hold off

% 添加图例，标题和网格线
legend('二次拟合曲线', '原始数据点')
title('加权多项式拟合')
grid on

%% 计算误差

% 计算二次拟合曲线的均方误差、最大绝对误差、平均绝对误差
m = size(x0, 2);
y = c(1) * ones(1, m);
for k = 1: n
    y = y + c(k) * x0 .^ k;
end
mse2 = mean((y0 - y.^2)); % 均方误差
mae2 = max(abs(y0 - y)); % 最大绝对误差
mape2 = mean(abs(y0 - y)); % 平均绝对误差

% 输出结果
disp('二次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：')
disp([mse2 mae2 mape2])

```

输出结果如下

```matlab
二次多项式的系数向量为：
          1.00876388907147
         0.858131088382626
         0.840708191462776

二次拟合曲线的均方误差、最大绝对误差、平均绝对误差为：
         -2.27010629254655         0.157658866525572        0.0894231704314411
```

输出图像如下

![Q2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题2\Q2.svg)

## 第三题

设$f(x)=\sin\pi x$，利用Legendre多项式分别求次数为$2,3,4$的多项式$p(x)$，使得$\displaystyle\int_0^1(f(x)-p(x))^2\mathrm{d}x$达到最小，并画出$f(x)$和$p(x)$的曲线进行比较。

解：定义加权平方逼近多项式拟合函数

```matlab
function c = weightedSquaresApproximatePolynomialFit(fun, rho, n, a, b)

    % 名称：  加权平方逼近多项式拟合
    % 输入：
    %      fun：拟合函数
    %      rho：拟合权重
    %      n：拟合多项式次数
    %      a：拟合左边界
    %      b：拟合右边界
    % 输出：
    %      c：拟合多项式系数

    %% 函数

    % 计算系数矩阵
    A = zeros(n + 1, n + 1);
    B = zeros(n + 1, 1);
    for i = 1: n + 1
        B(i) = integral(@(x) rho(x) .* fun(x) .* x .^ (i - 1), a, b);
        for j = 1: n + 1
            A(i, j) = integral(@(x) rho(x) .* x .^ (i + j - 2), a, b);
        end
    end
    % 求解多项式系数
    c = A \ B;

end
```

主函数

```matlab
clear; clc

%% 准备数据

% 输入原始函数
fun = @(x) sin(pi * x);
rho = @(x) 1;
a = 0;
b = 1;

%% 计算拟合多项式系数
c2 = weightedSquaresApproximatePolynomialFit(fun, rho, 2, a, b);
c3 = weightedSquaresApproximatePolynomialFit(fun, rho, 3, a, b);
c4 = weightedSquaresApproximatePolynomialFit(fun, rho, 4, a, b);

% 输出拟合多项式的系数
disp('二次多项式的系数向量为：')
disp(c2)
disp('三次多项式的系数向量为：')
disp(c3)
disp('四次多项式的系数向量为：')
disp(c4)

%%  绘图

% 计算拟合曲线的值
x = linspace(0, 1, 1000);

y2 = c2(1) * ones(1, 1000);
for k = 1: 2
    y2 = y2 + c2(k) * x .^ k;
end

y3 = c3(1) * ones(1, 1000);
for k = 1: 3
    y3 = y3 + c3(k) * x .^ k;
end

y4 = c4(1) * ones(1, 1000);
for k = 1: 4
    y4 = y4 + c4(k) * x .^ k;
end

% 绘制图形
figure
plot(x, fun(x))    % 原始曲线
hold on
plot(x, y2, 'b-')  % 二次拟合曲线，蓝色实线
plot(x, y3, 'r--') % 三次拟合曲线，红色虚线
plot(x, y4, 'g-.') % 四次拟合曲线，绿色点划线
hold off

% 添加图例，标题和网格线
legend('原始曲线', '二次拟合曲线', '三次拟合曲线', '四次拟合曲线')
title('平方逼近多项式拟合')
grid on

```

输出结果

```matlab
二次多项式的系数向量为：
       -0.0504654977784496
          4.12251162087619
         -4.12251162087619

三次多项式的系数向量为：
       -0.0504654977784651
          4.12251162087637
         -4.12251162087665
      3.06005221162348e-13

四次多项式的系数向量为：
         0.001313455897898
          3.08693254734936
         0.537594209994186
         -7.24905351468689
          3.62452675734332
```

输出图像

![Q3](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大三上\数值分析\实验\习题2\Q3.svg)
