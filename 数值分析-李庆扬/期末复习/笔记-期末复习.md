# 第一章：引论

**数值运算的误差估计**：对于两个近似值$x^*$和$y^*$，误差限分别为$\varepsilon(x^*)$和$\varepsilon(y^*)$，那么
$$
\begin{align}
&\varepsilon(x^*\pm y^*)\le\varepsilon(x^*)+\varepsilon(y^*)\\
&\varepsilon(x^*y^*)\le|x^*|\varepsilon(y^*)+|y^*|\varepsilon(x^*)\\
&\varepsilon(x^*/y^*)\le\frac{|x^*|\varepsilon(y^*)+|y^*|\varepsilon(x^*)}{|y^*|^2}\\
&\varepsilon(f(x^*))\le|f'(x^*)|\varepsilon(x^*)\\
&\varepsilon(f(x^*,y^*))\le|f'_1(x^*,y^*)|\varepsilon(x^*)+|f'_2(x^*,y^*)|\varepsilon(y^*)
\end{align}
$$

**稳定性**：对于一个数值方法，如果输入数据有误差，且在计算过程中舍入误差不显著增长，那么称此算法为稳定的，否则称为不稳定的。

# 第二章：插值法

## 2.1	Lagrange插值

**线性插值函数**：
$$
L_1(x)=\frac{x-x_1}{x_0-x_1}f(x_0)+\frac{x-x_0}{x_1-x_0}f(x_1)
$$

**抛物线插值函数**：
$$
L_2(x)=\frac{(x-x_2)(x-x_3)}{(x_1-x_2)(x_1-x_3)}f(x_1)
+\frac{(x-x_3)(x-x_1)}{(x_2-x_3)(x_2-x_1)}f(x_2)
+\frac{(x-x_1)(x-x_2)}{(x_3-x_1)(x_3-x_2)}f(x_3)
$$

**Lagrange插值基函数**：
$$
l_i(x)=\frac{\prod\limits_{j\ne i}(x-x_j)}{\prod\limits_{j\ne i}(x_i-x_j)}
$$

**Lagrange插值公式**：
$$
\begin{align}
&L_n(x)
=\sum_{i=0}^{n}\frac{\prod\limits_{j\ne i}(x-x_j)}{\prod\limits_{j\ne i}(x_i-x_j)}f(x_i)
=\sum_{k=0}^{n}\frac{f(x_k)}{\omega'_{n+1}(x_k)}\frac{\omega_{n+1}(x)}{(x-x_k)}\\
&R_n(x)=f(x)-L_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega_{n+1}(x)
\end{align}
$$

其中
$$
\omega_{n+1}(x)=\prod_{k=0}^{n}(x-x_k)
$$

## 2.2	Newton插值

**$k$阶差商**：定义$f[x_0]=f(x_0)$为$f$在$x_0$处的$0$阶差商，递归的，定义如下为$f$在$x_0,\cdots,x_k$处的$k$阶均差。
$$
f[x_0,\cdots,x_k]=\frac{f[x_1,\cdots,x_k]-f[x_0,\cdots,x_{k-1}]}{x_k-x_0}
$$

- $f[x_0,\cdots,x_k]$中任意对换$x_i$和$x_j$的位置，差商不变。
- $$
  f[x_0,\cdots,x_k]=\sum_{i=0}^{k}\frac{f(x_i)}{\omega'_{k+1}(x_i)}
  $$
- $$
  f[x_0,\cdots,x_k]=\frac{f^{(k)}(\xi)}{k!}
  $$
- $$
  f[x_0,\cdots,x_0]=\lim_{x_i\to x_0}f[x_0,\cdots,x_k]=\frac{f^{(k)}(x_0)}{k!}
  $$

**Newton插值公式**：
$$
\begin{align}
&P_n(x)=f(x_0)+\sum_{i=1}^{n}f[x_0,\cdots,x_{i}]\prod_{j=0}^{i-1}(x-x_j)\\
&R_n(x)=f(x)-P_n(x)=f[x,x_0,\cdots,x_n]\omega_{n+1}(x)
\end{align}
$$
## 2.3	Hermite插值

**Hermite插值公式**：如果要求插值函数$H$具有$m$阶导数，那么
$$
H^{(j)}_{mn+m+n}(x_i)=f^{(j)}(x_i),\qquad 0\le i \le n,0\le j\le m
$$

**Taylor插值公式**：$P^{(k)}(x_0)=f^{(k)}(x_0),\quad 0\le k\le n$
$$
\begin{align}
&P_n(x)=\sum_{k=0}^{n}\frac{f^{(k)}(x_0)}{k!}(x-x_0)^n\\
&R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}
\end{align}
$$

**三点三次Hermite插值**：$H(x_i)=f(x_i),i\in\{0,1,2\}$且$H'(x_1)=f'(x_1)$
$$
\begin{align}
&H_3(x)=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)\\
&\qquad\qquad+\frac{f'(x_1)-f[x_0,x_1]-(x_1-x_0)f[x_0,x_1,x_2]}{(x_1-x_0)(x_1-x_2)}(x-x_0)(x-x_1)(x-x_2)\\
&R_3(x)=\frac{f^{(4)}(\xi)}{4!}(x-x_0)(x-x_1)^2(x-x_2)
\end{align}
$$

**两点三次Hermite插值公式**：$H^{(j)}(x_i)=f^{(j)}(x_i),\quad i,j\in\{0,1\}$
$$
\begin{align}
&H_3(x)
=f(x_0)\left(1+2\frac{x-x_0}{x_1-x_0}\right)\left(\frac{x-x_0}{x_1-x_0}\right)^2
+f(x_1)\left(1+2\frac{x-x_1}{x_0-x_1}\right)\left(\frac{x-x_1}{x_0-x_1}\right)^2\\
&\qquad\qquad +f'(x_0)(x-x_0)\left(\frac{x-x_1}{x_0-x_1}\right)^2
+f'(x_1)(x-x_1)\left(\frac{x-x_0}{x_1-x_0}\right)^2\\
&R_3(x)=\frac{f^{(4)}(\xi)}{4!}(x-x_0)^2(x-x_1)^2
\end{align}
$$

# 第三章：函数逼近

## 3.1	基本概念

**Gram矩阵**：$\varphi_1,\cdots,\varphi_n$线性无关，当且仅当$\det G\ne0$，其中
$$
G=\begin{pmatrix}
(\varphi_1,\varphi_1)&\cdots&(\varphi_1,\varphi_n)\\
\vdots&\ddots&\vdots\\
(\varphi_n,\varphi_1)&\cdots&(\varphi_n,\varphi_n)
\end{pmatrix}
$$

## 3.2	正交多项式

### 3.2.1	正交多项式

**正交多项式**：给定权函数$\rho$，构造幂函数系$1,x,x^2,\cdots$的正交多项式序列
$$
\begin{align}
& \varphi_0=1\\
& \varphi_{n}=x^{n}-\sum_{k=0}^{n-1}\frac{(x^n,\varphi_k)}{(\varphi_k,\varphi_k)}\varphi_k
\end{align}
$$
或
$$
\begin{align}
& \varphi_{-1}=0,\qquad \varphi_0=1\\
& \varphi_{n+1}=\left(x-\frac{(x\varphi_n,\varphi_n)}{(\varphi_n,\varphi_n)}\right)\varphi_n--\frac{(\varphi_n,\varphi_n)}{(\varphi_{n-1},\varphi_{n-1})}\varphi_{n-1}
\end{align}
$$

- $[a,b]$上的$n$次正交多项式$\varphi_n$在$(a,b)$上存在$n$个互异零点。

### 3.2.2	常见正交多项式

**Legendre多项式**：区间$[-1,1]$上关于权$\rho=1$的正交多项式为Legendre多项式
$$
L_n=\frac{1}{2^nn!}\frac{\mathrm{d}^n}{\mathrm{d}x^n}(x^2-1)^n=\sum_{k=0}^{[n/2]}\frac{(-1)^k(2n-2k)!}{2^nk!(n-k)!(n-2k)!}x^{n-2k},\qquad x\in[-1,1],n\in\N
$$
首一Legendre多项式
$$
\tilde{L}_n=\frac{2^n(n!)^2}{(2n)!}L_n=\frac{n!}{(2n)!}\frac{\mathrm{d}^n}{\mathrm{d}x^n}(x^2-1)^n,\qquad n\in\N
$$

- 正交性：
  $$
  \int_{-1}^{1}L_mL_n=\begin{cases}
  0,\qquad & m\ne n\\
  \frac{2}{1+2n},\qquad & m=n
  \end{cases}
  $$

- 奇偶性：
  $$
  L_n(-x)=(-1)^nL_n(x)
  $$

- 递推关系：
  $$
  (n+1)L_{n+1}=(2n+1)xL_n-nL_{n-1}
  $$

- 对于任意$n$次首一多项式$\tilde{P}_n$，成立
  $$
  \| \tilde{L}_n \|_2\le \| \tilde{P}_n \|_2
  \iff
  \int_{-1}^{1}\tilde{L}_n^2\le \int_{-1}^{1}\tilde{P}_n^2
  $$
  
- $L_n$在$[-1,1]$内存在$n$个不同实数零点。

**Chebyshev多项式**：区间$[-1,1]$上关于权$\rho=1/\sqrt{1-x^2}$的正交多项式为Chebyshev多项式
$$
C_n=\cos(n\arccos x)=\frac{n}{2}\sum_{k=0}^{[n/2]}(-1)^k\frac{(n-k-1)!}{k!(n-2k)!}(2x)^{n-2k},\qquad x\in[-1,1],n\in\N
$$
令$x=\cos\theta$
$$
C_n=\cos n \theta ,\qquad \theta\in[0,\pi]
$$
首一Chebyshev多项式
$$
\tilde{C}_n=\frac{1}{2^{n-1}}C_n=\frac{n}{2^n}\sum_{k=0}^{[n/2]}(-1)^k\frac{(n-k-1)!}{k!(n-2k)!}(2x)^{n-2k},\qquad x\in[-1,1],n\in\N
$$

- 递推关系：
  $$
  C_{n+1}=2xC_n-C_{n-1}
  $$

- 正交性：
  $$
  \int_{-1}^{1}\frac{C_mC_n}{\sqrt{1-x^2}}=\begin{cases}
  0,\qquad & m\ne n\\
  \frac{\pi}{2},\qquad & m=n\ne0\\
  \pi,\qquad & m=n=0
  \end{cases}
  $$

- $C_{2n}$仅含$x$的偶次幂，$C_{2n+1}$仅含$x$的奇次幂。

**第二类Chebyshev多项式**：区间$[-1,1]$上关于权$\rho=\sqrt{1-x^2}$的正交多项式为第二类Chebyshev多项式
$$
C_n=\frac{\sin((n+1)\arcsin x)}{\sqrt{1-x^2}}
$$
令$x=\sin\theta$
$$
C_n=\frac{\sin(n+1)\theta}{\cos\theta},\qquad \theta\in[-\pi/2,\pi/2]
$$

- 递推关系：
  $$
  C_{n+1}=2xC_n-C_{n-1}
  $$

- 正交性：
  $$
  \int_{-1}^{1}\sqrt{1-x^2}C_mC_n=\begin{cases}
  0,\qquad & m\ne n\\
  \frac{\pi}{2},\qquad & m=n
  \end{cases}
  $$
  

**Laguerre多项式**：区间$[0,\infty)$上关于权$\rho=\mathrm{e}^{-x}$的正交多项式为Laguerre多项式
$$
L_n=\mathrm{e}^x\frac{\mathrm{d}}{\mathrm{d}x^n}x^n\mathrm{e}^{-x}
$$

- 递推关系：
  $$
  L_{n+1}=(1+2n-x)L_n-n^2L_{n-1}
  $$

- 正交性：
  $$
  \int_{0}^{\infty}\mathrm{e}^{-x}L_mL_n=\begin{cases}
  0,\qquad & m\ne n\\
  (n!)^2,\qquad & m=n
  \end{cases}
  $$

**Hermite多项式**：区间$(-\infty,\infty)$上关于权$\rho=\mathrm{e}^{-x^2}$的正交多项式为Hermite多项式
$$
H_n=(-1)^n\mathrm{e}^{x^2}\frac{\mathrm{d}}{\mathrm{d}x^n}\mathrm{e}^{-x^2}
$$

- 递推关系：
  $$
  H_{n+1}=2xH_n-2nH_{n-1}
  $$

- 正交性：
  $$
  \int_{-\infty}^{\infty}\mathrm{e}^{-x^2}H_mH_n=\begin{cases}
  0,\qquad & m\ne n\\
  2^nn!\sqrt{\pi},\qquad & m=n
  \end{cases}
  $$

### 3.2.3	Chebyshev多项式零点插值

**Chebyshev多项式零点插值**：在$[-1,1]$上，用Chebyshev多项式$C_{n+1}$的$n+1$个零点$x_k=\cos\frac{2k+1}{2(n+1)}\pi$作为插值结点，其中$k=0,\cdots,n$，由Lagrange插值公式或Newton插值公式可得插值多项式$P_n$，插值余项为
$$
R_n(x)=f(x)-P_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega_{n+1}(x),\qquad \xi\in(-1,1)
$$
因此
$$
|R_n|\le\frac{M_{n+1}}{(n+1)!}\max_{[-1,1]}|\omega_{n+1}|=\frac{M_{n+1}}{(n+1)!}\max_{[-1,1]}|\tilde{C}_{n+1}|=\frac{M_{n+1}}{2^n(n+1)!}
$$
## 3.3	最佳平方逼近

**最佳平方逼近**：对于函数$f\in C[a,b]$，称函数$S$为函数$f$在函数族$\mathrm{span}\{\varphi_k\}_{k=0}^{n}$中关于权$\rho$的最佳平方逼近，如果成立
$$
\| f-S \|^2_2=\inf_{g\in \mathrm{span}\{\varphi_n\}}\| f-g \|^2_2
$$
记$\displaystyle S=\sum_{k=0}^{n}a_k\varphi_k$，那么
$$
\begin{pmatrix}
(\varphi_0,\varphi_0)&\cdots&(\varphi_0,\varphi_n)\\
\vdots&\ddots&\vdots\\
(\varphi_n,\varphi_0)&\cdots&(\varphi_n,\varphi_n)
\end{pmatrix}
\begin{pmatrix}
a_0\\\vdots\\a_n
\end{pmatrix}
=
\begin{pmatrix}
(f,\varphi_0)\\
\vdots\\
(f,\varphi_n)
\end{pmatrix}
$$
平方偏差/均方误差为
$$
\|\delta\|^2_2=\| f-S \|^2_2=\|f\|^2_2-\sum_{k=0}^{n}a_k(f,\varphi_k)
$$
**幂多项式系的最佳平方逼近**：函数$f\in C[0,1]$在函数族$\mathrm{span}\{x^k\}_{k=0}^{n}$中关于权$\rho=1$的$n$次最佳平方逼近多项式$\displaystyle S=\sum_{k=0}^{n}a_k\varphi_k$满足
$$
\begin{pmatrix}
\frac{1}{1}&\frac{1}{2}&\cdots&\frac{1}{n+1}\\
\frac{1}{2}&\frac{1}{3}&\cdots&\frac{1}{n+2}\\
\vdots&\vdots&\ddots&\vdots\\
\frac{1}{n+1}&\frac{1}{n+2}&\cdots&\frac{1}{2n+1}\\
\end{pmatrix}
\begin{pmatrix}
a_0\\\vdots\\a_n
\end{pmatrix}
=
\begin{pmatrix}
(f,x^0)\\
\vdots\\
(f,x^n)
\end{pmatrix}
$$
**正交函数系的最佳平方逼近**：当函数族$\{\varphi_k\}_{k=0}^{n}$关于权$\rho$正交时，最佳平方逼近为
$$
S=\sum_{k=0}^{n}\frac{(f,\varphi_k)}{(\varphi_k,\varphi_k)}\varphi_k
$$
平方偏差/均方误差为
$$
\|\delta\|^2_2=\| f-S \|^2_2=\|f\|^2_2-\sum_{k=0}^{n}\frac{(f,\varphi_k)^2}{(\varphi_k,\varphi_k)}
$$
**正交多项式系的最佳平方逼近**：当函数族$\{\varphi_n\}_{n=0}^{\infty}$为关于权$\rho$的正交多项式系，那么$n$次最佳平方逼近
$$
S_n=\sum_{k=0}^{n}\frac{(f,\varphi_k)}{(\varphi_k,\varphi_k)}\varphi_k
$$
满足
$$
\|\delta_n\|_2=\|f-S_n\|_2\to0
$$

## 3.4	最小二乘法

**最小二乘法**：对于函数$f\in C[a,b]$，称函数$S$为函数$f$在函数族$\mathrm{span}\{\varphi_k\}_{k=0}^{n}$中关于权$\omega$和点$\{x_k\}_{k=1}^{n}$的最小二乘拟合，如果成立
$$
\sum_{k=0}^{n}\omega(x_k)|S(x_k)-f(x_k)|^2=\inf_{g\in\mathrm{span}\{\varphi_k\}}\sum_{k=0}^{n}\omega(x_k)|g(x_k)-f(x_k)|^2
$$
记$\displaystyle S=\sum_{k=0}^{n}a_k\varphi_k$，那么
$$
\begin{pmatrix}
(\varphi_0,\varphi_0)&\cdots&(\varphi_0,\varphi_n)\\
\vdots&\ddots&\vdots\\
(\varphi_n,\varphi_0)&\cdots&(\varphi_n,\varphi_n)
\end{pmatrix}
\begin{pmatrix}
a_0\\\vdots\\a_n
\end{pmatrix}
=
\begin{pmatrix}
(f,\varphi_0)\\
\vdots\\
(f,\varphi_n)
\end{pmatrix}
$$
平方偏差/均方误差为
$$
\|\delta\|^2=\| f-S \|^2=\|f\|^2-\sum_{k=0}^{n}a_k(f,\varphi_k)
$$

**正交函数系的最佳平方逼近**：当$\{\varphi_k\}_{k=0}^{n}$关于权$\omega$正交时，最小二乘拟合为
$$
S=\sum_{k=0}^{n}\frac{(f,\varphi_k)}{(\varphi_k,\varphi_k)}\varphi_k
$$
平方偏差/均方误差为
$$
\|\delta\|^2_2=\| f-S \|^2_2=\|f\|^2_2-\sum_{k=0}^{n}\frac{(f,\varphi_k)^2}{(\varphi_k,\varphi_k)}
$$

# 第四章：数值积分与数值微分

## 4.1	数值积分

**左矩形公式**：$\displaystyle \int_a^bf(x)\mathrm{d}x\approx (b-a)f(a)$

**右矩形公式**：$\displaystyle \int_a^bf(x)\mathrm{d}x\approx (b-a)f(b)$

**中矩形公式**：${\displaystyle \int_a^bf(x)\mathrm{d}x}\approx (b-a)f\left(\frac{a+b}{2}\right)$，代数精度为$1$，求积余项为$R[f]=\frac{(b-a)^3}{24} f''(\xi)$，其中$\xi\in (a,b)$。

**梯形公式**：${\displaystyle \int_a^bf(x)\mathrm{d}x}\approx \frac{b-a}{2}(f(a)+f(b))$，代数精度为$1$，求积余项为$R[f]=-\frac{(b-a)^3}{12} f''(\xi)$，其中$\xi\in (a,b)$。

**数值求积公式**：函数$f$在区间$[a,b]$上关于求积节点$\{x_k\}_{k=0}^{n}$和权$\{A_k\}_{k=0}^{n}$的数值求积公式为
$$
I=\int_a^bf(x)\mathrm{d}x\approx I_n=\sum_{k=0}^{n}A_kf(x_k)
$$

**代数精度**：称求积公式$\displaystyle \int_a^bf(x)\mathrm{d}x\approx\sum_{k=0}^{n}A_kf(x_k)$具有$m$次代数精度，如果成立
$$
\begin{align}
&\int_a^b x^k\mathrm{d}x=\sum_{i=0}^{n}A_ix_i^k,\qquad k=0,\cdots,m\\
&\int_a^b x^{m+1}\mathrm{d}x\ne \sum_{i=0}^{n}A_ix_i^{m+1}
\end{align}
$$

**机械求积公式**：如果求积节点$\{x_k\}_{k=0}^{n}$和权$\{A_k\}_{k=0}^{n}$与被积函数$f(x)$无关，那么称函数$f$在区间$[a,b]$上关于求积节点$\{x_k\}_{k=0}^{n}$和权$\{A_k\}_{k=0}^{n}$的数值求积公式$\displaystyle \int_a^bf(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)$为机械求积公式。

**插值型数值求积公式**：由Lagrange插值公式
$$
f(x)=\sum_{i=0}^{n}f(x_i)l_i(x)+R_n(x)
$$
其中
$$
\begin{align}
&l_i(x)
=\frac{\prod\limits_{j\ne i}(x-x_j)}{\prod\limits_{j\ne i}(x_i-x_j)}\\
&R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega_{n+1}(x)
\end{align}
$$
那么插值型数值求积公式为
$$
\int_a^b f(x)\mathrm{d}x\approx \sum_{i=0}^{n} \int_a^b l_i(x)\mathrm{d}x \cdot f(x_i)
$$

**求积余项**：如果求积公式$\displaystyle \int_a^bf(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)$具有$m$次代数精度，那么求积余项为
$$
\begin{align}
&R[f]=\int_a^bf(x)\mathrm{d}x- \sum_{k=0}^{n}A_kf(x_k)=K f^{(m+1)}(\xi),\qquad \xi\in(a,b)\\
&K=\frac{1}{(m+1)!}\left( \frac{b^{m+2}-a^{m+2}}{m+2}-\sum_{k=0}^{n}A_k x_k^{m+1} \right)
\end{align}
$$
**收敛性**：记$\displaystyle h=\max_{1\le k \le n}\{ x_k-x_{k-1} \}$，称求积公式$\displaystyle \int_a^bf(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)$具有收敛性，如果
$$
\lim_{\substack{n\to\infty\\h\to 0}}\sum_{k=0}^{n}A_kf(x_k)=\int_a^bf(x)\mathrm{d}x
$$

**稳定性**：称求积公式$\displaystyle \int_a^bf(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)$具有稳定性，如果对于任意$\varepsilon>0$，存在$\delta>0$，成立
$$
\sup_{0\le k \le n}|\delta_k|\le\delta\implies 
\left| \sum_{k=0}^{n}A_k\delta_k \right|<\varepsilon
$$

## 4.2	Newton-Cotes公式

**Cotes系数**：
$$
C_k^{(n)}=\frac{(-1)^{n-k}}{nk!(n-k)!}\int_{0}^{n}\prod_{\substack{0\le i \le n\\i\ne k}}(x-i)\mathrm{d}x
$$

**Newton-Cotes公式**：等距节点$x_k=a+\frac{b-a}{n}k$的插值型求积公式为
$$
\int_a^b f(x)\mathrm{d}x\approx (b-a)\sum_{k=0}^{n}C_k^{(n)}f(x_k)
$$

**Newton-Cotes公式的代数精度**：

- 当$n$为奇数时，$n$阶Newton-Cotes公式具有$n$次代数精度。
- 当$n$为偶数时，$n$阶Newton-Cotes公式具有$n+1$次代数精度。

**Newton-Cotes公式的稳定性**：当且仅当$n\le 8$时，$n$阶Newton-Cotes公式具有稳定性。

**一阶Newton-Cotes公式	梯形公式**：
$$
\begin{align}
&\int_a^bf(x)\mathrm{d}x\approx T=\frac{b-a}{2}(f(a)+f(b))\\
&R[f]=-\frac{(b-a)^3}{12} f''(\xi),\qquad \xi\in(a,b)
\end{align}
$$

**二阶Newton-Cotes公式	Simpson公式**：
$$
\begin{align}
&\int_a^bf(x)\mathrm{d}x\approx 
S=\frac{b-a}{6}\left( f(a)+4f{\scriptsize \left(\frac{a+b}{2}\right)}+f(b) \right)\\
&R[f]=-\frac{(b-a)^5}{2880}f^{(4)}(\xi),\qquad \xi\in (a,b)
\end{align}
$$
**三阶Newton-Cotes公式	四点八分之三Simpson公式**：
$$
\int_a^bf(x)\mathrm{d}x\approx 
\frac{b-a}{8}\left( f(a)+3f{\scriptsize\left(\frac{2a+b}{3}\right)}+3f{\scriptsize\left(\frac{a+2b}{3}\right)}+f(b) \right)
$$
**四阶Newton-Cotes公式	Cotes公式**：
$$
\small{
\begin{align}
&\int_a^bf(x)\mathrm{d}x\approx  C=
\frac{b-a}{90}
\left( 
7f\left(a\right)
+32f{\scriptsize\left(\frac{3a+b}{4}\right)}
+12f{\scriptsize\left(\frac{a+b}{2}\right)}
+32f{\scriptsize\left(\frac{a+3b}{4}\right)}
+7f\left(b\right)
\right)\\
&R[f]=-\frac{2(b-a)}{945}\left(\frac{b-a}{4}\right)^6f^{(6)}(\xi),\qquad \xi\in(a,b)
\end{align}
}
$$

## 4.3	复合求积公式

**复合梯形公式**：等距节点$x_k=a+\frac{b-a}{n}k$的复合梯形公式为
$$
\int_a^bf(x)\mathrm{d}x\approx T_n=\frac{b-a}{2n}\sum_{k=1}^{n}(f(x_{k-1})+f(x_k))=\frac{b-a}{2n}\left(f(a)+2\sum_{k=1}^{n-1}f(x_k)+f(b)\right)
$$
复合梯形公式具有$1$次代数精度、收敛性、稳定性，积分余项为
$$
R[f]=-\frac{(b-a)^3}{12n^2}f''(\xi),\qquad \xi\in(a,b)
$$

**复合Simpson公式**：等距节点$x_k=a+\frac{b-a}{n}k$的复合Simpson公式为
$$
\begin{align}
\int_a^bf(x)\mathrm{d}x\approx S_n
&=\frac{b-a}{6n}\sum_{k=1}^{n}\left( f(x_{k-1})+4f{\scriptsize\left(\frac{x_{k-1}+x_k}{2}\right)}+f(x_k) \right)\\
&=\frac{b-a}{6n}\left( f(a)+2\sum_{k=1}^{n-1}f(x_k)+4\sum_{k=1}^{n}f{\scriptsize\left(\frac{x_{k-1}+x_{k}}{2}\right)}+f(b) \right)\\
\end{align}
$$
复合Simpson公式具有$3$次代数精度、收敛性、稳定性，积分余项为
$$
R[f]=-\frac{(b-a)^5}{2880n^4}f^{(4)}(\xi),\qquad \xi\in (a,b)
$$

## 4.5	Gauss型求积公式

### 4.5.1	Gauss型求积公式

**Gauss型求积公式**：称加权求积公式$\displaystyle \int_a^b \rho(x)f(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)$为Gauss型求积公式，如果其具有$2n+1$次代数精度。

**Gauss点**：称Gauss型求积公式$\displaystyle \int_a^b \rho(x)f(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)$的求积节点$\{x_k\}_{k=0}^{n}$为Gauss点。

**定理**：加权求积公式$\displaystyle \int_a^b \rho(x)f(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)$的求积节点$\{x_k\}_{k=0}^{n}$为Gauss点$\iff $对于任意$\le n$次多项式$p(x)$，成立
$$
\int_a^b \rho(x)p(x)\omega_{n+1}(x)\mathrm{d}x=0
$$
其中
$$
\omega_{n+1}(x)=\prod_{k=0}^{n}(x-x_k)
$$

**Gauss型求积公式**：
$$
\int_a^b \rho(x)f(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)
$$
其中求积节点$\{x_k\}_{k=0}^{n}$为关于权$\rho$的$n+1$次正交多项式的零点，权$\{A_k\}_{k=0}^{n}$满足
$$
\int_a^b \rho(x)x^{m}\mathrm{d}x=\sum_{k=0}^{n}A_k x_k^{m},\qquad 0\le m\le 2n+1
$$
Gauss型求积公式具有$2n+1$次代数精度、收敛性、稳定性，积分余项为
$$
R_n[f]=\frac{1}{(2n+2)!}f^{(2n+2)}(\xi)\int_a^b\rho(x)\omega_{n+1}^2(x)\mathrm{d}x,\qquad \xi\in(a,b)
$$
### 4.5.2	常见Gauss型求积公式

**Gauss-Legendre求积公式**：区间$[-1,1]$上关于权$\rho=1$的Gauss型求积公式为Gauss-Legendre求积公式
$$
\int_{-1}^1 f(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)
$$
其中求积节点$\{x_k\}_{k=0}^{n}$为$n+1$次Legendre多项式$L_{n+1}(x)$的零点，权$\{A_k\}_{k=0}^{n}$满足
$$
\int_{-1}^1 x^{m}\mathrm{d}x=\sum_{k=0}^{n}A_k x_k^{m},\qquad 0\le m\le 2n+1
$$

Gauss-Legendre求积公式具有$2n+1$次代数精度、收敛性、稳定性，积分余项为
$$
R_n[f]=\frac{2^{2n+3}((n+1)!)^4}{(2n+3)((2n+2)!)^3}f^{(2n+2)}(\xi),\qquad \xi\in(-1,1)
$$

特别的
$$
\begin{align}
&\int_{-1}^1 f(x)\mathrm{d}x \approx 2f(0)\\
&\int_{-1}^1 f(x)\mathrm{d}x \approx f(-1/\sqrt{3})+f(1/\sqrt{3})\\
&\int_{-1}^1 f(x)\mathrm{d}x \approx \frac{5}{9}f(-\sqrt{15}/5)+\frac{8}{9}f(0)+\frac{5}{9}f(\sqrt{15}/5)
\end{align}
$$

$$
\begin{align}
\int_{-1}^1 f(x)\mathrm{d}x \approx & 
{\small \frac{1}{36} \left(18+\sqrt{30}\right)}f{\scriptsize \left(-\sqrt{\frac{1}{35} \left(15-2 \sqrt{30}\right)}\right)}\\
&+{\small \frac{1}{36} \left(18+\sqrt{30}\right) }f{\scriptsize \left(\sqrt{\frac{1}{35} \left(15-2 \sqrt{30}\right)}\right) }\\
&+{\small \frac{1}{36} \left(18-\sqrt{30}\right) }f{\scriptsize \left(-\sqrt{\frac{1}{35} \left(15+2 \sqrt{30}\right)}\right) }\\
&+{\small \frac{1}{36} \left(18-\sqrt{30}\right)}f{\scriptsize \left(\sqrt{\frac{1}{35} \left(15+2 \sqrt{30}\right)}\right)}
\end{align}
$$

$$
\begin{align}
\int_{-1}^1 f(x)\mathrm{d}x \approx 
\frac{128}{225}f(0) &+
{\small \frac{1}{900} \left(322+13 \sqrt{70}\right)}f{\scriptsize \left( -\frac{1}{3} \sqrt{\frac{1}{7} \left(35-2 \sqrt{70}\right)} \right)}\\
&+{\small \frac{1}{900} \left(322+13 \sqrt{70}\right) }f{\scriptsize \left( \frac{1}{3} \sqrt{\frac{1}{7} \left(35-2 \sqrt{70}\right)} \right)}\\
&+{\small \frac{1}{900} \left(322-13 \sqrt{70}\right) }f{ \scriptsize \left( -\frac{1}{3} \sqrt{\frac{1}{7}
   \left(35+2 \sqrt{70}\right)} \right)}\\
&+{\small \frac{1}{900} \left(322-13 \sqrt{70}\right)}f{\scriptsize\left( \frac{1}{3} \sqrt{\frac{1}{7} \left(35+2 \sqrt{70}\right)} \right)}
\end{align}
$$

**Gauss-Chebyshev求积公式**：区间$[-1,1]$上关于权$\rho=1/\sqrt{1-x^2}$的Gauss型求积公式为Gauss-Chebyshev求积公式
$$
\int_{-1}^1 \frac{f(x)}{\sqrt{1-x^2}}\mathrm{d}x\approx \frac{\pi}{n}\sum_{k=0}^{n}f(\cos\frac{2k-1}{2n}\pi)
$$
Gauss-Chebyshev求积公式具有$2n-1$次代数精度、收敛性、稳定性，积分余项为
$$
R_n[f]=\frac{2\pi}{2^{2n}(2n)!}f^{(2n)}(\xi),\qquad \xi\in(-1,1)
$$

**Gauss-Laguerre求积公式**：区间$[0,\infty)$上关于权$\rho=\mathrm{e}^{-x}$的Gauss型求积公式为Gauss-Laguerre求积公式
$$
\int_{0}^\infty \mathrm{e}^{-x}f(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)
$$
其中求积节点$\{x_k\}_{k=0}^{n}$为$n+1$次Laguerre多项式$L_{n+1}(x)$的零点，权$\displaystyle A_k=\frac{((n+1)!)^2}{x_k(L_{n+1}'(x_k))^2}$。Gauss-Laguerre求积公式具有$2n+1$次代数精度、收敛性、稳定性，积分余项为
$$
R_n[f]=\frac{((n+1)!)^2}{2(n+1)!}f^{(2n+2)}(\xi),\qquad \xi\in(0,\infty)
$$

**Gauss-Hermite求积公式**：区间$(-\infty,\infty)$上关于权$\rho=\mathrm{e}^{-x^2}$的Gauss型求积公式为Gauss-Hermite求积公式
$$
\int_{-\infty}^\infty \mathrm{e}^{-x^2}f(x)\mathrm{d}x\approx \sum_{k=0}^{n}A_kf(x_k)
$$
其中求积节点$\{x_k\}_{k=0}^{n}$为$n+1$次Hermite多项式$H_{n+1}(x)$的零点，权$\displaystyle A_k=\frac{2^{n+2}(n+1)!\sqrt{\pi}}{(H'_{n+1}(x_k))^2}$。Gauss-Hermite求积公式具有$2n+1$次代数精度、收敛性、稳定性，积分余项为
$$
R_n[f]=\frac{((n+1)!)^2}{2(n+1)!}f^{(2n+2)}(\xi),\qquad \xi\in(-\infty,\infty)
$$

# 第五章：解线性方程的直接法

## 5.1	矩阵范数

**向量范数**：称$\|x\|$为向量$x\in \C^n$的范数，如果

- $\|x\|\ge 0$，当且仅当$x=0$时等号成立。
- $\|\lambda x\|=|\lambda|\|x\|$
- $\|x+y\|\le \|x\|+\|y\|$

**矩阵范数**：称$\|A\|$为矩阵$A\in \C^{n\times n}$的范数，如果

- $\|A\|\ge 0$，当且仅当$A=0$时等号成立。
- $\|\lambda A\|=|\lambda|\|A\|$
- $\|A+B\|\le \|A\|+\|B\|$
- $\|AB\|\le\|A\|\|B\|$

**矩阵的算子范数**：定义关于向量范数$\|\cdot\|$的矩阵范数为
$$
\|A\|=\sup_{\|x\|\le 1}\|Ax\|
$$
**常见矩阵范数**：
$$
矩阵范数\begin{cases}
算子范数\quad \begin{cases}
行范数\quad & \|A\|_\infty=\max\limits_{1\le i\le n}\sum_{j=1}^{n}|a_{ij}|\\
列范数\quad & \|A\|_1=\max\limits_{1\le j\le n}\sum_{i=1}^{n}|a_{ij}|\\
谱范数\quad & \|A\|_2=\max\left\{ \sqrt{\lambda}:\exists x,A^TAx=\lambda x \right\}
\end{cases}\\
非算子范数\quad F-范数:\|A\|_F=\left(\sum_{i,j}a_{ij}^2\right)^{1/2}
\end{cases}
$$
**谱半径**：定义矩阵$A\in\C^{n\times n}$的谱半径为
$$
\rho(A)=\max\{ |\lambda|:\exists x,Ax=\lambda x \}
$$

**条件数**：定义非奇异矩阵$A$的条件数为
$$
\text{cond}_v(A)=\|A^{-1}\|_v\|A\|_v
$$

- 谱条件数：$\displaystyle\text{cond}_2(A)=\frac{\max\left\{ \sqrt{\lambda}:\exists x,A^TAx=\lambda x \right\}}{\min\left\{ \sqrt{\lambda}:\exists x,AA^Tx=\lambda x \right\}}$
- $A^T=A$：$\displaystyle\text{cond}_2(A)=\frac{\max\left\{ |\lambda|:\exists x,Ax=\lambda x \right\}}{\min\left\{ |\lambda|:\exists x,Ax=\lambda x \right\}}$
- $\text{cond}_v(A)\ge 1$
- 如果$\lambda\ne0$，那么$\text{cond}_v(\lambda A)=\text{cond}_v(A)$。
- 如果$A^TA=AA^T=I$，那么$\text{cond}_2(A)=1$。
- 如果$Q^TQ=QQ^T=I$，那么$\text{cond}_2(QA)=\text{cond}_2(AQ)=\text{cond}_2(A)$。

# 第六章：解线性方程的迭代法

## 6.1	向量序列与矩阵序列

**向量序列的极限**：定义向量序列的极限为坐标极限的向量。

**矩阵序列的极限**：定义矩阵序列的极限为坐标极限的矩阵。

## 6.2	迭代法

**一阶线性定常迭代**：对于非奇异矩阵$A$，将线性方程$Ax=b$等价改写为$x=Bx+f$，对于任意初始向量$x^{(0)}$，构造迭代公式
$$
x^{(n+1)}=Bx^{(n)}+f
$$
**迭代误差**：
$$
\varepsilon^{(n)}=x^{(n)}-x=B^n(x^{(0)}-x)
$$
**一阶线性定常迭代的基本定理**：对于任意初始向量$x^{(0)}$，一阶线性定常迭代$x^{(n+1)}=Bx^{(n)}+f$收敛的充分必要条件为
$$
\lim_{n\to\infty}B^n=O\iff \rho(B)<1
$$
**压缩映像原理**：如果存在算子范数$\|\cdot\|$，使得成立$\|B\|=q<1$，那么一阶线性定常迭代$x^{(n+1)}=Bx^{(n)}+f$收敛，且成立
$$
\begin{align}
&\left\|x^{(n)}-x\right\|\le q^n \left\|x^{(0)}-x\right\|\\
&\left\|x^{(n)}-x\right\|\le \frac{q}{1-q}\left\|x^{(n)}-x^{(n-1)}\right\|\\
&\left\|x^{(n)}-x\right\|\le \frac{q^n}{1-q}\left\|x^{(1)}-x^{(n-1)}\right\|
\end{align}
$$

**迭代次数**：若要求$\left\|x^{(n)}-x\right\|\le\varepsilon$时迭代结束，那么迭代次数为
$$
N=\left\lceil \frac{\ln\varepsilon(1-q)-\ln\left\|x^{(n)}-x\right\|}{\ln q} \right\rceil
$$
**渐进收敛速度**：$R(B)=-\ln\rho(B)$，$\rho(B)$越小，收敛速度越快。

## 6.3	常用一阶定常迭代

对于线性方程$Ax=b$，将$A=\{ a_{ij} \}_{n\times n}\in\R^{n\times n}$分裂为$D-L-U$：
$$
\scriptsize{
\begin{pmatrix}
a_{11}&&&&\\
&a_{22}&&&\\
&&\ddots&&\\
&&&a_{n-1,n-1}&\\
&&&&a_{nn}
\end{pmatrix}
-\begin{pmatrix}
0&&&&\\
-a_{21}&0&&&\\
\vdots&\vdots&\ddots&&\\
-a_{n-1,1}&a_{n-1,2}&\cdots&0&\\
-a_{n1}&-a_{n2}&\cdots&-a_{n,n-1}&0
\end{pmatrix}
-\begin{pmatrix}
0&-a_{21}&\cdots&-a_{1,n-1}&-a_{1n}\\
&0&\cdots&-a_{2,n-1}&-a_{2n}\\
&&\ddots&\vdots&\vdots\\
&&&0&-a_{n-1,n}\\
&&&&0
\end{pmatrix}
}
$$

**Jacobi迭代**：如果$\det D\ne0$，那么
$$
Ax=b\iff x=(I-D^{-1}A)x+D^{-1}b\iff x=B_Jx+f_J\\
x_i^{(k+1)}=\frac{1}{a_{ii}}\left( b_{i}-\sum_{j\ne i}a_{ij}x_{j}^{(k)} \right),\qquad 1\le i\le n,k\in\N
$$

**Gauss-Seidel迭代**：如果$\det D\ne0$，那么
$$
Ax=b\iff x=(I-(D-L)^{-1}A)x+(D-L)^{-1}b\iff x=B_Gx+f_G\\
x_i^{(k+1)}=\frac{1}{a_{ii}}\left( b_{i}-\sum_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum_{j=i+1}^{n}a_{ij}x_j^{(k)} \right),\qquad 1\le i\le n,k\in\N
$$

**逐次超松弛迭代(SOR)迭代**：选择松弛因子$w>0$，那么
$$
Ax=b\iff x=(I-w(D-wL)^{-1}A)x+w(D-wL)^{-1}b\iff x=B_wx+f_w\\
x_i^{(k+1)}=x_i^{k}+\frac{w}{a_{ii}}\left( b_i-\sum_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum_{j=i}^{n}a_{ij}x_j^{(k)} \right),\qquad 1\le i\le n,k\in\N
$$
$w>1$时称为超松弛法，$w<1$时称为低松弛法，$w=1$即为G-S迭代。

**定理**：如果线性方程$Ax=b$的系数矩阵$A$为正定三对角矩阵，那么Jacobi迭代中$\rho(B_J)<1$，SOR迭代中松弛因子的最佳选择为
$$
w_{\text{opt}}=\frac{2}{1+\sqrt{1-\rho^2(B_J)}}
$$
此时$\rho(B_{w_\text{opt}})=w_{\text{opt}}-1$。

**定理**：对于非齐次线性方程$Ax=b$，其中$\det A\ne0$，如果$A^T=A$，且$A$的对角线元素$a_{ii}>0$，那么

- Jacobi迭代收敛$\iff A,2D-A$为正定矩阵。
- $A$为正定矩阵$\implies$G-S迭代收敛。
- $A$为正定矩阵，且$0<w<2\implies$SOR迭代收敛。

**严格对角占优矩阵**：称矩阵$A$为严格对角占优矩阵，如果对于任意$i$，成立
$$
|a_{ii}|>\sum_{j\ne i}|a_{ij}|
$$

**弱对角占优矩阵**：称矩阵$A$为弱对角占优矩阵，如果对于任意$i$，成立
$$
|a_{ii}|\ge\sum_{j\ne i}|a_{ij}|
$$
且存在$i_0$，使得成立
$$
|a_{i_0i_0}|>\sum_{j\ne i_0}|a_{i_0j}|
$$

**可约矩阵**：称矩阵$A$为可约矩阵，如果存在置换矩阵$P$，使得成立
$$
P^TAP=\begin{pmatrix}
A_{11}&A_{12}\\
O&A_{22}
\end{pmatrix}
$$
**定理**：对于非齐次线性方程$Ax=b$，如果$A$为严格对角占优矩阵，或弱对角占优不可约矩阵，那么

- Jacobi迭代收敛，G-S迭代收敛。
- $0<w\le 1\implies$SOR迭代收敛。

# 第七章：非线性方程的数值解

## 7.1	二分法

**二分法**：
$$
|x^*-x_n|\le\frac{1}{2^{n+1}}
$$

## 7.2	不动点迭代

**不动点迭代**：对于方程$x=\varphi(x)$，如果$\varphi([a,b])\sub [a,b]$，且存在$L<1$，使得对于任意$x,y\in[a,b]$，成立
$$
|\varphi(x)-\varphi(y)|<L|x-y|
$$
那么方程$x=\varphi(x)$在$[a,b]$内存在且存在唯一解$x^*$。
$$
|x_n-x^*|<\frac{L^n}{1-L}|x_1-x_0|,\qquad 
|x_n-x^*|<\frac{L}{1-L}|x_{n+1}-x_n|
$$

**收敛阶**：对于不动点迭代$x_{n+1}=\varphi(x_n)$，如果
$$
(x_{n+1}-x^*)/(x_n-x^*)^p\to C\ne 0
$$
那么称该迭代为$p$阶收敛的。
- 如果$p=1,|C|<1$，那么称该迭代为线性收敛。
- 如果$p>1$，那么称该迭代为超线性迭代。
- 如果$p=2$，那么称该迭代为平方收敛。

**定理**：对于不动点迭代$x_{n+1}=\varphi(x_n)$，以及$p\in\N^*$，如果$\varphi^{(p)}$在$x^*$邻域内连续，且
$$
\varphi^{(k)}(x^*)=0,\quad 1\le k\le p-1,\qquad \varphi^{(p)}(x^*)\ne 0
$$
那么该迭代为$p$阶收敛，且
$$
\lim_{n\to\infty}\frac{x_{n+1}-x^*}{(x_n-x^*)^p}=\frac{\varphi^{(p)}(x^*)}{p!}
$$

## 7.4	Newton法

**Newton法**：方程$f(x)=0$的迭代
$$
x_{n+1}=\varphi(x_n),\qquad 
\varphi(x)=x-\frac{f(x)}{f'(x)}
$$
如果$f(x^*)=0$且$f'(x^*)\ne 0$，那么Newton迭代在$x^*$附近为平方收敛，且
$$
\lim_{n\to\infty}\frac{x_{n+1}-x^*}{(x_n-x^*)^2}=\frac{f''(x^*)}{2f'(x^*)}
$$

**简化Newton法/平行弦法**：方程$f(x)=0$的迭代
$$
x_{n+1}=x_n-\frac{f(x_n)}{f'(x_0)}
$$

**Newton下山法**：方程$f(x)=0$的迭代
$$
x_{n+1}=x_n-\lambda_n\frac{f(x_n)}{f'(x_n)}
$$
其中下山因子
$$
\lambda_n=\max\left\{ \frac{1}{2^r}:\left|f\left(x_n-\frac{f(x_n)}{2^rf'(x_n)}\right)\right|<|f(x_n)|,r\in\N^* \right\}
$$

**重根Newton法**：如果$x^*$为方程$f(x)=0$的$m$重根，那么迭代
$$
x_{n+1}=\varphi(x_n),\qquad 
\varphi(x)=x-\frac{f(x)}{f'(x)}
$$
此时
$$
\varphi'(x^*)=1-\frac{1}{m}
$$
因此该迭代为线性收敛。

**含参$m$的Newton迭代法**：如果$x^*$为方程$f(x)=0$的$m$重根，那么迭代
$$
x_{n+1}=\varphi(x_n),\qquad 
\varphi(x)=x-m\frac{f(x)}{f'(x)}
$$
此时
$$
\varphi'(x)=1-m+m\frac{f(x)f''(x)}{(f'(x))^2},\qquad \varphi'(x^*)=0
$$
因此该迭代为平方收敛。

**改进Newton迭代法**：如果$x^*$为方程$f(x)=0$的$m$重根，那么迭代
$$
x_{n+1}=\varphi(x_n),\qquad \varphi(x)=x-\frac{\mu(x)}{\mu'(x)},\qquad \mu(x)=\frac{f(x)}{f'(x)}
$$
此时$x^*$为方程$\mu(x)=0$的单根，因此该迭代为平方收敛。

# 第九章：常微分方程初值问题的数值解

## 9.1	简单的数值方法

**初值问题**：初值问题
$$
\begin{cases} 
\displaystyle\frac{\mathrm{d}y}{\mathrm{d}x}=f(x,y)\\ 
y(x_0)=y_0 
\end{cases}
$$

### 9.1.1	Euler方法

**Euler公式**：
$$
y_{n+1}=y_n+h f(x_n,y_n),\qquad x_n=x_0+nh
$$

**后退Euler公式**：
$$
y_{n+1}=y_n+h f(x_{n+1},y_{n+1}),\qquad x_n=x_0+nh
$$

**中心Euler公式**：
$$
y_{n+1}=y_{n-1}+h f(x_{n},y_{n}),\qquad x_n=x_0+nh
$$

**改进Euler法**：
$$
y_{n+1}=y_n+\frac{h}{2}(f(x_n,y_n)+f(x_n+h,y_n+hf(x_n,y_n)))
$$

### 9.1.2	梯形方法

**梯形公式**：
$$
y_{n+1}=y_n+\int_{x_n}^{x_{n+1}}f(x,y)\mathrm{d}x,\qquad x_n=x_0+nh
$$

**积分利用左矩形公式**：
$$
y_{n+1}=y_n+h f(x_n,y_n),\qquad x_n=x_0+nh
$$

**积分利用右矩形公式**：
$$
y_{n+1}=y_n+h f(x_{n+1},y_{n+1}),\qquad x_n=x_0+nh
$$

**积分利用梯形公式**：
$$
\begin{cases}
y_p=y_n+hf(x_n,y_n)\\
y_c=y_n+hf(x_{n+1},y_p)\\
y_{n+1}=\frac{1}{2}(y_p+y_c)
\end{cases}
$$

### 9.1.3	单步法的局部阶段误差与阶

**显示单步法**：
$$
y_{n+1}=y_n+h\varphi(x_n,y_n,h)
$$

**隐式单步法**：
$$
y_{n+1}=y_n+h\varphi(x_n,y_n,y_{n+1},h)
$$

**局部截断误差**：设$y(x)$为初值问题的精确解，那么定义显示单步法在$x_{n+1}$处的局部阶段误差为
$$
T_{n+1}=y(x_{n+1})-y(x_n)-h\varphi(x_n,y(x_n),h)
$$

**精度**：设$y(x)$为初值问题的精确解，如果存在最大整数$p$使得单步法的局部阶段误差满足
$$
T_{n+1}=O(h^{p+1})
$$
那么称该方法为$p$阶精度。

## 9.2	Runge-Kutta方法

**$r$级Runge-Kutta方法**：
$$
\begin{cases}
y_{n+1}=y_n+h\varphi(x_n,y_n,h)\\
\displaystyle\varphi(x_n,y_n,h)=\sum_{i=1}^{r}c_i K_i\\
K_1=f(x_n,y_n)\\
\displaystyle K_i=f\left(x_n+\lambda_ih,y_n+h\sum_{j=1}^{i-1}\mu_{ij}K_j\right),\qquad 2\le i\le r
\end{cases}
$$
**一级Runge-Kutta方法**：
$$
y_{n+1}=y_n+h f(x_n,y_n)
$$
一级Runge-Kutta方法为$1$阶精度。

**二级Runge-Kutta方法**：
$$
\begin{cases}
y_{n+1}=y_n+h((1-a)K_1+aK_2)\\
K_1=f(x_n,y_n)\\
K_2=f(x_n+h/(2a),y_n+hK_1/(2a))
\end{cases}
$$

二级Runge-Kutta方法为$2$阶精度。

$a=1/2$为**改进Euler法**：
$$
y_{n+1}=y_n+\frac{h}{2}(f(x_n,y_n)+f(x_n+h,y_n+hf(x_n,y_n)))
$$

$a=1$为**中点公式**：
$$
y_{n+1}=y_n+hf\left(x_n+\frac{h}{2},y_n+\frac{h}{2}f(x_n,y_n)\right)
$$

**经典三阶Runge-Kutta方法**：
$$
\begin{cases}
\displaystyle y_{n+1}=y_n+\frac{h}{6}(K_1+4K_2+K_3)\\
\displaystyle K_1=f(x_n,y_n)\\
\displaystyle K_2=f\left(x_n+\frac{h}{2},y_n+\frac{h}{2}K_1\right)\\
\displaystyle K_3=f\left(x_n+h,y_n-hK_1+2hK_2\right)
\end{cases}
$$

**经典四阶Runge-Kutta方法**：
$$
\begin{cases}
\displaystyle y_{n+1}=y_n+\frac{h}{6}(K_1+2K_2+2K_3+K_4)\\
\displaystyle K_1=f(x_n,y_n)\\
\displaystyle K_2=f\left(x_n+\frac{h}{2},y_n+\frac{h}{2}K_1\right)\\
\displaystyle K_3=f\left(x_n+\frac{h}{2},y_n+\frac{h}{2}K_2\right)\\
\displaystyle K_4=f\left(x_n+h,y_n+hK_3\right)
\end{cases}
$$

## 9.3	单步法的收敛性与稳定性

**收敛性**：称数值方法为收敛的，如果对于$x_n=x_0+nh$，成立
$$
\lim_{h\to0}y_n=y(x_n)
$$

**收敛性定理**：如果单步法
$$
y_{n+1}=y_n+h\varphi(x_n,y_n,h)
$$
具有$p\ge 1$阶精度，且增量函数$\varphi$关于$y$满足Lipschitz条件
$$
|\varphi(x,y_1,h)-\varphi(x,y_2,h)|\le L|y_1-y_2|
$$
同时$y_0=y(x_0)$，那么
$$
y(x_n)-y_n=O(h^p)
$$

**Euler方法**：如果$f(x,y)$关于$y$满足Lipschitz条件，那么Euler方法收敛。

**改进Euler法**：如果$f(x,y)$关于$y$满足Lipschitz条件，那么改进Euler方法收敛。

**相容性**：称单步法与初值问题相容，如果
$$
\varphi(x,y,0)=f(x,y)
$$

**相容性定理**：$p$阶方法与初值问题相容$\iff p\ge 1$。

**稳定性**：称数值方法为稳定的，如果在节点值$y_n$上有大小为$\delta$的扰动，而以后各节点$y_m$上产生的偏差不超过$\delta$，其中$m>n$。

**绝对稳定性**：称单步法为绝对稳定的，如果解微分方程$y'=\lambda y$得到的解$y_{n+1}=E(\lambda h)y_n$满足$|E(\lambda h)|<1$。
- Euler方法：$E(\lambda h)=1+\lambda h$
- 二阶Runge-Kutta方法：$E(\lambda h)=1+\lambda h+(\lambda h)^2/2$
- 三阶Runge-Kutta方法：$E(\lambda h)=1+\lambda h+(\lambda h)^2/2+(\lambda h)^3/3!$

**绝对稳定域**：定义绝对稳定的单步法的绝对稳定域为
$$
\{ (\lambda,h)\in\C^2:|E(\lambda h)|<1 \}
$$

**绝对稳定区间**：定义绝对稳定的单步法的绝对稳定区间为
$$
\{ (\lambda,h)\in\R^2:|E(\lambda h)|<1 \}
$$

**$A$-稳定性**：称单步法为$A$-稳定的，如果
$$
|E(\lambda h)|<1\implies \text{Re}(\lambda h)<0
$$
