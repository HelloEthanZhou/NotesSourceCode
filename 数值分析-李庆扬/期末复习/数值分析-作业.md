# 第一周

## 第一题

求下列近似值的误差限：
$$
\begin{align}
&x_1^*+x_2^*+x_4^*\\
&x_1^*x_2^*x_3^*\\
&x_2^*/x_4^*
\end{align}
$$
其中
$$
x_1^*=1.1021,\quad x_2^*=0.031,\quad x_3^*=385.6,\quad x_4^*=56.430
$$
解：由于
$$
\varepsilon(x_1^*)=\frac{1}{2}\times10^{-4},\quad \varepsilon(x_2^*)=\frac{1}{2}\times10^{-3},\quad \varepsilon(x_3^*)=\frac{1}{2}\times10^{-1},\quad \varepsilon(x_4^*)=\frac{1}{2}\times10^{-3}
$$
那么
$$
\begin{align}
&\varepsilon(x_1^*+x_2^*+x_4^*)
\approx\varepsilon(x_1^*)+\varepsilon(x_2^*)+\varepsilon(x_4^*)\approx1.05\times10^{-3}\\
&\varepsilon(x_1^*x_2^*x_3^*)
\approx|x_2^*x_3^*|\varepsilon(x_1^*)+|x_3^*x_1^*|\varepsilon(x_2^*)+|x_1^*x_2^*|\varepsilon(x_3^*)\approx0.215\\
&\varepsilon(x_2^*/x_4^*)\approx\frac{|x_2^*|\varepsilon(x_4^*)+|x_4^*|\varepsilon(x_2^*)}{|x_4^*|^2}\approx9\times10^{-4}
\end{align}
$$

## 第二题

序列$\{y_n\}$满足递推关系
$$
y_n=10y_{n-1}-1,\qquad n\in\N^*
$$
若$y_0=\sqrt{2}\approx 1.41$（三位有效数字），计算到$y_{10}$时误差有多大？这个计算过程稳定吗？

解：设$y_n^*$为$y_n$的近似值，那么$\varepsilon(y_n^*)=y_n^*-y_n$​，于是由
$$
\begin{cases}
y_0=\sqrt{2}\\
y_n=10y_{n-1}-1
\end{cases},\qquad 
\begin{cases}
y_0^*=1.41\\
y_n^*=10y^*_{n-1}-1
\end{cases}
$$
可知$\varepsilon(y_0^*)=\frac{1}{2}\times10^{-2}$，$\varepsilon(y_n^*)=10\varepsilon(y_{n-1}^*)$，进而
$$
\varepsilon(y_{10}^*)=10^{10}\varepsilon(y_0^*)=\frac{1}{2}\times10^{8}
$$
因此计算过程不稳定。

# 第二周

## 第一题

给出$f(x)=\ln x$的数值表

|   $x_n$   |    $0.4$    |    $0.5$    |    $0.6$    |    $0.7$    |    $0.8$    |
| :-----: | :-------: | :-------: | :-------: | :-------: | :-------: |
| $y_n=\ln x_n$ | $-0.916291$ | $-0.693147$ | $-0.510826$ | $-0.356675$ | $-0.223144$ |

使用线性插值及二次插值计算$\ln0.54$的近似值。

解：记$x_0=0.54,y_0=\ln0.54$。

对于线性插值，由于$x_2<x_0<x_3$，那么取$x_2,x_3$进行线性插值，插值函数为
$$
L_1(x)=\frac{x-x_3}{x_2-x_3}y_2+\frac{x-x_2}{x_3-x_2}y_3
$$
代入数据
$$
\ln 0.54\approx L_1(0.54)\approx -0.620219
$$

截断误差为
$$
|R_1(x)|=\frac{|f''(\xi)|}{2}|x-x_2||x-x_3|=\frac{|x-x_2||x-x_3|}{2\xi^2}\le\frac{|x-x_2||x-x_3|}{2x_2^2}
$$
于是
$$
|R_1(0.54)|\le4.8\times10^{-3}<\frac{1}{2}\times10^{-2}
$$

对于二次插值，取$x_1,x_2,x_3$进行抛物线插值，插值函数为
$$
L_2(x)=\frac{(x-x_2)(x-x_3)}{(x_1-x_2)(x_1-x_3)}y_1
+\frac{(x-x_3)(x-x_1)}{(x_2-x_3)(x_2-x_1)}y_2
+\frac{(x-x_1)(x-x_2)}{(x_3-x_1)(x_3-x_2)}y_3
$$
代入数据
$$
\ln0.54\approx L_2(0.54)\approx -0.615320
$$

截断误差为
$$
\small{
|R_2(x)|=\frac{|f'''(\xi)|}{6}|x-x_1||x-x_2||x-x_3|
=\frac{|x-x_1||x-x_2||x-x_3|}{3\xi^3}
\le\frac{|x-x_1||x-x_2||x-x_3|}{3x_1^3}
}
$$
于是
$$
|R_1(0.54)|\le1.75\times10^{-3}<\frac{1}{2}\times10^{-2}
$$

对于二次插值，取$x_2,x_3,x_4$进行抛物线插值，插值函数为
$$
L_2(x)=\frac{(x-x_3)(x-x_4)}{(x_2-x_3)(x_2-x_4)}y_2
+\frac{(x-x_4)(x-x_2)}{(x_3-x_4)(x_3-x_2)}y_3
+\frac{(x-x_2)(x-x_3)}{(x_4-x_2)(x_4-x_3)}y_4
$$
代入数据
$$
\ln0.54\approx L_2(0.54)\approx -0.616838
$$

截断误差为
$$
\small{
|R_2(x)|=\frac{|f'''(\xi)|}{6}|x-x_2||x-x_3||x-x_4|
=\frac{|x-x_2||x-x_3||x-x_4|}{3\xi^3}
\le\frac{|x-x_2||x-x_3||x-x_4|}{3x_2^3}
}
$$
于是
$$
|R_1(0.54)|\le8.96\times10^{-4}<\frac{1}{2}\times10^{-2}
$$

## 第二题

在$[-4,4]$上给出$f(x)=\mathrm{e}^x$的等距结点函数表，若用二次插值求$\mathrm{e}^x$的近似值，要求截断误差不超过$10^{-6}$，那么使用函数表的步长$h$应取多少？

解：假设插值点为$x_{0}-h,x_0,x_{0}+h$，那么截断误差为
$$
|R_2(x)|=\frac{|f^{'''}(\xi)|}{3!}|(x-x_0+h)(x-x_0)(x-x_0-h)|\le\frac{\sqrt{3}}{27}\mathrm{e}^4h^3
$$
当且仅当$\xi=4$且$x=x_0\pm \frac{h}{\sqrt{3}}$时等号成立。令$|R_2(x)|\le 10^{-6}$可知$h\le6.58\times10^{-3}$。

## 第三题

如果$f(x)=a_0+\cdots+a_nx^n$有$n$个不同实数根$x_1,\cdots,x_n$，证明：
$$
\sum_{k=1}^{n}\frac{x^m_k}{f'(x_k)}=\begin{cases}
0,\quad & 0\le m \le n-2\\
a_n^{-1},\quad & m=n-1
\end{cases}
$$
证明：由于$f$有$n$个不同实数根$x_1,\cdots,x_n$，那么
$$
f(x)=a_n(x-x_1)\cdots(x-x_n)=a_n\omega_{n+1}(x)
$$
记$p_m(x)=x^m$，那么
$$
\small{
\sum_{k=1}^{n}\frac{x^m_k}{f'(x_k)}=a^{-1}_n\sum_{k=1}^{n}\frac{p_m(x_k)}{\omega'_{n+1}(x_k)}=a^{-1}_np_m[x_1,\cdots,x_n]=a^{-1}_n\frac{p_m^{(n)}(\xi)}{n!}=
\begin{cases}
0,\quad & 0\le m \le n-2\\
a_n^{-1},\quad & m=n-1
\end{cases}
}
$$

# 第三周

## 第一题

求次数不大于$3$的多项式$P(x)$，使得满足条件
$$
P(x_0)=f(x_0),\quad P'(x_0)=f'(x_0),\quad 
P''(x_0)=f''(x_0),\quad P(x_1)=f(x_1)
$$

解：令
$$
P(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2}(x-x_0)^2+A(x-x_0)^3
$$
由$P(x_1)=f(x_1)$可知
$$
f(x_0)+f'(x_0)(x_1-x_0)+\frac{f''(x_0)}{2}(x_1-x_0)^2+A(x_1-x_0)^3=f(x_1)
$$
因此
$$
A
=\frac{f(x_1)-f(x_0)}{(x_1-x_0)^3}-\frac{f'(x_0)}{(x_1-x_0)^2}-\frac{f''(x_0)}{x_1-x_0}
$$
于是
$$
\begin{align}
P(x)=&f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2}(x-x_0)^2\\
&+\left(\frac{f(x_1)-f(x_0)}{(x_1-x_0)^3}-\frac{f'(x_0)}{(x_1-x_0)^2}-\frac{f''(x_0)}{x_1-x_0}\right)(x-x_0)^3
\end{align}
$$

## 第二题

求次数不高于$4$次的多项式$P(x)$，使得满足条件
$$
P(0)=P'(0)=0,\quad 
P(1)=P'(1)=1,\quad 
P(2)=1
$$

解：记$P(x)=ax^4+bx^3+cx^2+dx+e$，那么可得如下线性方程
$$
\begin{pmatrix}
0&0&0&0&1\\
0&0&0&1&0\\
1&1&1&1&1\\
4&3&2&1&0\\
16&8&4&2&1
\end{pmatrix}
\begin{pmatrix}
a\\b\\c\\d\\e
\end{pmatrix}
=\begin{pmatrix}
0\\0\\1\\1\\1
\end{pmatrix}
\implies
\begin{pmatrix}
a\\b\\c\\d\\e
\end{pmatrix}
=\begin{pmatrix}
\frac{1}{4}\\-\frac{3}{2}\\\frac{9}{4}\\0\\0
\end{pmatrix}
$$
因此
$$
P(x)=\frac{1}{4}x^4-\frac{3}{2}x^3+\frac{9}{4}x^2
$$

# 第四周

## 第一题

已知$f(x)=x^7+x^4+3x+1$，求$f[2^0,\cdots,2^7]$和$f[2^0,\cdots,2^8]$。

解：注意到

$$
f[x_0,\cdots,x_k]=\frac{f^{(k)}(\xi)}{k!}
$$

于是
$$
f[2^0,\cdots,2^7]=1,\qquad
f[2^0,\cdots,2^8]=0
$$
# 第五周

## 第一题

对于权$\rho=1+x^2$，求区间$[-1,1]$上的首$1$正交多项式$\varphi_n$，其中$n=0,1,2,3$。

解：递推公式为
$$
\begin{align}
& \varphi_0(x)=1\\
& \varphi_{n}(x)=x^{n}-\sum_{k=0}^{n-1}\frac{\displaystyle\int_{-1}^{1}(1+x^2)x^n\varphi_k(x)\mathrm{d}x}{\displaystyle\int_{-1}^{1}(1+x^2)\varphi_k^2(x)\mathrm{d}x}\varphi_k(x)
\end{align}
$$
于是
$$
\varphi_0=1,\qquad \varphi_1=x,\qquad 
\varphi_2=x^2-\frac{2}{5},\qquad 
\varphi_3=x^3-\frac{9 x}{14},\qquad 
\varphi_4=x^4-\frac{46
   x^2}{51}+\frac{37}{357}
$$

## 第二题

对于Chebyshev多项式$T_n(x)=\cos(n\arccos x)$，令$S_n(x)=T_n(2x-1)$，其中$x\in[0,1]$，证明：$\{S_n(x)\}$是$[0,1]$上权$\rho(x)=\frac{1}{\sqrt{x-x^2}}$的正交多项式，并求$S_0(x),S_1(x),S_2(x),S_3(x)$。

证明：由于$T_n(x)=\cos(n\arccos x)$，那么$S_n(x)=\cos(n\arccos (2x-1))$，其中$x\in[0,1]$，于是
$$
(S_m(x),S_n(x))=\int_0^1\rho(x) S_m(x) S_n(x)\mathrm{d}x=\begin{cases}
0,\qquad & m\ne n\\
\frac{\pi}{2},\qquad & m=n\ne0\\
\pi,\qquad & m=n=0
\end{cases}
$$
于是$\{S_n(x)\}$是$[0,1]$上权$\rho(x)=\frac{1}{\sqrt{x-x^2}}$的正交多项式，且
$$
\small{
S_0(x)=1,\quad
S_1(x)=2 x-1,\quad
S_2(x)=\cos \left(2 \arccos(2 x-1)\right),\quad
S_3(x)=\cos \left(3 \arccos(2 x-1)\right)
}
$$

## 第三题

用$T_3$的零点作为插值点，求$f(x)=\mathrm{e}^x$在区间$[-1,1]$上的二次插值多项式，并估计其最大误差界。

解：$T_3$的零点为$x_0=\frac{\sqrt{3}}{2},x_1=0,x_0=-\frac{\sqrt{3}}{2}$，那么容易求得其二次插值多项式为
$$
P(x)=\frac{2\left(\mathrm{e}^{\frac{\sqrt{3}}{2}}-\mathrm{e}^{-\frac{\sqrt{3}}{2}}\right)^2}{3}x^2+
\frac{\mathrm{e}^{\frac{\sqrt{3}}{2}}-\mathrm{e}^{-\frac{\sqrt{3}}{2}}}{\sqrt{3}}x+1
$$
其最大误差界为
$$
|R_2|\le\frac{\|f'''\|_\infty}{24}=\frac{\mathrm{e}}{24}
$$

## 第四题

求函数$f(x)=1/x$在区间$[1,3]$上对于$\mathrm{span}\{1,x\}$的最佳平方逼近多项式。

解：记$S(x)=a_0+a_1x$为函数$f(x)=1/x$在区间$[1,3]$上对于$\mathrm{span}\{1,x\}$的最佳平方逼近多项式，那么
$$
\begin{pmatrix}
(1,1)&(1,x)\\
(x,1)&(x,x)
\end{pmatrix}
\begin{pmatrix}
a_0\\a_1
\end{pmatrix}
=\begin{pmatrix}
(f(x),1)\\(f(x),x)
\end{pmatrix}
$$
于是
$$
a_0=\frac{13}{2}\ln3-6,\qquad a_1=3-3\ln3
$$
因此
$$
S(x)=\left(\frac{13}{2}\ln3-6\right)+(3-3\ln3)x
$$
平方偏差为
$$
\|\delta\|_2^2=\|f(x)-S(x)\|^2_2=12\ln3-\frac{13}{2}\ln^23-\frac{16}{3}
$$

## 第五题

求函数$f(x)=\ln x$在区间$[1,2]$上对于$\mathrm{span}\{1,x\}$的最佳平方逼近多项式。

解：记$S(x)=a_0+a_1x$为函数$f(x)=\ln x$在区间$[1,2]$上对于$\mathrm{span}\{1,x\}$的最佳平方逼近多项式，那么
$$
\begin{pmatrix}
(1,1)&(1,x)\\
(x,1)&(x,x)
\end{pmatrix}
\begin{pmatrix}
a_0\\a_1
\end{pmatrix}
=\begin{pmatrix}
(f(x),1)\\(f(x),x)
\end{pmatrix}
$$
于是
$$
a_0=10\ln4-\frac{29}{2},\qquad 
a_1=9-6\ln4
$$
因此
$$
S(x)=\left(10\ln4-\frac{29}{2}\right)+(9-6\ln4)x
$$

# 第六周

## 第一题

已知实验数据如下，用最小二乘法求形如$y=a+bx^2$的经验公式，并计算均方误差。

| $x_i$ |  $19$  |  $25$  |  $31$  |  $38$  |  $44$  |
| :---: | :----: | :----: | :----: | :----: | :----: |
| $y_i$ | $19.0$ | $32.3$ | $49.0$ | $73.3$ | $97.8$ |

解：由于
$$
\begin{align}
&(1，1)=5,\qquad (1,x^2)=(x^2,1)=5327,\qquad (x^2,x^2)=7277699\\
&(f(x),1)=271.4,\qquad (f(x),x^2)=369321.5
\end{align}
$$
于是
$$
\begin{pmatrix}
5&5327\\5327&7277699
\end{pmatrix}
\begin{pmatrix}
a\\b
\end{pmatrix}=
\begin{pmatrix}
271.4\\369321.5
\end{pmatrix}\implies
\begin{pmatrix}
a\\b
\end{pmatrix}=\begin{pmatrix}
0.97\\0.05
\end{pmatrix}
$$
因此
$$
y=0.97+0.05x^2
$$
均方误差为
$$
\|\delta\|^2=\| f-y \|^2=0.015
$$

## 第二题

已知实验数据如下，用最小二乘法拟合$y=f(x)$​，并计算均方误差。

| $x$  | $0$  |  $5$   |  $10$  |  $15$  |  $20$  |  $25$  |  $30$  |  $35$  |  $40$  |  $45$  |  $50$  |  $55$  |
| :--: | :--: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| $y$  | $0$  | $1.27$ | $2.16$ | $2.86$ | $3.44$ | $3.87$ | $4.15$ | $4.37$ | $4.51$ | $4.58$ | $4.62$ | $4.64$ |

解：三次函数拟合
$$
f(x)=a+bx+cx^2+dx^4
$$
那么
$$
\small{
\begin{pmatrix}
(1,1)&(1,x)&(1,x^2)&(1,x^3)\\
(x,1)&(x,x)&(x,x^2)&(x,x^3)\\
(x^2,1)&(x^2,x)&(x^2,x^2)&(x^2,x^3)\\
(x^3,1)&(x^3,x)&(x^3,x^2)&(x^3,x^3)\\
\end{pmatrix}
\begin{pmatrix}
a\\b\\c\\d
\end{pmatrix}=
\begin{pmatrix}
(1,f(x))\\(x,f(x))\\(x^2,f(x))\\(x^3,f(x))
\end{pmatrix}\implies
\begin{pmatrix}
a\\b\\c\\d
\end{pmatrix}=\begin{pmatrix}
0.04421\\
0.25569\\
-0.00491\\
0.00003
\end{pmatrix}
}
$$
因此
$$
f(x)=0.04421+0.25569x-0.00491x^2+0.00003x^4
$$
均方误差为
$$
\|\delta\|^2=\| f-y \|^2=0.00871
$$
## 第三题

确定如下求积公式中的待定系数，使其代数精度尽量高，并指明所构造出的求积公式所具有的代数精度。
$$
\int_{-2h}^{2h}f(x)\mathrm{d}x\approx A_{-1}f(-h)+A_0f(0)+A_1f(h)
$$
解：由如下方程
$$
\begin{align}
&\int_{-2h}^{2h}\mathrm{d}x=A_{-1}+A_0+A_1\\
&\int_{-2h}^{2h}x\mathrm{d}x=A_{-1}(-h)+A_1h\\
&\int_{-2h}^{2h}x^2\mathrm{d}x=A_{-1}h^2+A_1h^2
\end{align}
$$
解得
$$
A_{-1}=\frac{8}{3}h,\qquad 
A_0=-\frac{4}{3}h,\qquad 
A_1=\frac{8}{3}h
$$
此时
$$
\begin{align}
&\int_{-2h}^{2h}x^3\mathrm{d}x=A_{-1}(-h^3)+A_1h^3=0\\
&\int_{-2h}^{2h}x^4\mathrm{d}x=\frac{64}{5}h^5,\qquad A_{-1}h^4+A_1h^4=\frac{16}{3}h^5
\end{align}
$$
因此该求积公式具有$3$次代数精度。

## 第四题

确定如下求积公式中的待定系数，使其代数精度尽量高，并指明所构造出的求积公式所具有的代数精度。
$$
\int_{-1}^{1}f(x)\mathrm{d}x\approx 
\frac{1}{3}f(-1)+\frac{2}{3}f(x_1)+f(x_2)
$$
解：由如下方程
$$
\begin{align}
&\int_{-1}^{1}\mathrm{d}x=\frac{1}{3}+\frac{2}{3}+1\\
&\int_{-1}^{1}x\mathrm{d}x=\frac{1}{3}(-1)+\frac{2}{3}x_1+x_2\\
&\int_{-1}^{1}x^2\mathrm{d}x=\frac{1}{3}+\frac{2}{3}x_1^2+x_2^2
\end{align}
$$
解得
$$
x_1=\frac{1-\sqrt{6}}{5},\quad
x_2=\frac{3+2\sqrt{6}}{15};\qquad
\text{or}\qquad 
x_1=\frac{1+\sqrt{6}}{5},\quad
x_2=\frac{3-2\sqrt{6}}{15}
$$
当$\displaystyle x_1=\frac{1-\sqrt{6}}{5},x_2=\frac{3+2\sqrt{6}}{15}$时
$$
\int_{-1}^{1}x^3\mathrm{d}x=0,\qquad \frac{1}{3}+\frac{2}{3}x_1^3+x_2^3=\frac{2(57-2\sqrt{6})}{225}
$$
此时该求积公式具有$2$次代数精度。

当$\displaystyle x_1=\frac{1+\sqrt{6}}{5},x_2=\frac{3-2\sqrt{6}}{15}$时
$$
\int_{-1}^{1}x^3\mathrm{d}x=0,\qquad \frac{1}{3}+\frac{2}{3}x_1^3+x_2^3=\frac{2(57+2\sqrt{6})}{225}
$$
此时该求积公式具有$2$次代数精度。

# 第八周

## 第一题

证明：Cotest公式具有$5$次代数精度。

证明：Cotest公式为
$$
\small{
\int_a^bf(x)\mathrm{d}x\approx 
\frac{b-a}{90}
\left( 
7f\left(a\right)
+32f\left(\frac{3a+b}{4}\right)
+12f\left(\frac{a+b}{2}\right)
+32f\left(\frac{a+3b}{4}\right)
+7f\left(b\right)
\right)\\
}
$$
注意到
$$
\begin{align}
&\small{
\int_a^bx^0
\mathrm{d}x= 
\frac{b-a}{90}
\left( 
7f\left(a\right)^0
+32f\left(\frac{3a+b}{4}\right)^0
+12f\left(\frac{a+b}{2}\right)^0
+32f\left(\frac{a+3b}{4}\right)^0
+7f\left(b\right)^0
\right)=b-a
}\\
&\small{
\int_a^bx^1
\mathrm{d}x= 
\frac{b-a}{90}
\left( 
7f\left(a\right)^1
+32f\left(\frac{3a+b}{4}\right)^1
+12f\left(\frac{a+b}{2}\right)^1
+32f\left(\frac{a+3b}{4}\right)^1
+7f\left(b\right)^1
\right)=\frac{b^2-a^2}{2}
}\\
&\small{
\int_a^bx^2
\mathrm{d}x= 
\frac{b-a}{90}
\left( 
7f\left(a\right)^2
+32f\left(\frac{3a+b}{4}\right)^2
+12f\left(\frac{a+b}{2}\right)^2
+32f\left(\frac{a+3b}{4}\right)^2
+7f\left(b\right)^2
\right)=\frac{b^3-a^3}{3}
}\\
&\small{
\int_a^bx^3
\mathrm{d}x= 
\frac{b-a}{90}
\left( 
7f\left(a\right)^3
+32f\left(\frac{3a+b}{4}\right)^3
+12f\left(\frac{a+b}{2}\right)^3
+32f\left(\frac{a+3b}{4}\right)^3
+7f\left(b\right)^3
\right)=\frac{b^4-a^4}{4}
}\\
&\small{
\int_a^bx^4
\mathrm{d}x= 
\frac{b-a}{90}
\left( 
7f\left(a\right)^4
+32f\left(\frac{3a+b}{4}\right)^4
+12f\left(\frac{a+b}{2}\right)^4
+32f\left(\frac{a+3b}{4}\right)^4
+7f\left(b\right)^4
\right)=\frac{b^5-a^5}{5}
}\\
&\small{
\int_a^bx^5
\mathrm{d}x= 
\frac{b-a}{90}
\left( 
7f\left(a\right)^5
+32f\left(\frac{3a+b}{4}\right)^5
+12f\left(\frac{a+b}{2}\right)^5
+32f\left(\frac{a+3b}{4}\right)^5
+7f\left(b\right)^5
\right)=\frac{b^6-a^6}{6}
}
\end{align}
$$
但是
$$
\begin{align}
&\small{
\int_a^bx^6\mathrm{d}x=\frac{b^7-a^7}{7}
}\\
&\small{
\frac{b-a}{90}
\left( 
7f\left(a\right)^6
+32f\left(\frac{3a+b}{4}\right)^6
+12f\left(\frac{a+b}{2}\right)^6
+32f\left(\frac{a+3b}{4}\right)^6
+7f\left(b\right)^6
\right)=\frac{b^7-a^7}{7}+\frac{(b-a)^7}{2688}
}
\end{align}
$$
因此Cotest公式具有$5$次代数精度。

## 第二题

使用Simpson公式计算积分$\displaystyle\int_0^1\mathrm{e}^{-x}\mathrm{d}x$，并估计误差。

解：记$f(x)=\mathrm{e}^{-x}$，那么由Simpson公式
$$
\int_a^bf(x)\mathrm{d}x\approx 
\frac{b-a}{6}\left( f(a)+4f\left(\frac{a+b}{2}\right)+f(b) \right)
$$
计算得
$$
\int_0^1\mathrm{e}^{-x}\mathrm{d}x \approx \frac{1}{6}\left(1+\frac{1}{\mathrm{e}}+\frac{4}{\mathrm{\sqrt{e}}}\right) \approx0.632334
$$
误差为
$$
|R[f]|=\frac{1}{2880}\mathrm{e}^{-\xi}\le \frac{1}{2880}\approx 3.47\times 10^{-4}
$$

## 第三题

若用复合梯形公式计算积分$\displaystyle I=\int_0^1 \mathrm{e}^x\mathrm{d}x$，问区间$[0,1]$应分多少等份才能使截断误差不超过$\frac{1}{2}\times 10^{-5}$？若改用复合Simpson公式，要达到同样精度区间$[0,1]$应分多少等份？

解：若用复合梯形公式计算积分$\displaystyle I=\int_0^1 \mathrm{e}^x\mathrm{d}x$，那么截断误差为
$$
\frac{1}{12n^2}\mathrm{e}^\xi\le \frac{\mathrm{e}}{12n^2}\le \frac{1}{2}\times 10^{-5}
$$
可得$n\ge 212.85$，因此区间$[0,1]$应分$213$等份才能使截断误差不超过$\frac{1}{2}\times 10^{-5}$。

若用复合Simpson公式计算积分$\displaystyle I=\int_0^1 \mathrm{e}^x\mathrm{d}x$，那么截断误差为
$$
\frac{1}{2880n^4}\mathrm{e}^\xi\le \frac{\mathrm{e}}{2880n^4}\le \frac{1}{2}\times 10^{-5}
$$
可得$n\ge 3.71$，因此区间$[0,1]$应分$4$等份才能使截断误差不超过$\frac{1}{2}\times 10^{-5}$。

# 第九周

## 第一题

分别使用梯形公式和Simpson公式计算如下积分：
$$
\int_0^1 \frac{x}{4+x^2}\mathrm{d}x,\qquad n=8
$$

解：记$f(x)=x/(4+x^2)$，那么由梯形公式
$$
T_n=\frac{b-a}{2n}\left(f(a)+2\sum_{k=1}^{n-1}f(x_k)+f(b)\right)
$$
可得$T_8\approx 0.11140$；由Simpson公式
$$
S_n=\frac{b-a}{6n}\left( f(a)+2\sum_{k=1}^{n-1}f(x_k)+4\sum_{k=1}^{n}f\left(\frac{x_{k-1}+x_{k}}{2}\right)+f(b) \right)
$$
可得$S_8\approx 0.11157181$。

## 第二题

分别使用梯形公式和Simpson公式计算如下积分：
$$
\int_0^{\frac{\pi}{6}}\sqrt{4-\sin^2 x}  \mathrm{d}x,\qquad n=6
$$
解：记$f(x)=\sqrt{4-\sin^2 x}$，那么由梯形公式
$$
T_n=\frac{b-a}{2n}\left(f(a)+2\sum_{k=1}^{n-1}f(x_k)+f(b)\right)
$$
可得$T_6\approx 1.03562$；由Simpson公式
$$
S_n=\frac{b-a}{6n}\left( f(a)+2\sum_{k=1}^{n-1}f(x_k)+4\sum_{k=1}^{n}f\left(\frac{x_{k-1}+x_{k}}{2}\right)+f(b) \right)
$$
可得$S_6\approx 1.03576389$。


## 第三题

构造Gauss型求积公式
$$
\int_0^1\frac{1}{\sqrt{x}}f(x)\mathrm{d}x \approx A_0f(x_0)+A_1f(x_1)
$$
解：求关于权函数$\rho(x)=1/\sqrt{x}$的$2$次正交多项式，由递推关系
$$
\begin{align}
& \varphi_0=1\\
& \varphi_{n}=x^{n}-\sum_{k=0}^{n-1}\frac{(x^n,\varphi_k)}{(\varphi_k,\varphi_k)}\varphi_k
\end{align}
$$
其中
$$
(f,g)=\int_0^1\rho fg
$$
容易知道
$$
\varphi_0(x)=1,\qquad \varphi_1(x)=x-\frac{1}{3},\qquad \varphi_2(x)=x^2-\frac{6}{7}x+\frac{3}{35}
$$
那么$x_0,x_1$为多项式$\varphi_2(x)$的零点，不妨
$$
x_0=\frac{15-2\sqrt{30}}{35},\qquad 
x_1=\frac{15+2\sqrt{30}}{35}
$$
那么
$$
\begin{align}
&\int_0^1 \frac{1}{\sqrt{x}}\mathrm{d}x=A_0+A_1\iff A_0+A_1=2\\
&\int_0^1 \frac{x}{\sqrt{x}}\mathrm{d}x=A_0 x_0+A_1 x_1\iff x_0A_0+x_1A_1=\frac{2}{3}
\end{align}
$$
解得
$$
A_0=1+\frac{\sqrt{30}}{18},\qquad A_1=1-\frac{\sqrt{30}}{18}
$$

因此
$$
\int_0^1\frac{1}{\sqrt{x}}f(x)\mathrm{d}x \approx \left(1+\frac{\sqrt{30}}{18}\right)f\left(\frac{15-2\sqrt{30}}{35}\right)+\left(1-\frac{\sqrt{30}}{18}\right)f\left(\frac{15+2\sqrt{30}}{35}\right)
$$

## 第四题

用$n=2,3$的Gauss-Legendre公式计算积分
$$
\int_1^3\mathrm{e}^x\sin x\mathrm{d}x
$$
解：记
$$
\begin{align}
&f(x)=\mathrm{e}^x\sin x\\
&g(x)=f(x+2)=\mathrm{e}^{x+2}\sin(x+2)
\end{align}
$$
那么
$$
\int_1^3f(x)\mathrm{d}x=\int_{-1}^1g(x)\mathrm{d}x
$$
首先求Legendre多项式$L_n(x)$
$$
\small{
L_1(x)=x,\quad
L_2(x)=\frac{3}{2}x^2-\frac{1}{2},\quad
L_3(x)=\frac{5}{2}x^3-\frac{3}{2}x,\quad
L_4(x)=\frac{35}{8}x^4-\frac{15}{4}x^2+\frac{8}{3}
}
$$
当$n=2$​时，记
$$
\int_{-1}^1g(x)\mathrm{d}x\approx 
A_0f(x_0)+A_1f(x_1)+A_2f(x_2)
$$
$L_3(x)$​的零点为
$$
x_0=0,\qquad x_1=-\frac{\sqrt{15}}{5},\qquad x_2=\frac{\sqrt{15}}{5}
$$
由
$$
\begin{align}
&\int_{-1}^1 \mathrm{d}x=A_0+A_1+A_2\iff A_0+A_1+A_2=2\\
&\int_{-1}^1 x\mathrm{d}x=A_0 x_0+A_1 x_1+A_2 x_2\iff A_0 x_0+A_1 x_1+A_2 x_2=0\\
&\int_{-1}^1 x^2\mathrm{d}x=A_0 x_0^{2}+A_1 x_1^{2}+A_2 x_2^{2}\iff A_0 x_0^{2}+A_1 x_1^{2}+A_2 x_2^{2}=\frac{2}{3}
\end{align}
$$
解得
$$
A_0=\frac{8}{9},\qquad
A_1=\frac{5}{9},\qquad
A_2=\frac{5}{9}
$$
因此
$$
\int_1^3f(x)\mathrm{d}x=\int_{-1}^1 g(x)\mathrm{d}x \approx \frac{5}{9}g(-\sqrt{15}/5)+\frac{8}{9}g(0)+\frac{5}{9}g(\sqrt{15}/5)\approx 10.948
$$

当$n=3$​时，记
$$
\int_{-1}^1g(x)\mathrm{d}x\approx 
A_0f(x_0)+A_1f(x_1)+A_2f(x_2)+A_3f(x_3)
$$
$L_4(x)$​的零点为
$$
\begin{align}
&x_0=-\sqrt{\frac{1}{35} \left(15-2 \sqrt{30}\right)},\qquad 
x_1=\sqrt{\frac{1}{35} \left(15-2 \sqrt{30}\right)}\\
&x_2=-\sqrt{\frac{1}{35} \left(15+2 \sqrt{30}\right)},\qquad
x_3=\sqrt{\frac{1}{35} \left(15+2 \sqrt{30}\right)}
\end{align}
$$
由
$$
\begin{align}
&\int_{-1}^1 \mathrm{d}x=A_0+A_1+A_2+A_3\iff A_0+A_1+A_2+A_3=2\\
&\int_{-1}^1 x\mathrm{d}x=A_0 x_0+A_1 x_1+A_2 x_2+A_3 x_3\iff A_0 x_0+A_1 x_1+A_2 x_2+A_3x_3=0\\
&\int_{-1}^1 x^2\mathrm{d}x=A_0 x_0^{2}+A_1 x_1^{2}+A_2 x_2^{2}+A_3 x_3^{2}\iff A_0 x_0^{2}+A_1 x_1^{2}+A_2 x_2^{2}+A_3 x_3^{2}=\frac{2}{3}\\
&\int_{-1}^1 x^3\mathrm{d}x=A_0 x_0^{3}+A_1 x_1^{3}+A_2 x_2^{3}+A_3 x_3^{3}\iff A_0 x_0^{3}+A_1 x_1^{3}+A_2 x_2^{3}+A_3 x_3^{3}=0
\end{align}
$$
解得
$$
\begin{align}
&A_0=\frac{1}{36} \left(18+\sqrt{30}\right),\qquad
A_1=\frac{1}{36} \left(18+\sqrt{30}\right)\\
&A_2=\frac{1}{36} \left(18-\sqrt{30}\right),\qquad
A_3=\frac{1}{36} \left(18-\sqrt{30}\right)
\end{align}
$$
因此
$$
\begin{align}
\int_1^3f(x)\mathrm{d}x=\int_{-1}^1 g(x)\mathrm{d}x \approx & 
{\small \frac{1}{36} \left(18+\sqrt{30}\right)}g{\scriptsize \left(-\sqrt{\frac{1}{35} \left(15-2 \sqrt{30}\right)}\right)}\\
&+{\small \frac{1}{36} \left(18+\sqrt{30}\right) }g{\scriptsize \left(\sqrt{\frac{1}{35} \left(15-2 \sqrt{30}\right)}\right) }\\
&+{\small \frac{1}{36} \left(18-\sqrt{30}\right) }g{\scriptsize \left(-\sqrt{\frac{1}{35} \left(15+2 \sqrt{30}\right)}\right) }\\
&+{\small \frac{1}{36} \left(18-\sqrt{30}\right)}g{\scriptsize \left(\sqrt{\frac{1}{35} \left(15+2 \sqrt{30}\right)}\right)}\\
\approx & 10.950140
\end{align}
$$
# 第十周

## 第一题

$$
\int_1^3\frac{\mathrm{d}x}{x}=\ln3=1.09861228866811\cdots
$$

### 第一问

使用Romberg方法计算积分$\displaystyle\int_1^3\frac{\mathrm{d}x}{x}$。

解：精确数值积分值如下

|  $n$  |         $T_n$         |              $S_n$              |                        $C_n$                        |                            $R_n$                             |
| :---: | :-------------------: | :-----------------------------: | :-------------------------------------------------: | :----------------------------------------------------------: |
| $2^0$ |     $\frac{4}{3}$     |         $\frac{10}{9}$          |                  $\frac{742}{675}$                  |                   $\frac{431686}{392931}$                    |
| $2^1$ |     $\frac{7}{6}$     |         $\frac{11}{10}$         |               $\frac{342611}{311850}$               |             $\frac{694837621103}{632468286450}$              |
| $2^2$ |    $\frac{67}{60}$    |       $\frac{9137}{8316}$       |          $\frac{66175037683}{60235074900}$          | $\frac{172360324405522117934761}{156889128027453583261500}$  |
| $2^3$ | $\frac{30581}{27720}$ | $\frac{1260484963}{1147334760}$ | $\frac{26180652570471192967}{23830656645774069000}$ | $\frac{25439163417497615873531779822787373174797}{23155724434891620520320214190676005223000}$ |

近似数值积分值为

|  $n$  |   $T_n$   |   $S_n$   |    $C_n$    |      $R_n$      |
| :---: | :-------: | :-------: | :---------: | :-------------: |
| $2^0$ | $1.33333$ | $1.11111$ | $1.0992592$ | $1.09863054837$ |
| $2^1$ | $1.16667$ | $1.10000$ | $1.0986403$ | $1.09861258816$ |
| $2^2$ | $1.11667$ | $1.09873$ | $1.0986130$ | $1.09861229119$ |
| $2^3$ | $1.10321$ | $1.09862$ | $1.0986123$ | $1.09861228868$ |

### 第二问

使用三点Gauss-Legendre求积公式计算积分$\displaystyle\int_1^3\frac{\mathrm{d}x}{x}$。

解：注意到
$$
\int_1^3\frac{\mathrm{d}x}{x}=\int_{-1}^1\frac{\mathrm{d}x}{x+2}
$$
令$f(x)=1/(x+2)$​，三点Gauss-Legendre求积公式为
$$
\int_{-1}^1 f(x)\mathrm{d}x \approx \frac{5}{9}f(-\sqrt{15}/5)+\frac{8}{9}f(0)+\frac{5}{9}f(\sqrt{15}/5)
$$
代入数据可得
$$
\int_1^3\frac{\mathrm{d}x}{x}=\int_{-1}^1\frac{\mathrm{d}x}{x+2}\approx \frac{56}{51}\approx 1.0980
$$

### 第三问

使用五点Gauss-Legendre求积公式计算积分$\displaystyle\int_1^3\frac{\mathrm{d}x}{x}$。

解：注意到
$$
\int_1^3\frac{\mathrm{d}x}{x}=\int_{-1}^1\frac{\mathrm{d}x}{x+2}
$$
令$f(x)=1/(x+2)$​，五点Gauss-Legendre求积公式为
$$
\begin{align}
\int_{-1}^1 f(x)\mathrm{d}x \approx 
\frac{128}{225}f(0) &+
{\small \frac{1}{900} \left(322+13 \sqrt{70}\right)}f{\scriptsize \left( -\frac{1}{3} \sqrt{\frac{1}{7} \left(35-2 \sqrt{70}\right)} \right)}\\
&+{\small \frac{1}{900} \left(322+13 \sqrt{70}\right) }f{\scriptsize \left( \frac{1}{3} \sqrt{\frac{1}{7} \left(35-2 \sqrt{70}\right)} \right)}\\
&+{\small \frac{1}{900} \left(322-13 \sqrt{70}\right) }f{ \scriptsize \left( -\frac{1}{3} \sqrt{\frac{1}{7}
   \left(35+2 \sqrt{70}\right)} \right)}\\
&+{\small \frac{1}{900} \left(322-13 \sqrt{70}\right)}f{\scriptsize\left( \frac{1}{3} \sqrt{\frac{1}{7} \left(35+2 \sqrt{70}\right)} \right)}
\end{align}
$$
代入数据可得
$$
\int_1^3\frac{\mathrm{d}x}{x}=\int_{-1}^1\frac{\mathrm{d}x}{x+2}\approx \frac{12244}{11145}\approx 1.098609
$$

### 第四问

将区间$[1,3]$分为四等份，使用复合两点Gauss-Legendre求积公式计算积分$\displaystyle\int_1^3\frac{\mathrm{d}x}{x}$。

解：使用两点Gauss-Legendre求积公式计算积分
$$
\int_a^b\frac{\mathrm{d}x}{x}=\int_{-1}^{1}\frac{\mathrm{d}x}{x-\frac{a+b}{a-b}}
$$
记$f(x)=1/(x-\frac{a+b}{a-b})$​，两点Gauss-Legendre求积公式为
$$
\int_{-1}^1 f(x)\mathrm{d}x \approx f(-1/\sqrt{3})+f(1/\sqrt{3})
$$
代入数据
$$
\int_a^b\frac{\mathrm{d}x}{x}
=\int_{-1}^{1}\frac{\mathrm{d}x}{x+\frac{b+a}{b-a}}
\approx -\frac{3 (a-b) (a+b)}{a^2+4 a b+b^2}
$$
注意到
$$
\int_1^3\frac{\mathrm{d}x}{x}=
\int_1^{\frac{3}{2}}\frac{\mathrm{d}x}{x}
+\int_{\frac{3}{2}}^{2}\frac{\mathrm{d}x}{x}
+\int_2^{\frac{5}{2}}\frac{\mathrm{d}x}{x}
+\int_{\frac{5}{2}}^{3}\frac{\mathrm{d}x}{x}
$$
代入数据可得
$$
\int_1^{\frac{3}{2}}\frac{\mathrm{d}x}{x}\approx\frac{15}{37},\quad
\int_{\frac{3}{2}}^{2}\frac{\mathrm{d}x}{x}\approx\frac{21}{73},\quad
\int_2^{\frac{5}{2}}\frac{\mathrm{d}x}{x}\approx \frac{27}{121},\quad
\int_{\frac{5}{2}}^{3}\frac{\mathrm{d}x}{x}\approx\frac{33}{181},\quad
$$
因此
$$
\int_1^3\frac{\mathrm{d}x}{x}=
\int_1^{\frac{3}{2}}\frac{\mathrm{d}x}{x}
+\int_{\frac{3}{2}}^{2}\frac{\mathrm{d}x}{x}
+\int_2^{\frac{5}{2}}\frac{\mathrm{d}x}{x}
+\int_{\frac{5}{2}}^{3}\frac{\mathrm{d}x}{x}
\approx \frac{64983552}{59154601}
\approx 1.09854
$$

### 第五问

比较如上计算结果。

解：在使用Romberg方法计算数值积分时，越靠借右下角，数值精度越高。

Gauss-Legendre求积公式的数值精度如下

|                                | 精确值 |           积分值            |        误差         |
| :----------------------------: | :----: | :-------------------------: | :-----------------: |
|   三点Gauss-Legendre求积公式   | $\ln3$ |       $\frac{56}{51}$       | $5.73\times10^{-4}$ |
|   五点Gauss-Legendre求积公式   | $\ln3$ |    $\frac{12244}{11145}$    | $3.04\times10^{-6}$ |
| 复合两点Gauss-Legendre求积公式 | $\ln3$ | $\frac{64983552}{59154601}$ | $7.47\times10^{-5}$ |

因此五点Gauss-Legendre求积公式数值精度最高。

## 第二题

确定如下数值微分公式的截断误差表达式
$$
f'(x_0)=\frac{1}{2h}(4f(x_0+h)-3f(x_0)-f(x_0+2h))
$$
解：由$f(x)$的Taylor展开
$$
f(x)=f(x_0)+f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+\frac{f^{(3)}(\xi)}{3!}(x-x_0)^3
$$
因此
$$
\begin{align}
&f(x_0+h)=f(x_0)+f'(x_0)h+\frac{f''(x_0)}{2!}h^2+\frac{f^{(3)}(\alpha)}{3!}h^3\\
&f(x_0+2h)=f(x_0)+2f'(x_0)h+4\frac{f''(x_0)}{2!}h^2+8\frac{f^{(3)}(\beta)}{3!}h^3
\end{align}
$$
进而截断误差为
$$
\small{
f'(x_0)-\frac{1}{2h}(4f(x_0+h)-3f(x_0)-f(x_0+2h))=\frac{1}{3}h^2(2f^{(3)}(\beta)-f^{(3)}(\alpha))=\frac{1}{3}h^2f^{(3)}(\xi)
}
$$

## 第三题

对于对称正定矩阵$A\in\R^{n\times n}$，定义$\|x\|_A=\sqrt{(Ax,x)}$，证明$\|x\|_A$为向量范数。

- $\|x\|_A\ge 0$，当且仅当$x=0$时等号成立。
- $\|\lambda x\|_A=|\lambda|\|x\|_A$
- $\|x+y\|_A\le \|x\|_A+\|y\|_A$

证明：由于$A$为正定矩阵，那么存在可逆矩阵$Q$，使得成立$A=Q^TQ$，因此
$$
\|x\|_A=\sqrt{(Ax,x)}=\sqrt{x^TAx}=\sqrt{(Qx)^T(Qx)}=\|Qx\|_2
$$
对于正定性，显然$\|x\|\ge 0$，且
$$
\|x\|_A=0
\iff \|Qx\|_2=0
\iff Qx=0
\iff x=0
$$
对于绝对齐性，注意到
$$
\|\lambda x\|_A=\|\lambda Qx\|_2=|\lambda|\|Qx\|_2=|\lambda|\|x\|_A
$$
对于三角不等式，注意到
$$
\|x+y\|_A=\|Q(x+y)\|_2=\|Qx+Qy\|_2\le\|Qx\|_2+\|Qy\|_2=\|x\|_A+\|y\|_A
$$

# 第十一周

## 第一题

对于$\lambda\ne0$，设
$$
A=\begin{pmatrix}
2\lambda&\lambda\\
1&1
\end{pmatrix}
$$
证明：当$|\lambda|=2/3$时，$\text{cond}(A)_\infty$取到最小值。

证明：由于
$$
A^{-1}=\begin{pmatrix}
\frac{1}{\lambda}&-1\\
-\frac{1}{\lambda}&2
\end{pmatrix}
$$
因此
$$
\begin{align}
&\|A\|_\infty=\max_{1\le i\le 2}\sum_{j=1}^{2}|a_{ij}|=\max\{ 3|\lambda|,2 \}=\begin{cases}
3|\lambda|,\qquad & |\lambda|\ge \frac{2}{3}\\
2,\qquad & |\lambda|<\frac{2}{3}
\end{cases}\\
&\|A^{-1}|_\infty=\max_{1\le i\le 2}\sum_{j=1}^{2}|a_{ij}|=\max\left\{ 1+\frac{1}{|\lambda|},2+\frac{1}{|\lambda|} \right\}=2+\frac{1}{|\lambda|}
\end{align}
$$
因此
$$
\text{cond}(A)_\infty=\|A^{-1}\|_\infty\|A\|_\infty=
\begin{cases}
6|\lambda|+3,\qquad & |\lambda|\ge \frac{2}{3}\\
4+\frac{2}{|\lambda|},\qquad & |\lambda|<\frac{2}{3}
\end{cases}
$$
因此当$|\lambda|=2/3$时，$\text{cond}(A)_\infty$取到最小值$7$。

## 第二题

设
$$
A=\begin{pmatrix}
100&99\\
99&98
\end{pmatrix}
$$
计算$A$的条件数$\text{cond}(A)_2$与$\text{cond}(A)_\infty$。

解：由于
$$
A^{-1}=\begin{pmatrix}
-98&99\\
99&-100
\end{pmatrix}
$$
且$A^TA$与$(A^{-1})^TA^{-1}$的特征值均为
$$
19603+2574\sqrt{58},\qquad \frac{1}{19603+2574\sqrt{58}}
$$
那么
$$
\begin{align}
&\|A\|_2=\sqrt{19603+2574\sqrt{58}}\approx 198\\
&\|A^{-1}\|_2=\sqrt{19603+2574\sqrt{58}}\approx 198\\
&\|A\|_\infty=\max_{1\le i\le 2}\sum_{j=1}^{2}|a_{ij}|=\max\{ 199,197 \}=199\\
&\|A^{-1}\|_\infty=\max_{1\le i\le 2}\sum_{j=1}^{2}|a_{ij}|=\max\{ 197,199 \}=199
\end{align}
$$
因此
$$
\begin{align}
&\text{cond}(A)_2=\|A^{-1}\|_2\|A\|_2=19603+2574\sqrt{58}\approx39206\\
&\text{cond}(A)_\infty=\|A^{-1}\|_\infty\|A\|_\infty=39601
\end{align}
$$

## 第三题

设
$$
A=\begin{pmatrix}
10&a&0\\
b&10&b\\
0&a&5
\end{pmatrix}
$$
$\det A\ne 0$。求线性方程$Ax=b$的Jacobi迭代和Gauss-Seidel迭代收敛的充分必要条件。

解：由题意
$$
\det A=500-15ab\ne0\iff ab\ne\frac{100}{3}
$$

Jacobi迭代矩阵为
$$
B_J=I-D^{-1}A=
\begin{pmatrix}
 0 & -\frac{a}{10} & 0 \\
 -\frac{b}{10} & 0 & -\frac{b}{10} \\
 0 & -\frac{a}{5} & 0 \\
\end{pmatrix}
$$
而矩阵$B_J$的特征值为
$$
0,\qquad \frac{1}{10}\sqrt{3ab},\qquad -\frac{1}{10}\sqrt{3ab}
$$
因此
$$
\rho(B_J)=\frac{\sqrt{3|ab|}}{10}
$$
而Jacobi迭代收敛$\iff$
$$
\rho(B_J)<1\iff \frac{\sqrt{3|ab|}}{10}<1\iff |ab|<\frac{100}{3}
$$

Gauss-Seidel迭代矩阵为
$$
B_G=I-(D-L)^{-1}A=
\begin{pmatrix}
 0 & -\frac{a}{10} & 0 \\
 0 & \frac{a b}{100} & -\frac{b}{10} \\
 0 & -\frac{a^2 b}{500} & \frac{a b}{50} \\
\end{pmatrix}
$$
而矩阵$B_G$的特征值为
$$
0,\qquad 0,\qquad \frac{3ab}{100}
$$
因此
$$
\rho(B_G)=\frac{3|ab|}{100}
$$
而Gauss-Seidel迭代收敛$\iff $
$$
\rho(B_G)<1\iff \frac{3|ab|}{100}<1\iff |ab|<\frac{100}{3}
$$


## 第三题

对于线性方程组$\begin{pmatrix}3&2\\1&2\end{pmatrix}\begin{pmatrix}x\\y\end{pmatrix}=\begin{pmatrix}3\\-1\end{pmatrix}$，若使用迭代法
$$
\begin{pmatrix}
x_{n+1}\\
y_{n+1}
\end{pmatrix}=
\begin{pmatrix}
x_{n}\\
y_{n}
\end{pmatrix}+
\alpha\left(
\begin{pmatrix}3&2\\1&2\end{pmatrix}\begin{pmatrix}x_n\\y_n\end{pmatrix}-\begin{pmatrix}3\\-1\end{pmatrix}
\right)
$$
求迭代法收敛的充分必要条件，并求出收敛最快的$\alpha$。

解：一阶线性定常迭代为
$$
\begin{pmatrix}
x_{n+1}\\
y_{n+1}
\end{pmatrix}=
\left(\alpha \begin{pmatrix}3&2\\1&2\end{pmatrix}+\begin{pmatrix}1&0\\0&1\end{pmatrix}\right)
\begin{pmatrix}
x_{n}\\
y_{n}
\end{pmatrix}-\alpha\begin{pmatrix}3\\-1\end{pmatrix}
$$
迭代矩阵为
$$
B=\alpha \begin{pmatrix}3&2\\1&2\end{pmatrix}+\begin{pmatrix}1&0\\0&1\end{pmatrix}=
\begin{pmatrix}
3\alpha+1&2\alpha\\
\alpha& 2\alpha+1
\end{pmatrix}
$$
而$B$​的特征值为
$$
a+1,\qquad 4a+1
$$
因此
$$
\rho(B)=\max\left\{ |\alpha+1|,|4\alpha+1| \right\}=\begin{cases}
|\alpha+1|,\qquad & -\frac{2}{5}\le a\le 0\\
|4\alpha+1|,\qquad & a<-\frac{2}{5}或a>0
\end{cases}
$$
而迭代收敛$\iff$
$$
\rho(B)<1\iff
\max\left\{ |\alpha+1|,|4\alpha+1| \right\}<1
\iff -\frac{1}{2}<\alpha<0
$$
而
$$
\min\rho(B)=\rho(-2/5)=3/5
$$
因此当$\alpha=-2/5$时，收敛速度最快。

# 第十二周

## 第一题

证明：对于
$$
A=\begin{pmatrix}
3&0&-2\\
0&2&1\\
-2&1&2
\end{pmatrix}
$$
使用Jacobi迭代和Gauss-Seidel迭代解线性方程$Ax=b$均收敛，试比较哪种方法收敛快。

证明：定义
$$
D=\begin{pmatrix}
3&0&0\\
0&2&0\\
0&0&2
\end{pmatrix},\qquad 
L=\begin{pmatrix}
0&0&0\\
0&0&0\\
2&-1&0
\end{pmatrix},\qquad 
U=\begin{pmatrix}
0&0&2\\
0&0&-1\\
0&0&0
\end{pmatrix}
$$
注意到$A$​与$2D-A$的特征多项式均为
$$
1-11x+7x^2-x^3
$$
因此$A$与$2D-A$的特征值均为正数，进而$A$与$2D-A$均为正定矩阵，从而使用Jacobi迭代和Gauss-Seidel迭代解线性方程$Ax=b$均收敛。

为比较收敛速度，对于Jacobi迭代
$$
B_J=I-D^{-1}A,\qquad \rho(B_J)=\frac{\sqrt{33}}{6}
$$
对于Gauss-Seidel迭代
$$
B_G=I-(D-L)^{-1}A,\qquad \rho(B_G)=\frac{11}{12}
$$
而$\rho(B_J)>\rho(B_G)$，因此Gauss-Seidel迭代更快。

## 第二题

证明：对于线性方程组$Ax=b$，其中$A$为对称正定矩阵，迭代公式
$$
x^{(n+1)}=x^{(n)}+w(b-Ax^{(n)})
$$
在$0<w<2/\lambda_\max$时收敛，其中$\lambda_\max$为矩阵$A$的最大特征值。

证明：迭代公式为
$$
x^{(n+1)}=(I-wA)x^{(n)}+wb
$$
此为一阶定常迭代，因此迭代收敛的充分必要条件为
$$
\rho(I-wA)<1
$$
考察矩阵$I-wA$的特征值，注意到
$$
(I-wA)x=(1-w\lambda) x\iff Ax=\lambda x
$$
因此记矩阵$A$的最大与最小特征值为$\lambda_\max$与$\lambda_\min$，那么
$$
\rho(I-wA)=\max\{ |1-w\lambda_\max|,|1-w\lambda_\min| \}<1\iff 0<w<\frac{2}{\lambda_\max}
$$

## 第三题

求解方程$x=1+1/x^2$在$x_0=1.5$附近的根，迭代公式为$x_{n+1}=1+1/x_n^2$。

解：记$f(x)=1+1/x^2$，注意到
$$
f(1.3)=\frac{269}{169}\in(1.3,1.6),\qquad 
f(1.6)=\frac{89}{64}\in(1.3,1.6)
$$
因此存在$x^*\in(1.3,1.6)$，使得成立$f(x^*)=x^*$。而
$$
f'(x)=-\frac{2}{x^3}\in\left[-\frac{1000}{2197},-\frac{125}{256}\right],\qquad x\in[1.3,1.6]\implies |f'(x)|\le 0.92
$$
进而不动点迭代收敛，收敛速度为
$$
|x_n-x^*|<\frac{0.92^n}{1-0.92}|x_1-x_0|
$$
二分法收敛速度为
$$
|x_n-x^*|<\frac{0.1}{2^{n+1}}
$$
从而二分法收敛速度快。若要求误差小于$0.5\times10^{-5}$，则使用求得根为
$$
x^*=1.46557
$$

## 第四题

求解方程$x=\sqrt[3]{1+x^2}$在$x_0=1.5$附近的根，迭代公式为$x_{n+1}=\sqrt[3]{1+x_n^2}$。

解：记$f(x)=\sqrt[3]{1+x^2}$，注意到
$$
f(1.4)=\frac{1}{5}\sqrt[3]{370}\in(1.4,1.5),\qquad 
f(1.5)=\frac{1}{2}\sqrt[3]{26}\in(1.4,1.5)
$$
因此存在$x^*\in(1.4,1.5)$，使得成立$f(x^*)=x^*$。而
$$
f'(x)=\frac{2}{3}x\frac{\sqrt[3]{1+x^2}}{1+x^2}\in\left[\frac{7}{111}\sqrt[3]{370},\frac{2}{13}\sqrt[3]{26}\right],\quad x\in[1.4,1.5]\implies |f'(x)|\le 0.46
$$
进而不动点迭代收敛，收敛速度为
$$
|x_n-x^*|<\frac{0.46^n}{1-0.46}|x_1-x_0|
$$
二分法收敛速度为
$$
|x_n-x^*|<\frac{0.1}{2^{n+1}}
$$
从而不动点迭代收敛速度快。若要求误差小于$0.5\times10^{-5}$，则使用不动点迭代求得根为
$$
x^*=1.46557
$$

## 第五题

求解方程$x=1/\sqrt{x-1}$在$x_0=1.5$附近的根，迭代公式为$x_{n+1}=1/\sqrt{x_n-1}$。

解：记$f(x)=1/\sqrt{x-1}$，注意到
$$
f(1.4)=\frac{1}{2}\sqrt{10}>1.4,\qquad 
f(1.5)=\sqrt{2}<1.5
$$
因此存在$x^*\in(1.4,1.5)$，使得成立$f(x^*)=x^*$。而
$$
f'(x)=-\frac{1}{2(x-1)^{\frac{3}{2}}}\in\left[-\frac{5}{8}\sqrt{10},-\sqrt{2}\right],\qquad x\in[1.4,1.5]\implies |f'(x)|>1
$$
进而不动点迭代不收敛，若要求误差小于$0.5\times10^{-5}$，则使用二分法求得根为
$$
x^*=1.46557
$$

# 第十三周

## 第一题

应用Newton法于方程$f(x)=x^n-a=0$和方程$f(x)=1-a/x^n=0$，分别求出$\sqrt[n]{a}$的迭代公式，并求
$$
\lim_{n\to\infty}\frac{\sqrt[n]{a}-x_{n+1}}{(\sqrt[n]{a}-x_{n})^2}
$$

解：对于
$$
f(x)=x^n-a,\qquad 
f'(x)=nx^{n-1},\qquad
f''(x)=n(n-1)x^{n-2}
$$
迭代公式为
$$
x_{k+1}=(1-\frac{1}{n})x_k+\frac{a}{nx_k^{n-1}}
$$
由于
$$
f(\sqrt[n]{a})=0,\qquad 
f'(\sqrt[n]{a})=na^{1-1/n}
$$
那么该迭代公式在$\sqrt[n]{a}$附近平方收敛，且
$$
\lim_{k\to\infty}\frac{\sqrt[n]{a}-x_{k+1}}{(\sqrt[n]{a}-x_{k})^2}=-\frac{f''(\sqrt[n]{a})}{2f'(\sqrt[n]{a})}=\frac{1-n}{2\sqrt[n]{a}}
$$

对于
$$
f(x)=1-\frac{a}{x^n},\qquad 
f'(x)=\frac{an}{x^{n+1}},\qquad
f''(x)=-\frac{an(n+1)}{x^{n+2}}
$$
迭代公式为
$$
x_{k+1}=(1+\frac{1}{n})x_k+\frac{x_k^{n+1}}{an}
$$
由于
$$
f(\sqrt[n]{a})=0,\qquad 
f'(\sqrt[n]{a})=\frac{n}{\sqrt[n]{a}}
$$
那么该迭代公式在$\sqrt[n]{a}$附近平方收敛，且
$$
\lim_{k\to\infty}\frac{\sqrt[n]{a}-x_{k+1}}{(\sqrt[n]{a}-x_{k})^2}=-\frac{f''(\sqrt[n]{a})}{2f'(\sqrt[n]{a})}=\frac{n+1}{2\sqrt[n]{a}}
$$

## 第二题

证明迭代公式
$$
x_{n+1}=\frac{x_n(x_n^2+3a)}{3x_n^2+a}
$$
是计算$\sqrt{a}$的三阶方法。如果初值$x_0$充分靠近根$\sqrt{a}$，求
$$
\lim_{n\to\infty}\frac{\sqrt{a}-x_{n+1}}{(\sqrt{a}-x_{n})^3}
$$

证明：令
$$
f(x)=\frac{x(x^2+3a)}{3x^2+a}
$$
那么$f(\sqrt{a})=\sqrt{a}$，且
$$
f'(x)=\frac{3(a-x^2)^2}{(a+3 x^2)^2},\qquad
f'(\sqrt{a})=0
$$
那么方程$x=f(x)$在$\sqrt{a}$附近存在且存在唯一解$x^*=\sqrt{a}$。

（法一）由于
$$
\lim_{n\to\infty}\frac{f(x_n)-\sqrt{a}}{(x_n-\sqrt{a})^3}
=\lim_{x\to\sqrt{a}}\frac{f(x)-\sqrt{a}}{(x-\sqrt{a})^3}
=\lim_{x\to\sqrt{a}}\frac{\frac{x(x^2+3a)}{3x^2+a}-\sqrt{a}}{(x-\sqrt{a})^3}
=\lim_{x\to\sqrt{a}}\frac{1}{a+3 x^2}
=\frac{1}{4a}
$$
因此迭代公式$x_{n+1}=f(x_n)$是计算$\sqrt{a}$的三阶方法。

（法二）由于
$$
\begin{align}
&f''(x)=\frac{48 a x(x^2-a)}{(a+3 x^2)^3},\qquad f''(\sqrt{a})=0\\
&f'''(x)=-\frac{48 a(a^2-18 a x^2+9 x^4)}{(a+3
   x^2)^4},\qquad f'''(\sqrt{a})=\frac{3}{2a}
\end{align}
$$
因此迭代公式$x_{n+1}=f(x_n)$是计算$\sqrt{a}$的三阶方法，且
$$
\lim_{n\to\infty}\frac{f(x_n)-\sqrt{a}}{(x_n-\sqrt{a})^3}
=\frac{f'''(\sqrt{a})}{3!}=\frac{1}{4a}
$$

## 第三题

用如下方法求$f(x)=x^3-3x-1$的在$x_0=2$附近的零点，零点的准确值为
$$
x^*=1.87938524\cdots
$$
要求计算结果四位有效数字准确。

### 第一问

Newton法，$x_0=2$

解：Newton迭代为
$$
x_{n+1}=\varphi(x_n),\qquad 
\varphi(x)=x-\frac{f(x)}{f'(x)}
$$
代入可得
$$
x_{n+1}=\frac{2x_n^3+1}{3(x_n^2-1)}
$$
代入数据可得
$$
\small{
x_0=2,\quad 
x_1=\frac{17}{9}\approx 1.88889,\quad 
x_2=\frac{10555}{5616}\approx 1.87945,\quad 
x_3=\frac{1264474496323}{672812825256}\approx1.87939
}
$$

## 第四题

对于$f(x)=0$的Newton公式
$$
x_{n+1}=x_{n}-\frac{f(x_n)}{f'(x_n)}
$$
证明：
$$
\lim_{n\to\infty}\frac{x_{n+2}-x_{n+1}}{(x_{n+1}-x_n)^2}=-\frac{f''(x^*)}{2f'(x^*)}
$$
其中$f(x^*)=0$。

证明：由于
$$
\lim_{n\to\infty}\frac{x_{n+1}-x^*}{(x_n-x^*)^2}=\frac{f''(x^*)}{2f'(x^*)}
$$
那么
$$
\begin{align}
\lim_{n\to\infty}\frac{x_{n+2}-x_{n+1}}{(x_{n+1}-x_n)^2}
= & -\lim_{n\to\infty} \frac{f(x_{n+1})/f'(x_{n+1})}{(f(x_n)/f'(x_n))^2} \\
= & -\lim_{n\to\infty} \frac{f(x_{n+1})(f'(x_n))^2}{f'(x_{n+1})(f(x_n))^2} \\
= & -\lim_{n\to\infty} \frac{(f(x_{n+1})-f(x^*))(f'(x_n))^2}{f'(x_{n+1})(f(x_n)-f(x^*))^2} \\
= & -\lim_{n\to\infty} \frac{f'(\xi_{n+1})(x_{n+1}-x^*)(f'(x_n))^2}{f'(x_{n+1})(f'(\xi_n))^2(x_n-x^*)^2} \\
= & -\lim_{n\to\infty} \frac{f'(\xi_{n+1})(f'(x_n))^2}{f'(x_{n+1})(f'(\xi_n))^2}\frac{x_{n+1}-x^*}{(x_n-x^*)^2} \\
= & -\frac{f''(x^*)}{2f'(x^*)}
\end{align}
$$

# 第十四周

## 第一题

非线性方程组
$$
\begin{cases}
3x^2-y^2=0\\
3xy^2-x^3-1=0
\end{cases}
$$
在$(0.4,0.7)$附近存在解，构造不动点迭代，使得其收敛至此解，并计算精确到$10^{-5}$，其中向量范数为$\|\cdot\|_\infty$。

解：记
$$
\Phi\begin{pmatrix}
x\\y
\end{pmatrix}=\begin{pmatrix}
\displaystyle\frac{1}{\sqrt{3}}y\\
\displaystyle\sqrt{\frac{1+x^3}{3x}}
\end{pmatrix}
$$
那么原方程组的解为向量函数$\Phi$的不动点。设迭代区域为$D=[0.4,0.6]\times[0.7,1]$，由于$\Phi$的Jacobi矩阵为
$$
\small{
\Phi'\begin{pmatrix}
x\\y
\end{pmatrix}=\begin{pmatrix}
\displaystyle0&\frac{1}{\sqrt{3}}\\
\displaystyle\frac{2 x^3-1}{2\sqrt{3x^3(x^3+1)}}& 0
\end{pmatrix}\implies 
\rho\left( \Phi'\begin{pmatrix}
x\\y
\end{pmatrix} \right)
=\sqrt{\frac{1-2 x^3}{6\sqrt{x^3(x^3+1)}}}
\le\frac{\sqrt{109}}{2 \sqrt{3} \sqrt[4]{266}}\approx 0.75
}
$$
进而在$(x^*,y^*)$的邻域内该不动点迭代收敛。迭代结果如下表

|   $n$   |   $x$   |               $y$               |
| :---: | :----------------------------: | :---: |
| $0$ | $0.4$ | $0.7$ |
|   $1$   |   $0.404145$   |   $0.94163$    |
|   $2$   |   $0.54365$    |   $0.937673$   |
|   $3$   |   $0.541366$   |   $0.843598$   |
|   $4$   |   $0.487052$   |   $0.844641$   |
|   $5$   |   $0.487654$   |   $0.873764$   |
|   $6$   |   $0.504468$   |   $0.873392$   |
|   $7$   |   $0.504253$   |   $0.863476$   |
|   $8$   |   $0.498528$   |   $0.863598$   |
|   $9$   |   $0.498598$   |   $0.866878$   |
|   $10$   |   $0.500492$   |   $0.866838$   |
|   $11$   |   $0.500469$   |   $0.865741$   |
|   $12$   |   $0.499836$   |   $0.865755$   |
|   $13$   |   $0.499844$   |   $0.86612$    |
|   $14$   |   $0.500055$   |   $0.866116$   |
|   $15$   |   $0.500052$   |   $0.865994$   |
|   $16$   |   $0.499982$   |   $0.865995$   |
|   $17$   |   $0.499983$   |   $0.866036$   |
|   $18$   |   $0.500006$   |   $0.866035$   |
|   $19$   |   $0.500006$   |   $0.866022$   |
| 精确解 | $0.5$ | $\sqrt{3}/2\approx0.86602540$ |

# 第十五周

## 第一题

用改进Euler法和梯形法解初值问题
$$
y'=x^2+x-y,\qquad y(0)=y
$$
取步长$h=0.1$，计算到$x=0.5$，并与精确解$y=-\mathrm{e}^{-x}+x^2-x+1$相比较。

解：使用Euler法
$$
y_{n+1}=y_n+\frac{1}{10}(x_n^2+x_n-y_n),\qquad x_n=x_0+nh
$$
可得
$$
\small{
y(0)=0,\quad 
y(0.1)=0,\quad 
y(0.2)=0.011,\quad 
y(0.3)=0.039,\quad 
y(0.4)=0.06951,\quad 
y(0.5)=0.118559
}
$$

使用梯形法
$$
\begin{align}
& y_{n+1}=y_n+\frac{1}{20}(x_n^2+x_n-y_n+x_{n+1}^2+x_{n+1}-y_{n+1})\\
\iff & y_{n+1}=\frac{1}{21}(x_n^2+x_n+x_{n+1}^2+x_{n+1}+19y_n)
\end{align}
$$
可得
$$
\small{
\begin{align}
&y(0)=0
&&y(0.1)=\frac{11}{2100}\approx0.00524
&&y(0.2)=\frac{236}{11025}\approx0.02141 \\
&y(0.3)=\frac{45719}{926100}\approx0.04937
&&y(0.4)=\frac{437114}{4862025}\approx0.08990
&&y(0.5)=\frac{2347907}{16336404}\approx0.14372
\end{align}
}
$$
与精确解的比较

|       | 精确解  | Euler法 |  误差   | 梯形法  |  误差   |
| :---: | :-----: | :-----: | :-----: | :-----: | :-----: |
| $y_0$ |    0    |    0    |    0    |    0    |    0    |
| $y_1$ | 0.00516 |    0    | 0.00516 | 0.00524 | 0.00008 |
| $y_2$ | 0.02127 |  0.011  | 0.01027 | 0.02141 | 0.00014 |
| $y_3$ | 0.04918 |  0.039  | 0.01018 | 0.04937 | 0.00019 |
| $y_4$ | 0.08968 | 0.06951 | 0.02017 | 0.08990 | 0.00022 |
| $y_5$ | 0.14347 | 0.11856 | 0.02491 | 0.14372 |  0.00   |

# 第十六周

## 第一题

证明：对于任意$t$，如下Runge-Kutta方法为二阶精度
$$
\begin{cases}
\displaystyle y_{n+1}=y_n+\frac{h}{2}(K_2+K_3)\\
\displaystyle K_1=f(x_n,y_n)\\
\displaystyle K_2=f(x_n+th,y_n+thK_1)\\
\displaystyle K_3=f(x_n+(1-t)h,y_n+(1-t)hK_1)
\end{cases}
$$

证明：截断误差为
$$
\small{
T_{n+1}=y(x_{n}+h)-y_n-\frac{h}{2}(f(x_n+th,y_n+thf_n)+f(x_n+(1-t)h,y_n+(1-t)hf_n))
}
$$
其中
$$
y_n=y(x_n),\qquad f_n=f(x_n,y_n)
$$
作Taylor展开
$$
\begin{align}
&y(x_n+h)
=y_n+hy_n'+\frac{h^2}{2}y_n''+O(h^3)
=y_n+hf_n+\frac{h^2}{2}(f_x+f_yf_n)+O(h^3)\\
&f(x_n+th,y_n+thf_n)=f_n+thf_x+thf_yf_n+O(h^2)\\
&f(x_n+(1-t)h,y_n+(1-t)hf_n)=f_n+(1-t)hf_x+(1-t)hf_yf_n+O(h^2)
\end{align}
$$
其中
$$
f_x=f_x(x_n,y_n),\qquad 
f_y=f_y(x_n,y_n)
$$
因此
$$
\small{
\begin{align}
T_{n+1}
= & y(x_{n}+h)-y_n-\frac{h}{2}(f(x_n+th,y_n+thf_n)+f(x_n+(1-t)h,y_n+(1-t)hf_n))\\
= & y_n+hf_n+\frac{h^2}{2}(f_x+f_yf_n)+O(h^3)-y_n\\
& -\frac{h}{2}(f_n+thf_x+thf_yf_n+O(h^2))\\
& -\frac{h}{2}(f_n+(1-t)hf_x+(1-t)hf_yf_n+O(h^2))\\
= & O(h^3)
\end{align}
}
$$
因此该Runge-Kutta方法为二阶精度。