# 第一周

## 第一题

某商业集团公司在$A_1,A_2,A_3$三地设有仓库，分别库存$40,20,40$个单位产品，而其零售商店分布在地区$B_1,B_2,B_3,B_4,B_5$，其需要的产品数量分别是$25,10,20,30,15$个单位，产品从$A_i$到$B_j$的每单位装运费列于下表：

| 转运费 | $B_1$ | $B_2$ | $B_3$ | $B_4$ | $B_5$ |
| :----: | :---: | :---: | :---: | :---: | :---: |
| $A_1$  | $55$  | $30$  | $40$  | $50$  | $40$  |
| $A_2$  | $35$  | $30$  | $100$ | $45$  | $60$  |
| $A_3$  | $40$  | $60$  | $95$  | $35$  | $30$  |

试建立装运费最省调运方案的数学模型。

解：记$x_{ij}$为从$A_i$到$B_j$​运送的产品数量，从而建立装运费最省调运方案的数学模型如下。
$$
\begin{align}
& \text{min}  \quad  \begin{aligned}[t]
  & 55x_{11}+30x_{12}+40x_{13}+50x_{14}+40x_{15}\\
+ & 35x_{21}+30x_{22}+100x_{23}+45x_{24}+60x_{25}\\
+ & 40x_{31}+60x_{32}+95x_{33}+35x_{34}+30x_{35}
\end{aligned}\\
& \text{s.t.} \;\, \quad \begin{cases}
x_{11}+x_{12}+x_{13}+x_{14}+x_{15}\le 40\\
x_{21}+x_{22}+x_{23}+x_{24}+x_{25}\le 20\\
x_{31}+x_{32}+x_{33}+x_{34}+x_{35}\le 40\\
x_{11}+x_{21}+x_{31}=25\\
x_{12}+x_{22}+x_{32}=10\\
x_{13}+x_{23}+x_{33}=20\\
x_{14}+x_{24}+x_{34}=30\\
x_{15}+x_{25}+x_{35}=15\\
x_{ij}\ge 0,i=1,2,3;j=1,2,3,4,5
\end{cases}
\end{align}
$$


## 第二题

将下面的线性规划问题化为标准形
$$
\begin{align}
& \text{max}  \quad x_1-x_2+2x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1-2x_2+3x_3\ge 6\\
2x_1+x_2-x_3\le 3\\
0\le x_1 \le 3\\
-1\le x_2\le 6
\end{cases}
\end{align}
$$

解：线性规划问题的标准形为
$$
\begin{align}
& \text{min}  \quad \boldsymbol{c}^T\boldsymbol{x}\\
& \text{s.t.} \;\, \quad \begin{cases}
\boldsymbol{A} \boldsymbol{x} = \boldsymbol{b}\\
\boldsymbol{x} \ge \boldsymbol{0}
\end{cases}
\end{align}
$$

令$x_2^*=x_2+1$，引入非负变量$x_3^+,x_3^-,x_4,x_5,x_6,x_7$​，使得成立
$$
\begin{align}
& \text{min}  \quad -x_1+x_2^*-2(x_3^+-x_3^-)\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1-2x_2^*+3(x_3^+-x_3^-)-x_4=4\\
2x_1+x_2^*-(x_3^+-x_3^-)+x_5=4\\
x_1+x_6=3\\
x_2^*+x_7=7\\
x_1,x_2^*,x_3^+,x_3^-,x_4,x_5,x_6,x_7\ge 0
\end{cases}
\end{align}
$$

## 第三题

### 第一问

用图解法求解下列线性规划问题。
$$
\begin{align}
& \text{max}  \quad x_1+3x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+x_2\ge 20\\
6\le x_1\le 12\\
x_2\ge 2
\end{cases}
\end{align}
$$

解：由图解法可知该线性规划问题可行域非空，但是目标函数无界。事实上，取
$$
x_1=10,\qquad
x_2=10+n,\qquad
n\in\N^*
$$
那么$x_1+3x_2=40+3n$无上界。

![1.3.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\1.3.1.svg)

### 第二问

用图解法求解下列线性规划问题。
$$
\begin{align}
& \text{max}  \quad x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+5x_2\ge12\\
x_1+2x_2\le 8\\
0\le x_1\le 4\\
0\le x_2\le 3
\end{cases}
\end{align}
$$

解：由图解法可知该线性规划问题可行域非空，目标函数上界为$8$。事实上，由约束条件可知$x_1+2x_2\le 8$，而$(x_1,x_2)=(2,3)$为可行点，此时$x_1+2x_2\le 8$，因此函数上界为$8$。

![1.3.2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\1.3.2.svg)

# 第二周

## 第一题

### 第一问

证明：凸集的任意交为凸集。

证明：任取一族凸集$\{C_\lambda\}_{\lambda\in\Lambda}$，记
$$
C=\bigcap_{\lambda\in\Lambda}C_\lambda
$$
任取$x,y\in C$与$\mu\in [0,1]$，由于对于任意$\lambda\in\Lambda$，$C_\lambda$为凸集，那么
$$
\mu x+(1-\mu)y\in C_\lambda
$$
因此
$$
\mu x+(1-\mu)y\in \bigcap_{\lambda\in\Lambda}C_\lambda=C
$$
进而$C$为凸集。

### 第二问

构造两个凸集，使其并不为凸集。

解：在$\R$中考虑，构造凸集
$$
A=[-2,-1],\qquad 
B=[1,2]
$$
那么
$$
A\cup B=[-2,-1]\cup [1,2]
$$
显然不为凸集，这是因为
$$
-1\in A\cup B,\qquad 1\in A\cup B,\qquad 
\frac{1}{2}\times (-1)+\frac{1}{2}\times 1=0\notin A\cup B
$$

## 第二题

某线性规划问题的约束条件是
$$
\begin{cases}
-2x_1+2x_2+x_3=4\\
3x_1+x_2+x_4=6\\
x_1,x_2,x_3,x_4\ge 0
\end{cases}
$$
问变量$x_2,x_4$所对应的列向量$\boldsymbol{A}_2,\boldsymbol{A}_4$是否构成可行基？若是，写出$\boldsymbol{B},\boldsymbol{N}$，并求出$\boldsymbol{B}$​所对应的基本可行解。

证明：约束矩阵为
$$
\boldsymbol{A}=\begin{pmatrix}
-2 & 2 & 1 & 0\\
3 & 1 & 0 & 1
\end{pmatrix}
$$
那么
$$
\boldsymbol{A}_2=\begin{pmatrix}
2\\1
\end{pmatrix},\qquad 
\boldsymbol{A}_4=\begin{pmatrix}
0\\1
\end{pmatrix}
$$
此时
$$
(\boldsymbol{A}_2, \boldsymbol{A}_4)=\begin{pmatrix}
2 & 0\\
1 & 1
\end{pmatrix}
$$
显然为非退化方阵。作变量替换
$$
y_1=x_2,\qquad 
y_2=x_4,\qquad 
y_3=x_1,\qquad 
y_4=x_3
$$
此时约束矩阵为
$$
\boldsymbol{A}'=\begin{pmatrix}
2 & 0 & -2 & 1\\
1 & 1 & 3 & 0
\end{pmatrix}
$$
那么
$$
\boldsymbol{B}=\begin{pmatrix}
2 & 0\\
1 & 1
\end{pmatrix},\qquad 
\boldsymbol{N}=\begin{pmatrix}
-2 & 1\\
3 & 0
\end{pmatrix},\qquad 
\boldsymbol{b}=\begin{pmatrix}
4\\6
\end{pmatrix}
$$
由于
$$
\boldsymbol{y}_B=\boldsymbol{B}^{-1}\boldsymbol{b}=
\begin{pmatrix}
2\\4
\end{pmatrix}\ge  \boldsymbol{0}
$$
因此变量$x_2,x_4$所对应的列向量$\boldsymbol{A}_2,\boldsymbol{A}_4$构成可行基，$\boldsymbol{B}$​​所对应的基本可行解为
$$
\boldsymbol{y}=\begin{pmatrix}
\boldsymbol{B}^{-1}\boldsymbol{b}\\
\boldsymbol{0}
\end{pmatrix}=
\begin{pmatrix}
2\\4\\0\\0
\end{pmatrix}
$$
从而原基本可行解为
$$
\boldsymbol{x}=
\begin{pmatrix}
0\\2\\0\\4
\end{pmatrix}
$$

## 第三题

对于下面的线性规划问题，以$\boldsymbol{B}=(\boldsymbol{A}_2,\boldsymbol{A}_3,\boldsymbol{A}_6)$​为基写出对应的典式。
$$
\begin{align}
& \text{min}  \quad x_1-2x_2+x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
3x_1-x_2+2x_3+x_4=7\\
-2x_1+4x_2+x_5=12\\
-4x_1+3x_2+8x_3+x_6=10\\
x_1,x_2,x_3,x_4,x_5,x_6\ge 0
\end{cases}
\end{align}
$$
解：约束矩阵为
$$
\boldsymbol{A}=\begin{pmatrix}
3 & -1 & 2 & 1 & 0 & 0\\
-2 & 4 & 0 & 0 & 1 & 0\\
-4 & 3 & 8 & 0 & 0 & 1\\
\end{pmatrix}
$$
右端向量为
$$
\boldsymbol{b}=\begin{pmatrix}
7\\12\\10
\end{pmatrix}
$$
作变量代换
$$
y_1=x_2,\quad
y_2=x_3,\quad
y_3=x_6,\quad
y_4=x_1,\quad
y_5=x_4,\quad
y_6=x_5
$$
那么
$$
\boldsymbol{A}'=\begin{pmatrix}
-1 & 2 & 0 & 3 & 1 & 0\\
4 & 0 & 0 & -2 & 0 & 1\\
3 & 8 & 1 & -4 & 0 & 0
\end{pmatrix}
$$
因而
$$
\boldsymbol{B}=(\boldsymbol{A}_2,\boldsymbol{A}_3,\boldsymbol{A}_6)
=(\boldsymbol{A}_1',\boldsymbol{A}_2',\boldsymbol{A}_3')
=\begin{pmatrix}
-1 & 2 & 0 \\
4 & 0 & 0 \\
3 & 8 & 1 
\end{pmatrix},\qquad 
\boldsymbol{N}=
\begin{pmatrix}
3 & 1 & 0\\
-2 & 0 & 1\\
-4 & 0 & 0
\end{pmatrix}
$$
由于$|\boldsymbol{B}|=-8$，那么$\boldsymbol{B}$为非退化矩阵，因此其对应的典型方程为
$$
\boldsymbol{y}_B=\boldsymbol{B}^{-1}\boldsymbol{b}-\boldsymbol{B}^{-1}\boldsymbol{N}\boldsymbol{y}_N
\iff
\begin{pmatrix}
y_1\\y_2\\y_3
\end{pmatrix}
=\begin{pmatrix}
3\\5\\-39
\end{pmatrix}
-
\begin{pmatrix}
 -\frac{1}{2} & 0 & \frac{1}{4} \\
 \frac{5}{4} & \frac{1}{2} & \frac{1}{8} \\
 -\frac{25}{2} & -4 & -\frac{7}{4} \\
\end{pmatrix}
\begin{pmatrix}
y_4\\y_5\\y_6
\end{pmatrix}
$$
等价于
$$
\begin{cases}
y_1=3+\frac{1}{2}y_4-\frac{1}{4}y_6\\
y_2=5-\frac{5}{4}y_4-\frac{1}{2}y_5-\frac{1}{8}y_6\\
y_3=-39+\frac{25}{2}y_4+4y_5+\frac{7}{4}y_6
\end{cases}
\iff
\begin{cases}
x_2=3+\frac{1}{2}x_1-\frac{1}{4}x_5\\
x_3=5-\frac{5}{4}x_1-\frac{1}{2}x_4-\frac{1}{8}x_5\\
x_6=-39+\frac{25}{2}x_1+4x_4+\frac{7}{4}x_5
\end{cases}
$$

# 第三周

## 第一题

用单纯形法求解下面的线性规划问题，并在平面上画出迭代点走过的路线。
$$
\begin{align}
& \text{min}  \quad z=-2x_1-x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+5x_2\le 60\\
x_1+x_2\le 18\\
3x_1+x_2\le 44\\
x_2\le 10\\
x_1,x_2\ge 0
\end{cases}
\end{align}
$$
解：化为标准形式
$$
\begin{align}
& \text{min}  \quad z=-2x_1-x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+5x_2+x_3=60\\
x_1+x_2+x_4=18\\
3x_1+x_2+x_5=44\\
x_2+x_6=10\\
x_1,x_2,x_3,x_4,x_5,x_6\ge 0
\end{cases}
\end{align}
$$
单纯形表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $2$  |  $1$  |  $0$  |  $0$  |  $0$  |  $0$  |     $0$      |
| $x_3$ |  $2$  |  $5$  |  $1$  |  $0$  |  $0$  |  $0$  |     $60$     |
| $x_4$ |  $1$  |  $1$  |  $0$  |  $1$  |  $0$  |  $0$  |     $18$     |
| $x_5$ | $3^*$ |  $1$  |  $0$  |  $0$  |  $1$  |  $0$  |     $44$     |
| $x_6$ |  $0$  |  $1$  |  $0$  |  $0$  |  $0$  |  $1$  |     $10$     |

|       | $x_1$ |  $x_2$  | $x_3$ | $x_4$ | $x_5$  | $x_6$ | $\text{RHS}$ |
| :---: | :---: | :-----: | :---: | :---: | :----: | :---: | :----------: |
|  $z$  |  $0$  |  $1/3$  |  $0$  |  $0$  | $-2/3$ |  $0$  |   $-88/3$    |
| $x_3$ |  $0$  | $13/3$  |  $1$  |  $0$  | $-2/3$ |  $0$  |    $92/3$    |
| $x_4$ |  $0$  | $2/3^*$ |  $0$  |  $1$  | $-1/3$ |  $0$  |    $10/3$    |
| $x_1$ |  $1$  |  $1/3$  |  $0$  |  $0$  | $1/3$  |  $0$  |    $44/3$    |
| $x_6$ |  $0$  |   $1$   |  $0$  |  $0$  |  $0$   |  $1$  |     $10$     |

|       | $x_1$ | $x_2$ | $x_3$ |  $x_4$  | $x_5$  | $x_6$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :-----: | :----: | :---: | :----------: |
|  $z$  |  $0$  |  $0$  |  $0$  | $-1/2$  | $-1/2$ |  $0$  |    $-31$     |
| $x_3$ |  $0$  |  $0$  |  $1$  | $-13/2$ | $3/2$  |  $0$  |     $9$      |
| $x_2$ |  $0$  |  $1$  |  $0$  |  $3/2$  | $-1/2$ |  $0$  |     $5$      |
| $x_1$ |  $1$  |  $0$  |  $0$  | $-1/2$  | $1/2$  |  $0$  |     $13$     |
| $x_6$ |  $0$  |  $0$  |  $0$  | $-3/2$  | $1/2$  |  $1$  |     $5$      |

因此该线性规划问题的最优解为
$$
x_1=13,\qquad x_2=5,\qquad x_3=9,\qquad x_4=0,\qquad x_5=0,\qquad x_6=5
$$
最优值为$z=-31$。迭代点为
$$
(x_1,x_2)=(0,0)\to(44/3,0)\to(13,5)
$$

![3.1.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\3.1.1.svg)

## 第二题

用单纯形法求解下面的线性规划问题。
$$
\begin{align}
& \text{min}  \quad z=x_1-x_2+x_3+x_5-x_6\\
& \text{s.t.} \;\, \quad \begin{cases}
3x_3+x_5+x_6=6\\
x_2+2x_3-x_4=10\\
-x_1+x_6=0\\
x_3+x_6+x_7=6\\
x_1,x_2,x_3,x_4,x_5,x_6,x_7\ge 0
\end{cases}
\end{align}
$$

解：初始表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $-1$  |  $1$  | $-1$  |  $0$  | $-1$  |  $1$  |  $0$  |     $0$      |
| $x_5$ |  $0$  |  $0$  |  $3$  |  $0$  |  $1$  |  $1$  |  $0$  |     $6$      |
| $x_2$ |  $0$  |  $1$  |  $2$  | $-1$  |  $0$  |  $0$  |  $0$  |     $10$     |
| $x_1$ | $-1$  |  $0$  |  $0$  |  $0$  |  $0$  |  $1$  |  $0$  |     $0$      |
| $x_7$ |  $0$  |  $0$  |  $1$  |  $0$  |  $0$  |  $1$  |  $1$  |     $6$      |

单纯形表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $0$   |   $0$   |   $0$   |   $1$   |   $0$   |   $1$   |   $0$   |      $-4$      |
| $x_5$ |   $0$   |   $0$   |   $3$   |   $0$   |   $1$   |  $1^*$  |   $0$   |      $6$       |
| $x_2$ |   $0$   |   $1$   |   $2$   |  $-1$   |   $0$   |   $0$   |   $0$   |      $10$      |
| $x_1$ |   $1$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |   $0$   |      $0$       |
| $x_7$ |   $0$   |   $0$   |   $1$   |   $0$   |   $0$   |   $1$   |   $1$   |      $6$       |


|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $0$   |   $0$   |  $-3$   |   $1$   |  $-1$   |   $0$   |   $0$   |     $-10$      |
| $x_6$ |   $0$   |   $0$   |   $3$   |   $0$   |   $1$   |   $1$   |   $0$   |      $6$       |
| $x_2$ |   $0$   |   $1$   |   $2$   |  $-1$   |   $0$   |   $0$   |   $0$   |      $10$      |
| $x_1$ |   $1$   |   $0$   |   $3$   |   $0$   |   $1$   |   $0$   |   $0$   |      $6$       |
| $x_7$ |   $0$   |   $0$   |  $-2$   |   $0$   |  $-1$   |   $0$   |   $1$   |      $0$       |


原问题无界。

## 第三题

用两阶段法求解下列问题。

### 第一问

$$
\begin{align}
& \text{max}  \quad z=3x_1+4x_2+2x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+x_2+x_3+x_4\le 30\\
3x_1+6x_2+x_3-2x_4\le 0\\
x_2\ge 4\\
x_1,x_2,x_3,x_4\ge 0
\end{cases}
\end{align}
$$

解：化为标准型
$$
\begin{align}
& \text{min}  \quad z=-3x_1-4x_2-2x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+x_2+x_3+x_4+x_5= 30\\
3x_1+6x_2+x_3-2x_4+x_6= 0\\
x_2-x_7=4\\
x_1,x_2,x_3,x_4,x_5,x_6,x_7\ge 0
\end{cases}
\end{align}
$$
引入人工变量$x_8$，考虑辅助问题。
$$
\begin{align}
& \text{min}  \quad g=x_8\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+x_2+x_3+x_4+x_5= 30\\
3x_1+6x_2+x_3-2x_4+x_6= 0\\
x_2-x_7+x_8=4\\
x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8\ge 0
\end{cases}
\end{align}
$$
第一阶段：初始表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $x_8$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $3$   |   $4$   |   $2$   |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |      $0$       |
|  $g$  |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |      $0$       |
| $x_5$ |   $1$   |   $1$   |   $1$   |   $1$   |   $1$   |   $0$   |   $0$   |   $0$   |      $30$      |
| $x_6$ |   $3$   |   $6$   |   $1$   |  $-2$   |   $0$   |   $1$   |   $0$   |   $0$   |      $0$       |
| $x_8$ |   $0$   |   $1$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |   $1$   |      $4$       |


单纯形表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $x_8$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $3$   |   $4$   |   $2$   |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |      $0$       |
|  $g$  |   $0$   |   $1$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |   $0$   |      $4$       |
| $x_5$ |   $1$   |   $1$   |   $1$   |   $1$   |   $1$   |   $0$   |   $0$   |   $0$   |      $30$      |
| $x_6$ |   $3$   |  $6^*$  |   $1$   |  $-2$   |   $0$   |   $1$   |   $0$   |   $0$   |      $0$       |
| $x_8$ |   $0$   |   $1$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |   $1$   |      $4$       |


|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $x_8$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $1$   |   $0$   |  $4/3$  |  $4/3$  |   $0$   | $-2/3$  |   $0$   |   $0$   |      $0$       |
|  $g$  | $-1/2$  |   $0$   | $-1/6$  |  $1/3$  |   $0$   | $-1/6$  |  $-1$   |   $0$   |      $4$       |
| $x_5$ |  $1/2$  |   $0$   |  $5/6$  |  $4/3$  |   $1$   | $-1/6$  |   $0$   |   $0$   |      $30$      |
| $x_2$ |  $1/2$  |   $1$   |  $1/6$  | $-1/3$  |   $0$   |  $1/6$  |   $0$   |   $0$   |      $0$       |
| $x_8$ | $-1/2$  |   $0$   | $-1/6$  |  $1/3^*$ |   $0$   | $-1/6$  |  $-1$   |   $1$   |      $4$       |


|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $x_8$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $3$   |   $0$   |   $2$   |   $0$   |   $0$   |   $0$   |   $4$   |  $-4$   |     $-16$      |
|  $g$  |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |      $0$       |
| $x_5$ |  $5/2$  |   $0$   |  $3/2$  |   $0$   |   $1$   |  $1/2$  |   $4$   |  $-4$   |      $14$      |
| $x_2$ |   $0$   |   $1$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |   $1$   |      $4$       |
| $x_4$ | $-3/2$  |   $0$   | $-1/2$  |   $1$   |   $0$   | $-1/2$  |  $-3$   |   $3$   |      $12$      |


因此辅助问题的最优解为
$$
x_1=0,\quad 
x_2=4,\quad 
x_3=0,\quad 
x_4=12,\quad 
x_5=14,\quad 
x_6=0,\quad 
x_7=0,\quad 
x_8=0
$$
最优值为$g=0$​，从而得到原问题的基本可行解
$$
x_1=0,\quad 
x_2=4,\quad 
x_3=0,\quad 
x_4=12,\quad 
x_5=14,\quad 
x_6=0,\quad 
x_7=0
$$

第二阶段：单纯形表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $3$   |   $0$   |   $2$   |   $0$   |   $0$   |   $0$   |   $4$   |     $-16$      |
| $x_5$ |  $5/2$  |   $0$   |  $3/2$  |   $0$   |   $1$   |  $1/2$  |  $4^*$  |      $14$      |
| $x_2$ |   $0$   |   $1$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |      $4$       |
| $x_4$ | $-3/2$  |   $0$   | $-1/2$  |   $1$   |   $0$   | $-1/2$  |  $-3$   |      $12$      |


|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $1/2$  |   $0$   |  $1/2$  |   $0$   |  $-1$   | $-1/2$  |   $0$   |     $-30$      |
| $x_7$ |  $5/8$  |   $0$   |  $3/8^*$ |   $0$   |  $1/4$  |  $1/8$  |   $1$   |     $7/2$      |
| $x_2$ |  $5/8$  |   $1$   |  $3/8$  |   $0$   |  $1/4$  |  $1/8$  |   $0$   |     $15/2$     |
| $x_4$ |  $3/8$  |   $0$   |  $5/8$  |   $1$   |  $3/4$  | $-1/8$  |   $0$   |     $45/2$     |


|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $x_7$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $-1/3$  |   $0$   |   $0$   |   $0$   | $-4/3$  | $-2/3$  | $-4/3$  |    $-104/3$    |
| $x_3$ |  $5/3$  |   $0$   |   $1$   |   $0$   |  $2/3$  |  $1/3$  |  $8/3$  |     $28/3$     |
| $x_2$ |   $0$   |   $1$   |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |      $4$       |
| $x_4$ | $-2/3$  |   $0$   |   $0$   |   $1$   |  $1/3$  | $-1/3$  | $-5/3$  |     $50/3$     |

因此该线性规划问题的最优解为
$$
x_1=0,\qquad x_2=4,\qquad x_3=\frac{28}{3},\qquad x_4=\frac{50}{3},\qquad x_5=0,\qquad x_6=0,\qquad x_7=0
$$
最优值为$z=-104/3$​。进而原线性规划问题的最优解为
$$
x_1=0,\qquad x_2=4,\qquad x_3=\frac{28}{3},\qquad x_4=\frac{50}{3}
$$
最优值为$z=104/3$。

### 第二问

$$
\begin{align}
& \text{min}  \quad z=2x_1+4x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1-3x_2\ge 2\\
-x_1+x_2\ge 3\\
x_1,x_2\ge 0
\end{cases}
\end{align}
$$

解：化为标准型
$$
\begin{align}
& \text{min}  \quad z=2x_1+4x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1-3x_2-x_3=2\\
-x_1+x_2-x_4= 3\\
x_1,x_2,x_3,x_4\ge 0
\end{cases}
\end{align}
$$
引入人工变量$x_5,x_6$，考虑辅助问题。
$$
\begin{align}
& \text{min}  \quad g=x_5+x_6\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1-3x_2-x_3+x_5=2\\
-x_1+x_2-x_4+x_6= 3\\
x_1,x_2,x_3,x_4,x_5,x_6\ge 0
\end{cases}
\end{align}
$$
第一阶段：初始表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $-2$   |  $-4$   |   $0$   |   $0$   |   $0$   |   $0$   |      $0$       |
|  $g$  |   $0$   |   $0$   |   $0$   |   $0$   |  $-1$   |  $-1$   |      $0$       |
| $x_5$ |   $2$   |  $-3$   |  $-1$   |   $0$   |   $1$   |   $0$   |      $2$       |
| $x_6$ |  $-1$   |   $1$   |   $0$   |  $-4$   |   $0$   |   $1$   |      $3$       |


单纯形表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $-2$   |  $-4$   |   $0$   |   $0$   |   $0$   |   $0$   |      $0$       |
|  $g$  |   $1$   |  $-2$   |  $-1$   |  $-4$   |   $0$   |   $0$   |      $5$       |
| $x_5$ |  $2^*$  |  $-3$   |  $-1$   |   $0$   |   $1$   |   $0$   |      $2$       |
| $x_6$ |  $-1$   |   $1$   |   $0$   |  $-4$   |   $0$   |   $1$   |      $3$       |


|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $0$   |  $-7$   |  $-1$   |   $0$   |   $1$   |   $0$   |      $2$       |
|  $g$  |   $0$   | $-1/2$  | $-1/2$  |  $-4$   | $-1/2$  |   $0$   |      $4$       |
| $x_1$ |   $1$   | $-3/2$  | $-1/2$  |   $0$   |  $1/2$  |   $0$   |      $1$       |
| $x_6$ |   $0$   | $-1/2$  | $-1/2$  |  $-4$   |  $1/2$  |   $1$   |      $4$       |

因此辅助问题的最优解为
$$
x_1=1,\quad 
x_2=0,\quad 
x_3=0,\quad 
x_4=0,\quad 
x_5=0,\quad 
x_6=4
$$
最优值为$g=4>0$​，从而原线性规划问题无可行解。

# 第四周

## 第一题

写出下面线性规划的对偶规划：
$$
\begin{align}
& \text{min}  \quad x_1+2x_2+4x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2+4x_3\ge 2\\
2x_1+x_2+6x_3=3\\
x_1+3x_2+5x_3\le 5\\
x_1,x_2\ge 0
\end{cases}
\end{align}
$$

解：化为一般形式
$$
\begin{align}
& \text{min}  \quad x_1+2x_2+4x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2+4x_3\ge 2\\
2x_1+x_2+6x_3=3\\
-x_1-3x_2-5x_3\ge -5\\
x_1\ge 0\\
x_2\ge 0\\
x_3\text{为自由变量}
\end{cases}
\end{align}
$$
对偶规划为
$$
\begin{align}
& \text{max}  \quad 2w_1+3w_2-5w_3\\
& \text{s.t.} \;\, \quad \begin{cases}
w_1\ge 0\\
w_2\text{为自由变量}\\
w_3\ge 0\\
2w_1+2w_2-w_3\le 1\\
3w_1+w_2-3w_3\le 2\\
4w_1+6w_2-5w_3=4
\end{cases}
\end{align}
$$
化为一般形式
$$
\begin{align}
& \text{max}  \quad 2w_1+3w_2-5w_3\\
& \text{s.t.} \;\, \quad \begin{cases}
2w_1+2w_2-w_3\le 1\\
3w_1+w_2-3w_3\le 2\\
4w_1+6w_2-5w_3=4\\
w_1\ge 0\\
w_2\text{为自由变量}\\
w_3\ge 0
\end{cases}
\end{align}
$$

## 第二题

把线性规划问题
$$
\begin{align}
& \text{min}  \quad x_1+x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2\le 5\\
\frac{1}{2}x_2+x_3=3\\
x_1,x_2,x_3\ge 0
\end{cases}
\end{align}
$$
记为$P$。

### 第一问

用单纯形算法解$P$​。

解：化为标准形
$$
\begin{align}
& \text{min}  \quad x_1+x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2+x_4= 5\\
\frac{1}{2}x_2+x_3=3\\
x_1,x_2,x_3,x_4\ge 0
\end{cases}
\end{align}
$$
初始表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $-1$   |   $0$   |  $-1$   |   $0$   |      $0$       |
| $x_4$ |   $1$   |   $2$   |   $0$   |   $1$   |      $5$       |
| $x_3$ |   $0$   |  $1/2$  |   $1$   |   $0$   |      $3$       |

单纯形表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $-1$   |  $1/2$  |   $0$   |   $0$   |      $3$       |
| $x_4$ |   $1$   |  $2^*$  |   $0$   |   $1$   |      $5$       |
| $x_3$ |   $0$   |  $1/2$  |   $1$   |   $0$   |      $3$       |


|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $-5/4$  |   $0$   |   $0$   | $-1/4$  |     $7/4$      |
| $x_2$ |  $1/2$  |   $1$   |   $0$   |  $1/2$  |     $5/2$      |
| $x_3$ | $-1/4$  |   $0$   |   $1$   | $-1/4$  |     $7/4$      |


因此该线性规划问题的最优解为
$$
x_1=0,\qquad 
x_2=\frac{5}{2},\qquad 
x_3=\frac{7}{4},\qquad 
x_4=0
$$
最优值为$z=7/4$。

### 第二问

写出$P$的对偶$D$​。

解：化$P$为一般形式
$$
\begin{align}
& \text{min}  \quad x_1+x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
-x_1-2x_2\ge -5\\
\frac{1}{2}x_2+x_3=3\\
x_1,x_2,x_3\ge 0
\end{cases}
\end{align}
$$
$P$的对偶$D$​为
$$
\begin{align}
& \text{max}  \quad -5w_1+3w_2\\
& \text{s.t.} \;\, \quad \begin{cases}
w_1\ge 0\\
w_2\text{为自由变量}\\
-w_1\le 1\\
-2w_1+\frac{1}{2}w_2\le 0\\
w_3\le 1
\end{cases}
\end{align}
$$
化为一般形式
$$
\begin{align}
& \text{max}  \quad -5w_1+3w_2\\
& \text{s.t.} \;\, \quad \begin{cases}
-w_1\le 1\\
-2w_1+\frac{1}{2}w_2\le 0\\
w_2\le 1\\
w_1\ge 0\\
w_2\text{为自由变量}
\end{cases}
\end{align}
$$

### 第三问

写出$P$的互补松紧条件，并利用它们解对偶$D$​。

解：由方程
$$
(\boldsymbol{A}^T\boldsymbol{w}-\boldsymbol{c})\cdot \boldsymbol{x}=\boldsymbol{0}
$$
即
$$
\begin{cases}
\frac{5}{2}\left(-2w_1+\frac{1}{2}w_2\right)=0\\
\frac{7}{4}(w_2-1)=0
\end{cases}
$$
解得
$$
w_1=\frac{1}{4},\qquad w_2=1
$$
最优值为$7/4$。

## 第三题

用对偶单纯形法求解下列问题：
$$
\begin{align}
& \text{min}  \quad 2x_1+3x_2+4x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2+x_3\ge 3\\
2x_1-x_2+3x_3\ge 4\\
x_1,x_2,x_3\ge 0
\end{cases}
\end{align}
$$
解：化为标准形
$$
\begin{align}
& \text{min}  \quad 2x_1+3x_2+4x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2+x_3-x_4= 3\\
2x_1-x_2+3x_3-x_5=4\\
x_1,x_2,x_3,x_4,x_5\ge 0
\end{cases}
\end{align}
$$
初始表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $-2$   |  $-3$   |  $-4$   |   $0$   |   $0$   |      $0$       |
| $x_4$ |   $1$   |   $2$   |   $1$   |  $-1$   |   $0$   |      $3$       |
| $x_5$ |   $2$   |  $-1$   |   $3$   |   $0$   |  $-1$   |      $4$       |


单纯形表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $-2$   |  $-3$   |  $-4$   |   $0$   |   $0$   |      $0$       |
| $x_4$ |  $-1$   |  $-2$   |  $-1$   |   $1$   |   $0$   |      $-3$      |
| $x_5$ | $-2^*$  |   $1$   |  $-3$   |   $0$   |   $1$   |      $-4$      |

|       | $x_1$ | $x_2$  | $x_3$ | $x_4$ | $x_5$ | $\text{RHS}$ |
| :---: | :---: | :----: | :---: | :---: | :---: | :----------: |
|  $z$  |   $0$   |   $-4$   |  $-1$   |   $0$   |  $-1$   |      $4$       |
| $x_4$ |   $0$   | $-5/2^*$ |  $1/2$  |   $1$   | $-1/2$  |      $-1$      |
| $x_1$ |   $1$   |  $-1/2$  |  $3/2$  |   $0$   | $-1/2$  |      $2$       |

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $0$   |   $0$   | $-9/5$  | $-8/5$  | $-1/5$  |     $28/5$     |
| $x_2$ |   $0$   |   $1$   | $-1/5$  | $-2/5$  |  $1/5$  |     $2/5$      |
| $x_1$ |   $1$   |   $0$   |  $7/5$  | $-1/5$  | $-2/5$  |     $11/5$     |


因此该线性规划问题的最优解为
$$
x_1=\frac{11}{5},\qquad 
x_2=\frac{2}{5},\qquad 
x_3=0,\qquad 
x_4=0,\qquad 
x_5=0
$$
最优值为$28/5$​。

# 第五周

## 第一题

考虑线性规划问题$P$
$$
\begin{align}
& \text{min}  \quad x_1+x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2\le 5\\
\frac{1}{2}x_2+x_3=3\\
x_1,x_2,x_3\ge 0
\end{cases}
\end{align}
$$
在下述每一种情况下，试利用解问题$P$所得到的最优单纯性表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $-5/4$  |   $0$   |   $0$   | $-1/4$  |     $7/4$      |
| $x_2$ |  $1/2$  |   $1$   |   $0$   |  $1/2$  |     $5/2$      |
| $x_3$ | $-1/4$  |   $0$   |   $1$   | $-1/4$  |     $7/4$      |

继续求解。

### 第一问

$$
\begin{align}
& \text{min}  \quad -\frac{5}{4}x_1+x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2\le 5\\
\frac{1}{2}x_2+x_3=3\\
x_1,x_2,x_3\ge 0
\end{cases}
\end{align}
$$

解：
$$
\zeta_1'=\zeta_1+(c_1-c_1')=-\frac{5}{4}+\left(1-\left(-\frac{5}{4}\right)\right)
=1
$$
从而得到新的单纯形表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $1$  |   $0$   |   $0$   | $-1/4$  |     $7/4$      |
| $x_2$ |  $1/2^*$  |   $1$   |   $0$   |  $1/2$  |     $5/2$      |
| $x_3$ | $-1/4$  |   $0$   |   $1$   | $-1/4$  |     $7/4$      |

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $0$  |   $-2$   |   $0$   | $-5/4$ |     $-13/4$     |
| $x_1$ |  $1$  |   $2$   |   $0$   |  $1$  |     $5$     |
| $x_3$ | $0$ |   $1/2$   |   $1$   | $0$ |     $3$     |


因此最优解为
$$
x_1=5,\qquad 
x_2=0,\qquad 
x_3=3,\qquad 
x_4=0
$$
最优值为$-13/4$。

### 第二问

$$
\begin{align}
& \text{min}  \quad -\frac{5}{4}x_1+2x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2\le 5\\
\frac{1}{2}x_2+x_3=3\\
x_1,x_2,x_3\ge 0
\end{cases}
\end{align}
$$

解：由第一问

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $0$  |   $-2$   |   $0$   | $-5/4$ |     $-13/4$     |
| $x_1$ |  $1$  |   $2$   |   $0$   |  $1$  |     $5$     |
| $x_3$ | $0$ |   $1/2$   |   $1$   | $0$ |     $3$     |


将基变量$x_3$所在的行$\times (c_3'-c_3)=1$加至第$0$行，再令$\zeta'_3=0$，得到单纯形表

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $0$ |   $-3/2$   |   $0$   | $-5/4$ |     $-1/4$     |
| $x_1$ |  $1$  |   $2$   |   $0$   |  $1$  |     $5$     |
| $x_3$ | $0$ |   $1/2$   |   $1$   | $0$ |     $3$     |

因此最优解为
$$
x_1=5,\qquad 
x_2=0,\qquad 
x_3=3,\qquad 
x_4=0
$$
最优值为$-1/4$。

### 第三问

$$
\begin{align}
& \text{min}  \quad x_1+x_3\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2\le -2\\
\frac{1}{2}x_2+x_3=1\\
x_1,x_2,x_3\ge 0
\end{cases}
\end{align}
$$

解：最优解对应的基矩阵为
$$
\boldsymbol{B}=\begin{pmatrix}
2 & 0\\
1/2 & 1
\end{pmatrix}
$$
从而
$$
\begin{align}
& \overline{\boldsymbol{b}}'=\boldsymbol{B}^{-1}\boldsymbol{b}'=\begin{pmatrix}
2 & 0\\
1/2 & 1
\end{pmatrix}^{-1}\begin{pmatrix}
-2\\1
\end{pmatrix}
=\begin{pmatrix}
1/2 & 0 \\
-1/4 & 1
\end{pmatrix}\begin{pmatrix}
-2\\1
\end{pmatrix}
=\begin{pmatrix}
-1\\3/2
\end{pmatrix}\\
& z_0'=\boldsymbol{c}_B^T\overline{\boldsymbol{b}}'
=\begin{pmatrix}
0 & 1
\end{pmatrix}
\begin{pmatrix}
-1\\3/2
\end{pmatrix}=\frac{3}{2}
\end{align}
$$

从而得到单纯形表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  | $-5/4$  |   $0$   |   $0$   | $-1/4$  |     $3/2$     |
| $x_2$ |  $1/2$  |   $1$   |   $0$   |  $1/2$  |     $-1$     |
| $x_3$ | $-1/4$  |   $0$   |   $1$   | $-1/4$  |     $3/2$     |

进而问题没有解。

## 第二题

给定ILP问题如下：
$$
\begin{align}
& \text{min}  \quad z=x_1-5x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2\le 8\\
x_1-x_2\ge 4\\
x_1,x_2\ge 0\\
x_1,x_2\text{为整数}
\end{cases}
\end{align}
$$

### 第一问

用图解法求出该ILP问题的所有可行解及最优解与最优值。

解：图解法如下

![5.2.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\5.2.1.svg)

由图解法，可行解为
$$
\small{
(x_1,x_2,z)=
(4,0,4),\quad 
(5,0,5),\quad
(6,0,6),\quad
(7,0,7),\quad
(8,0,8),\quad
(5,1,0),\quad
(6,1,1),\quad
}
$$
因此最优解为
$$
x_1=5,\qquad 
x_2=1,\qquad 
z=0
$$

### 第二问

用割平面算法求解。

解：增加松弛变量
$$
\begin{align}
& \text{min}  \quad z=x_1-5x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+2x_2+x_3=8\\
x_1-x_2-x_4=4\\
x_1,x_2,x_3,x_4\ge 0\\
x_1,x_2,x_3,x_4\text{为整数}
\end{cases}
\end{align}
$$
初始表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |  $-1$   |   $5$   |   $0$   |   $0$   |      $0$       |
| $x_3$ |   $1$   |   $2$   |   $1$   |   $0$   |      $8$       |
| $x_1$ |   $1$   |  $-1$   |   $0$   |  $-1$   |      $4$       |


单纯形表为

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $0$   |   $4$   |   $0$   |  $-1$   |      $4$       |
| $x_3$ |   $0$   |  $3^*$  |   $1$   |   $1$   |      $4$       |
| $x_1$ |   $1$   |  $-1$   |   $0$   |  $-1$   |      $4$       |

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :----------: |
|  $z$  |   $0$   |   $0$   | $-4/3$  | $-7/3$  |     $-4/3$     |
| $x_2$ |   $0$   |   $1$   |  $1/3$  |  $1/3$  |     $4/3$      |
| $x_1$ |   $1$   |   $0$   |  $1/3$  | $-2/3$  |     $16/3$     |


第$1$行与第$2$行均产生割平面
$$
\frac{1}{3}x_3+\frac{1}{3}x_4\ge \frac{1}{3}
$$
将
$$
-\frac{1}{3}x_3-\frac{1}{3}x_4+s=-\frac{1}{3}
$$
加至单纯形表，并使用对偶单纯形算法

|       | $x_1$ | $x_2$ | $x_3$  | $x_4$ | $s$ | $\text{RHS}$ |
| :---: | :---: | :---: | :----: | :---: | :---: | :----------: |
|  $z$  |   $0$   |   $0$   |  $-4/3$  | $-7/3$  |   $0$   |     $-4/3$     |
| $x_2$ |   $0$   |   $1$   |  $1/3$   |  $1/3$  |   $0$   |     $4/3$      |
| $x_1$ |   $1$   |   $0$   |  $1/3$   | $-2/3$  |   $0$   |     $16/3$     |
| $s$ |   $0$   |   $0$   | $-1/3^*$ | $-1/3$  |   $1$   |     $-1/3$     |

|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $s$  | $\text{RHS}$ |
| :---: | :---: | :---: | :---: | :---: | :--: | :----------: |
|  $z$  |   $0$   |   $0$   |   $0$   |  $-1$   |  $-4$  |      $0$       |
| $x_2$ |   $0$   |   $1$   |   $0$   |   $0$   |  $1$   |      $1$       |
| $x_1$ |   $1$   |   $0$   |   $0$   |  $-1$   |  $1$   |      $5$       |
|  $x_3$  |   $0$   |   $0$   |   $1$   |   $1$   |  $-3$  |      $1$       |


因此最优解为
$$
x_1=5,\qquad 
x_2=1,\qquad 
x_3=1,\qquad
x_4=0,\qquad 
s=0
$$

最优值为$z=0$。

## 第三题

用分枝定界法解下述ILP问题：
$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1,x_2\ge 0\\
x_1,x_2\text{为整数}
\end{cases}\tag{$P$}
\end{align}
$$

解：由图解法，LP问题
$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1,x_2\ge 0
\end{cases}\tag{$P_0$}
\end{align}
$$
的最优解为
$$
x_1=\frac{13}{4},\qquad 
x_2=\frac{5}{2},\qquad 
z=\frac{59}{4}
$$
作分支
$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1\le 3\\
x_1,x_2\ge 0
\end{cases}\tag{$P_1$}
\end{align}
$$

$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1\ge 4\\
x_1,x_2\ge 0
\end{cases}\tag{$P_2$}
\end{align}
$$

$P_1$的最优解为
$$
x_1=3,\qquad 
x_2=\frac{8}{3},\qquad 
z=\frac{43}{3}
$$

$P_2$的最优解为
$$
x_1=4,\qquad 
x_2=1,\qquad 
z=14
$$

对于$P_1$​作分支
$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1\le 3\\
x_2\le 2\\
x_1,x_2\ge 0
\end{cases}\tag{$P_{11}$}
\end{align}
$$

$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1\le 3\\
x_2\ge 3\\
x_1,x_2\ge 0
\end{cases}\tag{$P_{12}$}
\end{align}
$$

$P_{11}$的最优解为
$$
x_1=3,\qquad 
x_2=2,\qquad 
z=13
$$

$P_{12}$的最优解为
$$
x_1=\frac{5}{2},\qquad 
x_2=3,\qquad 
z=\frac{27}{2}=13.5
$$

由于$P_2$的最优解为整数解，且比$P_{11}$与$P_{12}$​的最优值大，那么原ILP问题的最优解为
$$
x_1=4,\qquad 
x_2=1
$$
最优值为$z=14$。


## 第四题

用分枝定界法求解下面的混合整数线性规划问题：
$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1,x_2\ge 0\\
x_1\text{为整数}
\end{cases}
\end{align}
$$
解：由图解法，LP问题
$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1,x_2\ge 0
\end{cases}\tag{$P_0$}
\end{align}
$$
的最优解为
$$
x_1=\frac{13}{4},\qquad 
x_2=\frac{5}{2},\qquad 
z=\frac{59}{4}
$$
作分支
$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1\le 3\\
x_1,x_2\ge 0
\end{cases}\tag{$P_1$}
\end{align}
$$

$$
\begin{align}
& \text{max}  \quad z=3x_1+2x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
2x_1+3x_2\le 14\\
2x_1+x_2\le 9\\
x_1\ge 4\\
x_1,x_2\ge 0
\end{cases}\tag{$P_2$}
\end{align}
$$

$P_1$的最优解为
$$
x_1=3,\qquad 
x_2=\frac{8}{3},\qquad 
z=\frac{43}{3}
$$

$P_2$的最优解为
$$
x_1=4,\qquad 
x_2=1,\qquad 
z=14
$$

由于$P_1$的最优解满足原ILP问题，且比$P_{2}$​的最优值大，那么原ILP问题的最优解为
$$
x_1=3,\qquad 
x_2=\frac{8}{3}
$$
最优值为$z=43/3$。

# 第六周

## 第一题

试在同一平面坐标系中画出下列(MP)的可行域及目标函数的等值线，并在图中标出其局部最优解或整体最优解。

### 第一问

$$
\text{min}\qquad
\frac{1}{4}x_1^2+x_2^2-\frac{1}{2}x_1-4x_2+\frac{15}{4}
$$

解：可行域为全空间$\R^2$​，目标函数等值线如下

![6.1.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\6.1.1.svg)

整体最优解为$z=-1/2$。事实上
$$
\frac{1}{4}x_1^2+x_2^2-\frac{1}{2}x_1-4x_2+\frac{15}{4}

=\frac{1}{4}(x_1-1)
+(x_2-2)^2-\frac{1}{2}
\ge -\frac{1}{2}
$$
当且仅当$(x_1,x_2)=(1,2)$时等号成立。

### 第二问

$$
\begin{align}
& \text{min}  \quad x_1^2-x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1^2+x_2^2\le 4\\
x_1\le 0\\
x_2\ge \frac{1}{2}
\end{cases}
\end{align}
$$

解：可行域与目标函数等值线如下

![6.1.2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\6.1.2.svg)

整体最优解为
$$
x_1=0,\qquad x_2=2
$$
整体最优值为$z=-2$。

## 第二题

判别以下函数哪些是凸的，哪些是凹的，哪些是非凸非凹的。

### 第一问

$$
f(x_1,x_2)=60-10x_1-4x_2+x_1^2+x_2^2-x_1x_2
$$

解：由于
$$
f(x_1,x_2)=\frac{1}{2}\begin{pmatrix}
x_1 & x_2
\end{pmatrix}
\begin{pmatrix}
2 & -1\\
-1 & 2
\end{pmatrix}
\begin{pmatrix}
x_1\\x_2
\end{pmatrix}
+\begin{pmatrix}
-10&-4
\end{pmatrix}
\begin{pmatrix}
x_1\\x_2
\end{pmatrix}+60
$$
那么其Hessian矩阵为
$$
\nabla^2f(x_1,x_2)=\begin{pmatrix}
2 & -1\\
-1 & 2
\end{pmatrix}
$$
其顺序主子式为
$$
\begin{vmatrix}
2
\end{vmatrix}=2,\qquad 
\begin{vmatrix}
2 & -1\\
-1 & 2
\end{vmatrix}=3
$$
从而$\nabla^2f(x_1,x_2)$为正定矩阵，进而$f(x_1,x_2)$为$\R^2$上的严格凸函数。

### 第二问

$$
f(x_1,x_2)=-x_1^2-5x_2^2+2x_1x_2+10x_1-10x_2
$$

解：记$g(x_1,x_2)=-f(x_1,x_2)$，那么
$$
g(x_1,x_2)=\frac{1}{2}\begin{pmatrix}
x_1 & x_2
\end{pmatrix}
\begin{pmatrix}
2 & -2\\
-2 & 10
\end{pmatrix}
\begin{pmatrix}
x_1\\x_2
\end{pmatrix}
+\begin{pmatrix}
-10&10
\end{pmatrix}
\begin{pmatrix}
x_1\\x_2
\end{pmatrix}
$$
那么其Hessian矩阵为
$$
\nabla^2g(x_1,x_2)=\begin{pmatrix}
2 & -2\\
-2 & 10
\end{pmatrix}
$$
其顺序主子式为
$$
\begin{vmatrix}
2
\end{vmatrix}=2,\qquad 
\begin{vmatrix}
2 & -2\\
-2 & 10
\end{vmatrix}=16
$$
从而$\nabla^2g(x_1,x_2)$为正定矩阵，进而$g(x_1,x_2)$为$\R^2$上的严格凸函数，因此$f(x_1,x_2)$为$\R^2$上的严格凹函数。

### 第三问

$$
f(x_1,x_2,x_3)=x_1^2+3x_2^2+9x_3^2-2x_1x_2+6x_2x_3+2x_1x_3
$$

解：由于
$$
f(x_1,x_2,x_3)=\frac{1}{2}\begin{pmatrix}
x_1 & x_2 & x_3
\end{pmatrix}
\begin{pmatrix}
2 & -2 & 2\\
-2 & 6 & 6\\
2 & 6 & 18
\end{pmatrix}
\begin{pmatrix}
x_1\\x_2\\x_3
\end{pmatrix}
$$
那么其Hessian矩阵为
$$
\nabla^2f(x_1,x_2,x_3)=\begin{pmatrix}
2 & -2 & 2\\
-2 & 6 & 6\\
2 & 6 & 18
\end{pmatrix}
$$
其主子式为
$$
\begin{align}
& \begin{vmatrix}
2
\end{vmatrix}=2,\qquad
\begin{vmatrix}
6
\end{vmatrix}=6,\qquad
\begin{vmatrix}
18
\end{vmatrix}=18\\
& \begin{vmatrix}
2 & -2\\
-2 & 6
\end{vmatrix}=8,\qquad
\begin{vmatrix}
2 & 2\\
2 & 18
\end{vmatrix}=32,\qquad
\begin{vmatrix}
6 & 6\\
6 & 18
\end{vmatrix}=72\\
& \begin{vmatrix}
2 & -2 & 2\\
-2 & 6 & 6\\
2 & 6 & 18
\end{vmatrix}=0
\end{align}
$$
从而$\nabla^2f(x_1,x_2,x_3)$为半正定矩阵，进而$f(x_1,x_2,x_3)$为$\R^3$上的凸函数。

## 第三题

证明下列规划为凸规划：
$$
\begin{align}
& \text{min}  \quad f(x_1,x_2)=x_1^3+2x_1x_2+2x_2^2\\
& \text{s.t.} \;\quad x_1\ge 1
\end{align}
$$
问：该问题是否存在最优解？

证明：记可行域为$X=[1,\infty)\times\R$，目标函数为$f(x_1,x_2)=x_1^3+2x_1x_2+2x_2^2$，其Hessian矩阵为
$$
\nabla^2f(x_1,x_2)=\begin{pmatrix}
6x_1 & 2\\
2 & 4
\end{pmatrix}
$$
其顺序主子式为
$$
\begin{vmatrix}
6x_1
\end{vmatrix}=6x_1\ge 6>0,\qquad 
\begin{vmatrix}
6x_1 & 2\\
2 & 4
\end{vmatrix}=24x_1-4\ge 24-4>0
$$
从而$f(x_1,x_2)$是$X$上的严格凸函数。而可行域$X$显然为凸集，从而该规划为凸规划。

下面证明该问题存在最优解。事实上，注意到
$$
f(x_1,x_2)=x_1^3+2x_1x_2+2x_2^2
=2(x_2+\frac{1}{2}x_1)^2+x_1^3-\frac{1}{2}x_1^2
$$
容易知道$x_1^3-\frac{1}{2}x_1^2\ge \frac{1}{2}$，当且仅当$x_1=1$时等号成立，因此
$$
f(x_1,x_2)\ge \frac{1}{2}
$$
当且仅当$(x_1,x_2)=(1,-1/2)$时等号成立。进而规划问题的最优解为
$$
x_1=1,\qquad x_2=-\frac{1}{2}
$$
最优值为$1$​。

# 第七周

## 第一题

用K-T条件求解
$$
\begin{align}
& \text{min}  \quad f(x_1,x_2)=x_1^3+2x_1x_2+2x_2^2\\
& \text{s.t.} \;\quad x_1\ge 1
\end{align}
$$

解：首先求解K-T点。化为约束非线性规划问题
$$
\begin{align}
& \text{min}  \quad f(x_1,x_2)=x_1^3+2x_1x_2+2x_2^2\\
& \text{s.t.} \;\quad 1-x_1\le 0
\end{align}
$$
作Lagrange函数
$$
L(x_1,x_2,\lambda)=x_1^3+2x_1x_2+2x_2^2+\lambda(1-x_1)
$$
求解K-T条件
$$
\begin{cases}
\frac{\part L}{\part x_1}=3x_1^2+2x_2-\lambda=0\\
\frac{\part L}{\part x_2}=2x_1+4x_2=0\\
\lambda(1-x_1)=0
\end{cases}
$$
解得
$$
(x_1,x_2,\lambda)=
\left(0,0,0\right),
\left(\frac{1}{3},-\frac{1}{6},0\right),
\left(1,-\frac{1}{2},2\right)
$$
而
$$
(x_1,x_2,\lambda)=
\left(0,0,0\right),
\left(\frac{1}{3},-\frac{1}{6},0\right)
$$
不满足
$$
\begin{cases}
1-x_1\le 0\\
\lambda\ge 0
\end{cases}
$$
因此约束非线性规划问题K-T点为
$$
(x_1,x_2)=(1,-1/2)
$$
下面验证该约束非线性规划问题为凸规划。记可行域为$X=[1,\infty)\times\R$，目标函数为$f(x_1,x_2)=x_1^3+2x_1x_2+2x_2^2$，其Hessian矩阵为
$$
\nabla^2f(x_1,x_2)=\begin{pmatrix}
6x_1 & 2\\
2 & 4
\end{pmatrix}
$$
其顺序主子式为
$$
\begin{vmatrix}
6x_1
\end{vmatrix}=6x_1\ge 6>0,\qquad 
\begin{vmatrix}
6x_1 & 2\\
2 & 4
\end{vmatrix}=24x_1-4\ge 24-4>0
$$
从而$f(x_1,x_2)$是$X$上的严格凸函数。而$g(x_1,x_2)=1-x_1$显然为凸函数，可行域$X$显然为凸集，从而该规划为凸规划。

综合两方面，$(x_1,x_2)=(1,-1/2)$为整体最优解，最优值为$f(1,-1/2)=1$。

## 第二题

用K-T条件求下列问题的最优解及相应的Lagrange乘子。
$$
\begin{align}
& \text{min}  \quad f(x_1,x_2)=-x_1x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+4x_2\le 4\\
4x_1+x_2\le 4
\end{cases}
\end{align}
$$

解：首先求解K-T点。化为约束非线性规划问题
$$
\begin{align}
& \text{min}  \quad f(x_1,x_2)=-x_1x_2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1+4x_2-4\le 0\\
4x_1+x_2-4\le 0
\end{cases}
\end{align}
$$
作Lagrange函数
$$
L(x_1,x_2,\lambda_1,\lambda_2)=
-x_1x_2+\lambda_1(x_1+4x_2-4)
+\lambda_2(4x_1+x_2-4)
$$
求解K-T条件
$$
\begin{cases}
\frac{\part L}{\part x_1}=-x_2+\lambda_1+4\lambda_2=0\\
\frac{\part L}{\part x_2}=-x_1+4\lambda_1+\lambda_2=0\\
\lambda_1(x_1+4x_2-4)=0\\
\lambda_2(4x_1+x_2-4)=0
\end{cases}
$$
解得


$$
\begin{pmatrix}
x_1 \\ x_2 \\ \lambda_1 \\ \lambda_2
\end{pmatrix}
=
\begin{pmatrix}
0\\0\\0\\0
\end{pmatrix}
,
\begin{pmatrix}
\frac{1}{2}\\2\\0\\\frac{1}{2}
\end{pmatrix}
,
\begin{pmatrix}
2\\\frac{1}{2}\\\frac{1}{2}\\0
\end{pmatrix}
,
\begin{pmatrix}
\frac{4}{5}\\\frac{4}{5}\\\frac{4}{25}\\\frac{4}{25}
\end{pmatrix}
$$
而
$$
\begin{pmatrix}
x_1 \\ x_2 \\ \lambda_1 \\ \lambda_2
\end{pmatrix}
=
\begin{pmatrix}
\frac{1}{2}\\2\\0\\\frac{1}{2}
\end{pmatrix}
,
\begin{pmatrix}
2\\\frac{1}{2}\\\frac{1}{2}\\0
\end{pmatrix}
$$
不满足
$$
\begin{cases}
x_1+4x_2-4\le 0\\
4x_1+x_2-4\le 0\\
\lambda_1\ge 0\\
\lambda_2\ge 0
\end{cases}
$$
因此约束非线性规划问题K-T点为
$$
(x_1,x_2)=
\left(0,0\right),
\left(\frac{4}{5},\frac{4}{5}\right)
$$
由于目标函数$f(x_1,x_2)=-x_1x_2$的Hessian矩阵
$$
\nabla^2f(x_1,x_2)=\begin{pmatrix}
0 & -1\\
-1 & 0
\end{pmatrix}
$$
不为半正定矩阵，因此该规划问题不为凸规划。

我们仅检验两个K-T点对应的函数值。
$$
f(0,0)=0,\qquad 
f(4/5,4/5)=-\frac{16}{25}
$$
事实上，该规划问题无界，因为取可行点
$$
x_1=-x,\qquad 
x_2=-x,\qquad 
x\ge-\frac{4}{5}
$$
从而
$$
f(x,x)=-x^2\to-\infty\qquad (x\to +\infty)
$$

## 第三题

写出下列问题的K-T条件，并求出它们的K-T点。

### 第一问

$$
\begin{align}
& \text{min}  \quad (x_1-3)^2+(x_2-2)^2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1^2+x_2^2-5\le 0\\
x_1+2x_2-4=0\\
x_1\ge 0\\
x_2\ge 0
\end{cases}
\end{align}
$$

解：化为约束非线性规划问题
$$
\begin{align}
& \text{min}  \quad f(x_1,x_2)=(x_1-3)^2+(x_2-2)^2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1^2+x_2^2-5\le 0\\
-x_1\le 0\\
-x_2\le 0\\
x_1+2x_2-4=0
\end{cases}
\end{align}
$$
作Lagrange函数
$$
\begin{align}
L(x_1,x_2,\lambda_1,\lambda_2,\lambda_3,\mu)
=& (x_1-3)^2+(x_2-2)^2\\
&+\lambda_1(x_1^2+x_2^2-5)
+\lambda_2(-x_1)
+\lambda_3(-x_2)\\
&+\mu(x_1+2x_2-4)
\end{align}
$$
求解K-T条件
$$
\begin{cases}
\frac{\part L}{\part x_1}=2(x_1-3)+2\lambda_1x_1-\lambda_2+\mu=0\\
\frac{\part L}{\part x_2}=2(x_2-2)+2\lambda_1x_2-\lambda_3+2\mu=0\\
\lambda_1(x_1^2+x_2^2-5)=0\\
\lambda_2(-x_1)=0\\
\lambda_3(-x_2)=0\\
x_1+2x_2-4=0
\end{cases}
$$
解得
$$
\begin{pmatrix}
x_1 \\ x_2 \\ \lambda_1 \\ \lambda_2 \\ \lambda_3 \\ \mu
\end{pmatrix}
=
\begin{pmatrix}
-\frac{2}{5} \\ \frac{11}{5} \\ -\frac{7}{3} \\ 0 \\ 0 \\ \frac{74}{15}
\end{pmatrix}
,
\begin{pmatrix}
2 \\ 1 \\ \frac{1}{3} \\ 0 \\ 0 \\ \frac{2}{3}
\end{pmatrix}
,
\begin{pmatrix}
0 \\ 2 \\ 0 \\ -6 \\ 0 \\ 0
\end{pmatrix}
,
\begin{pmatrix}
\frac{12}{5} \\ \frac{4}{5} \\ 0 \\ 0 \\ 0 \\ \frac{6}{5}
\end{pmatrix}
,
\begin{pmatrix}
4 \\ 0 \\ 0 \\ 0 \\ -8 \\ -2
\end{pmatrix}
$$
而
$$
\begin{pmatrix}
x_1 \\ x_2 \\ \lambda_1 \\ \lambda_2 \\ \lambda_3 \\ \mu
\end{pmatrix}
=
\begin{pmatrix}
-\frac{2}{5} \\ \frac{11}{5} \\ -\frac{7}{3} \\ 0 \\ 0 \\ \frac{74}{15}
\end{pmatrix}
,
\begin{pmatrix}
0 \\ 2 \\ 0 \\ -6 \\ 0 \\ 0
\end{pmatrix}
,
\begin{pmatrix}
\frac{12}{5} \\ \frac{4}{5} \\ 0 \\ 0 \\ 0 \\ \frac{6}{5}
\end{pmatrix}
,
\begin{pmatrix}
4 \\ 0 \\ 0 \\ 0 \\ -8 \\ -2
\end{pmatrix}
$$
不满足
$$
\begin{cases}
x_1^2+x_2^2-5\le 0\\
-x_1\le 0\\
-x_2\le 0\\
\lambda_1\ge 0\\
\lambda_2\ge 0\\
\lambda_3\ge 0
\end{cases}
$$
因此约束非线性规划问题K-T点为
$$
(x_1,x_2)=(2,1)
$$

### 第二问

$$
\begin{align}
& \text{min}  \quad -(x_1+1)^2-(x_2+1)^2\\
& \text{s.t.} \;\, \quad \begin{cases}
x_1^2+x_2^2-2\le 0\\
x_2-1\le 0
\end{cases}
\end{align}
$$

解：作Lagrange函数
$$
L(x_1,x_2,\lambda_1,\lambda_2)=
-(x_1+1)^2-(x_2+1)^2+\lambda_1(x_1^2+x_2^2-2)
+\lambda_2(x_2-1)
$$
求解K-T条件
$$
\begin{cases}
\frac{\part L}{\part x_1}=-2(x_1+1)+2\lambda_1x_1=0\\
\frac{\part L}{\part x_2}=-2(x_2+1)+2\lambda_1x_2+\lambda_2=0\\
\lambda_1(x_1^2+x_2^2-2)=0\\
\lambda_2(x_2-1)=0
\end{cases}
$$
解得
$$
\begin{pmatrix}
x_1 \\ x_2 \\ \lambda_1 \\ \lambda_2
\end{pmatrix}
=
\begin{pmatrix}
-1 \\ -1 \\ 0 \\ 0
\end{pmatrix}
,
\begin{pmatrix}
1 \\ 1 \\ 2 \\ 0
\end{pmatrix}
,
\begin{pmatrix}
-1 \\ 1 \\ 0 \\ 4
\end{pmatrix}
$$
均满足
$$
\begin{cases}
x_1^2+x_2^2-2\le 0\\
x_2-1\le 0\\
\lambda_1\ge 0\\
\lambda_2\ge 0
\end{cases}
$$
因此约束非线性规划问题的K-T点为
$$
(x_1,x_2)=(-1,-1),(1,1),(-1,1)
$$

## 第四题

求以下无约束非线性规划问题的最优解。

### 第一问

$$
\min f(x_1,x_2)=2x_1^2+x_2^2+(x_1+x_2)^2-20x_1-16x_2
$$

解：由于
$$
f(x_1,x_2)=\frac{1}{2}\begin{pmatrix}
x_1 & x_2
\end{pmatrix}
\begin{pmatrix}
6 & 2\\
2 & 4
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
+\begin{pmatrix}
-20 & -16
\end{pmatrix}
\begin{pmatrix}
x_1 \\ x_2
\end{pmatrix}
$$
因此$f(x_1,x_2)$​的Hessian矩阵为
$$
\nabla^2f(x_1,x_2)=\begin{pmatrix}
6 & 2\\
2 & 4
\end{pmatrix}
$$
其顺序主子式为
$$
6>0,\qquad 
\begin{vmatrix}
6 & 2\\
2 & 4
\end{vmatrix}=20>0
$$
因此$\nabla^2f(x_1,x_2)$为正定矩阵，进而$f(x_1,x_2)$为严格凸函数。令
$$
\nabla f(x_1,x_2)=
\begin{pmatrix}
6x_1+2x_2-20\\2x_1+4x_2-16
\end{pmatrix}
=
\begin{pmatrix}
0\\0
\end{pmatrix}
$$
解得
$$
(x_1,x_2)=\left(\frac{12}{5},\frac{14}{5}\right)
$$
此为最优解，最优值为
$$
f(12/5,14/5)=-\frac{232}{5}
$$

### 第二问

$$
\min f(x_1,x_2)=x_1^2+x_2^2-12x_1^4
$$

解：$f(x_1,x_2)$​的Hessian矩阵为
$$
\nabla^2f(x_1,x_2)=\begin{pmatrix}
2-144x_1^2 & 0\\
0 & 2
\end{pmatrix}
$$
令
$$
\nabla f(x_1,x_2)=
\begin{pmatrix}
2x_1-48x_1^3\\
2x_2
\end{pmatrix}
=
\begin{pmatrix}
0\\0
\end{pmatrix}
$$
解得
$$
(x_1,x_2)=\left(0,0\right),
\left(\frac{\sqrt{6}}{12},0\right),
\left(-\frac{\sqrt{6}}{12},0\right)
$$
由于
$$
\nabla^2f(0,0)=\begin{pmatrix}
2 & 0\\
0 & 2
\end{pmatrix}
$$
为正定矩阵，因此$(x_1,x_2)=(0,0)$为严格局部最优解，严格局部最优值为
$$
f(0,0)=0
$$
而若令$x_2=0$，则有
$$
f(x_1,0)=x_1^2-12x_1^4
$$
容易知道$|x_1|=\sqrt{6}/12$​为整体最大值点，因此
$$
(x_1,x_2)=
\left(\frac{\sqrt{6}}{12},0\right),
\left(-\frac{\sqrt{6}}{12},0\right)
$$
不为局部最优解，进而原规划问题的局部最优解仅为
$$
(x_1,x_2)=\left(0,0\right)
$$
而原规划问题显然无界。

# 第八周

## 第一题

用罚函数法求解问题
$$
\begin{align}
& \text{min}\quad (x-1)^2\\
& \text{s.t.}\quad\;\, 2-x\le 0
\end{align}
$$

### 第一问

写出$c_k=0,1,10$时相应的增广目标函数，并画出它们对应的图形。

解：构造罚函数
$$
p_c(x)=c(\max\{ 2-x,0 \})^2=\begin{cases}
c(x-2)^2,\quad & x< 2\\
0,\quad & x\ge 2
\end{cases}
$$
构造增广目标函数
$$
F_c(x)=f(x)+p_c(x)=\begin{cases}
(x-1)^2+c(x-2)^2,\quad & x< 2\\
(x-1)^2,\quad & x\ge 2
\end{cases}
$$
图像如下

![8.1.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\8.1.1.svg)

### 第二问

取$c_k=k-1$​，求出近似最优解的迭代点列。

解：增广目标函数为
$$
\begin{align}
F_{c_k}(x)
& =\begin{cases}
(x-1)^2+(k-1)(x-2)^2,\quad & x< 2\\
(x-1)^2,\quad & x\ge 2
\end{cases}\\
& =\begin{cases}
k\left(x-\left(2-\frac{1}{k}\right)\right)^2+\left(1-\frac{1}{k}\right),\quad & x< 2\\
(x-1)^2,\quad & x\ge 2
\end{cases}
\end{align}
$$
因此
$$
\text{min }F_{c_k}(x)
=\min\{ F_{c_k}(2-1/k),F_{c_k}(2) \}
=\min\{ 1-1/k,1 \}
=1-\frac{1}{k}
$$
进而$x^k=2-1/k$为增广目标函数的最小值点，近似最优解的迭代点列为$\{ 2-1/k \}_{k=1}^{\infty}$。

### 第三问

利用第二问求问题的最优解。

解：由近似最优解的迭代点列$\{ 2-1/k \}_{k=1}^{\infty}$，极限为$x^*=2$。由于
$$
f(x)=(x-1)^2,\qquad 
f'(x)=2(x-1),\qquad 
f''(x)=2>0
$$
因此$f(x)$为凸函数；而$g(x)=2-x$为线性函数，进而规划问题为凸规划，因此$x^*=2$为最优解。

## 第二题

用对数形式的障碍函数法求解问题。
$$
\begin{align}
& \text{min}  \quad x_1+2x_2\\
& \text{s.t.} \; \quad \begin{cases}
x_1^2-x_2\le 0\\
x_1\ge 0
\end{cases}
\end{align}
$$
解：化为标准形式
$$
\begin{align}
& \text{min}  \quad x_1+2x_2\\
& \text{s.t.} \; \quad \begin{cases}
x_1^2-x_2\le 0\\
-x_1\le 0
\end{cases}
\end{align}
$$
构造障碍函数
$$
B_{d_k}(x_1,x_2)=-d_k(\ln(x_2-x_1^2)+\ln x_1)
$$
构造增广目标函数
$$
F_{d_k}(x_1,x_2)
=f(x_1,x_2)+B_{d_k}(x_1,x_2)
=x_1+2x_2-d_k(\ln(x_2-x_1^2)+\ln x_1)
$$
由于
$$
\frac{\partial F_{d_k}}{\partial x_1}(x_1,x_2)
=1-d_k\left(\frac{-2x_1}{x_2-x_1^2}+\frac{1}{x_1}\right),\qquad 
\frac{\partial F_{d_k}}{\partial x_2}(x_1,x_2)
=2-\frac{d_k}{x_2-x_1^2}
$$
令
$$
\frac{\partial F_{d_k}}{\partial x_1}(x_1,x_2)
=0,\qquad 
\frac{\partial F_{d_k}}{\partial x_2}(x_1,x_2)
=0
$$
解得
$$
(x_1,x_2)=\left(\frac{-1+\sqrt{1+16d_k}}{8},\frac{24d_k+1-\sqrt{1+16d_k}}{32}\right)\\
(x_1,x_2)=\left(\frac{-1-\sqrt{1+16d_k}}{8},\frac{24d_k+1+\sqrt{1+16d_k}}{32}\right)
$$
由于当
$$
(x_1,x_2)=\left(\frac{-1-\sqrt{1+16d_k}}{8},\frac{24d_k+1+\sqrt{1+16d_k}}{32}\right)
$$
并不在可行域中，且当$d_k\to 0$时，$(x_1,x_2)\to(-1/4,1/16)$​也不在可行域中，因此仅考虑
$$
(x_1,x_2)=\left(\frac{-1+\sqrt{1+16d_k}}{8},\frac{24d_k+1-\sqrt{1+16d_k}}{32}\right)
\label{可行解1}
$$
考察增广目标函数的Hessian矩阵
$$
\nabla^2 F_{d_k}(x_1,x_2)=\begin{pmatrix}
d_k\left(\frac{1}{x_1^2}+\frac{4x_1^2}{(x_2-x_1^2)^2}+\frac{2}{x_2-x_1^2}\right) & -\frac{2d_kx_1}{(x_2-x_1^2)^2}\\
-\frac{2d_kx_1}{(x_2-x_1^2)^2} & \frac{d_k}{(x_2-x_1^2)^2}
\end{pmatrix}
$$
代入($\ref{可行解1}$)，可得
$$
\nabla F_{d_k}=\begin{pmatrix}
12+\frac{1}{d_k} & \frac{1-\sqrt{1+16d_k}}{d_k}\\
\frac{1-\sqrt{1+16d_k}}{d_k} & \frac{4}{d_k}
\end{pmatrix}
$$
由于当$d_k> 0$时
$$
12+\frac{1}{d_k}>0,\qquad
\begin{vmatrix}
12+\frac{1}{d_k} & \frac{1-\sqrt{1+16d_k}}{d_k}\\
\frac{1-\sqrt{1+16d_k}}{d_k} & \frac{4}{d_k}
\end{vmatrix}=\frac{32\sqrt{1+16 d_k}}{d_k\left(\sqrt{1+16 d_k}-1\right)}>0
$$
因此($\ref{可行解1}$)为$F_{d_k}(x_1,x_2)$的局部最小值点。令$d_k\to 0^+$，$(x_1,x_2)\to (0,0)$​。

由于
$$
f(x_1,x_2)=x_1+2x_2,\qquad 
g_2(x_1,x_2)=-x_1
$$
为线性函数，因此为凸函数。而对于$g_1(x_1,x_2)=x_1^2-x_2$，其Hessian矩阵
$$
\nabla^2 g_2(x_1,x_2)=\begin{pmatrix}
2 & 0 \\ 0 & 0
\end{pmatrix}
$$
显然为半正定矩阵，因此$g_1(x_1,x_2)$为凸函数，进而该规划问题为凸规划，因而$(0,0)$​为最优解。

# 第九周

## 第一题

在如下图中，求$A$点到$E$​点的最短路线和最短路程。

![9.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\9.1.svg)

解：记$f(P)$为点$P$到目标点$E$的最短路径长度，$x(P)$为点$P$在最短路径中的下一点，$d(P,Q)$为点$P$到点$Q$​的距离。我们从目标点往前向出发点递推。

还有$1$步到达目标点：
$$
\begin{align}
& f(D_1)=d(D_1,E)=3,\qquad x(D_1)=E\\
& f(D_2)=d(D_2,E)=1,\qquad x(D_2)=E\\
& f(D_3)=d(D_3,E)=5,\qquad x(D_3)=E
\end{align}
$$

还有$2$​步到达目标点：
$$
\begin{align}
& f(C_1)\\
= & \min\{ d(C_1,D_1)+f(D_1),d(C_1,D_2)+f(D_2),d(C_1,D_3)+f(D_3) \}\\
= & \min\{ 2+3,5+1,1+5 \}\\
= & \min\{5,6,6\}\\
= & 5\\
&x(C_1)=D_1
\end{align}
$$

$$
\begin{align}
& f(C_2)\\
= & \min\{ d(C_2,D_1)+f(D_1),d(C_2,D_2)+f(D_2),d(C_2,D_3)+f(D_3) \}\\
= & \min\{ 1+3,4+1,2+5 \}\\
= & \min\{4,5,7\}\\
= & 4\\
&x(C_2)=D_1
\end{align}
$$

还有$3$步到达目标点：
$$
\begin{align}
& f(B_1)\\
= & \min\{ d(B_1,C_1)+f(C_1),d(B_1,C_2)+f(C_2)\}\\
= & \min\{ 4+5,3+4 \}\\
= & \min\{9,7\}\\
= & 7\\
&x(B_1)=C_2
\end{align}
$$

$$
\begin{align}
& f(B_2)\\
= & \min\{ d(B_2,C_1)+f(C_1),d(B_2,C_2)+f(C_2)\}\\
= & \min\{ 1+5,3+4 \}\\
= & \min\{6,7\}\\
= & 6\\
&x(B_2)=C_1
\end{align}
$$

$$
\begin{align}
& f(B_3)\\
= & \min\{ d(B_3,C_1)+f(C_1),d(B_3,C_2)+f(C_2)\}\\
= & \min\{ 3+5,5+4 \}\\
= & \min\{8,9\}\\
= & 8\\
&x(B_3)=C_1
\end{align}
$$

还有$4$步到达目标点：

$$
\begin{align}
& f(A)\\
= & \min\{ d(A,B_1)+f(B_1),d(A,B_2)+f(B_2),d(A,B_3)+f(B_3)\}\\
= & \min\{ 3+7,2+6,1+8 \}\\
= & \min\{10,8,9\}\\
= & 8\\
&x(A)=B_2
\end{align}
$$

所以最短路径为
$$
A\to B_2\to C_1\to D_1\to E,\qquad\text{min}=8
$$

## 第二题

给出下列距离矩阵，解旅行售货员问题。
$$
\begin{pmatrix}
0 & 10 & 8 & 18\\
10 & 0 & 7 & 11\\
8 & 7 & 0 & 6\\
18 & 11 & 6 & 0
\end{pmatrix}
$$

解：记$f(v_i,V)$​为从点$v_i$​，经过集合$V$​中的点各一次，最后回到初始点$v_1$​的最短路径长度，$x(v_i)$​为点$v_i$​在最短路径中的下一点，$d(v_i,v_j)$​为点$v_i$​到点$v_j$​的距离。我们从目标点往前向出发点递推。

经过$0$个点，回到$v_1$：
$$
\begin{align}
& f(v_2,\varnothing)=d(v_2,v_1)=10\\
& f(v_3,\varnothing)=d(v_3,v_1)=8\\
& f(v_4,\varnothing)=d(v_4,v_1)=18
\end{align}
$$

经过$1$个点，回到$v_1$：
$$
\begin{align}
& f(v_2,\{ v_3 \})=d(v_2,v_3)+f(v_3,\varnothing)=7+8=15\\
& f(v_2,\{ v_4 \})=d(v_2,v_4)+f(v_4,\varnothing)=11+18=29\\
& f(v_3,\{ v_2 \})=d(v_3,v_2)+f(v_2,\varnothing)=7+10=17\\
& f(v_3,\{ v_4 \})=d(v_3,v_4)+f(v_4,\varnothing)=6+18=24\\
& f(v_4,\{ v_2 \})=d(v_4,v_2)+f(v_2,\varnothing)=11+10=21\\
& f(v_4,\{ v_3 \})=d(v_4,v_3)+f(v_3,\varnothing)=6+8=14
\end{align}
$$

经过$2$个点，回到$v_1$​：
$$
\begin{align}
& f(v_2,\{ v_3,v_4 \})\\
=&\min\{ d(v_2,v_3)+f(v_3,\{ v_4 \}),d(v_2,v_4)+f(v_4,\{ v_3 \}) \}\\
=&\min\{ 7+24,11+14 \}\\
=&\{ 31,25 \}\\
=&25\\
&x(v_2)=v_4
\end{align}
$$

$$
\begin{align}
& f(v_3,\{ v_2,v_4 \})\\
=& \min\{ d(v_3,v_2)+f(v_2,\{ v_4 \}),d(v_3,v_4)+f(v_4,\{ v_2 \}) \}\\
=&\min\{ 7+29,6+21 \}\\
=&\min\{36,27\}\\
=&27\\
&x(v_3)=v_4
\end{align}
$$

$$
\begin{align}
&f(v_4,\{ v_2,v_3 \})\\
=&\min\{ d(v_4,v_2)+f(v_2,\{ v_3 \}),d(v_4,v_3)+f(v_3,\{ v_2 \}) \}\\
=&\min\{ 11+15,6+17 \}\\
=&\min\{26,23\}\\
=&23\\
&x(v_4)=v_3
\end{align}
$$

经过$3$个点，回到$v_1$：
$$
\begin{align}
& f(v_1,\{ v_2,v_3,v_4 \})\\
=&\min\{ d(v_1,v_2)+f(v_2,\{ v_3,v_4 \}),d(v_1,v_3)+f(v_3,\{ v_2,v_4 \}),d(v_1,v_4)+f(v_4,\{ v_2,v_3 \}) \}\\
=&\min\{10+25,8+27,18+23 \}\\
=&\min\{ 35,35,41 \}\\
=&35\\
& x(v_1)=v_2\text{ 或 }v_3
\end{align}
$$

所以最短路径为
$$
\begin{align}
& v_1\to v_2\to v_4\to v_3\to v_1,\qquad \text{min} = 35\\
\text{或 }&v_1\to v_3\to v_4\to v_2\to v_1,\qquad \text{min} = 35
\end{align}
$$

## 第三题

某单位有资源$100$单位，拟分$4$个周期使用，在每个周期有生产任务$A$和$B$，把资源用于$A$生产任务，每单位能获利$10$元，资源回收率为$2/3$；把资源用于$B$生产任务，每单位能获利$7$元，资源回收率为$9/10$​。问每个周期应如何分配资源，使总收益最大？

解：记$A$生产任务的获利函数为$g(x)=10x$，$B$生产任务的获利函数为$h(x)=7x$，以及$a=2/3$，$b=9/10$。

以$f_1(x)$表示投入$x$单位的生产资源在$1$个周期内生产的最大总收益函数，那么
$$
f_1(x)
=\max_{0\le y \le x}\{ g(y)+h(x-y) \}
=\max_{0\le y \le x}\{ 7x+3y \}
=10x,\qquad y=x
$$

以$f_2(x)$表示投入$x$单位的生产资源在$2$个周期内生产的最大总收益函数，那么
$$
\small{
f_{2}(x)
=\max_{0\le y \le x}\{ g(y)+h(x-y)+f_{1}(ay+b(x-y)) \}
=\max_{0\le y \le x}\left\{16x+\frac{2}{3}y\right\}
=\frac{50}{3}x,\qquad y=x
}
$$

以$f_3(x)$表示投入$x$单位的生产资源在$3$个周期内生产的最大总收益函数，那么
$$
\small{
f_{3}(x)
=\max_{0\le y \le x}\{ g(y)+h(x-y)+f_{2}(ay+b(x-y)) \}
=\max_{0\le y \le x}\left\{22 x-\frac{8 y}{9}\right\}
=22x,\qquad y=0
}
$$

以$f_4(x)$表示投入$x$单位的生产资源在$4$个周期内生产的最大总收益函数，那么
$$
\small{
f_{3}(x)
=\max_{0\le y \le x}\{ g(y)+h(x-y)+f_{2}(ay+b(x-y)) \}
=\max_{0\le y \le x}\left\{\frac{134}{5}x-\frac{32}{15}y\right\}
=\frac{134}{5}x,\quad y=0
}
$$
因此投入$100$单位的生产资源在$4$个周期内生产的最大总收益为
$$
f_4(100)=2680
$$
每个阶段的生产计划如下

|          | 投入$A$生产任务 | 投入$B$生产任务 | 本周期收益 |
| :------: | :-------------: | :-------------: | :--------: |
| 第一周期 |       $0$       |      $100$      |   $700$    |
| 第二周期 |       $0$       |      $90$       |   $630$    |
| 第三周期 |      $81$       |       $0$       |   $810$    |
| 第四周期 |      $54$       |       $0$       |   $540$    |
|  总收益  |                 |                 |   $2680$   |

# 第十一周

## 第一题

设有五个城市$1,2,3,4,5$相互的距离如下图所示，试用函数空间迭代法和策略空间迭代法求各城市到城市$5$的最短路线及最短路程，其中初始策略为
$$
s_0(1)=2,\qquad
s_0(2)=3,\qquad
s_0(3)=4,\qquad
s_0(4)=5,\qquad
s_0(5)=5
$$

![10.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\10.1.svg)

解：距离矩阵为
$$
\boldsymbol{D}=\begin{pmatrix}
0 & 3 & 4 & \infty & \infty \\
\infty & 0 & 5 & 2 & 4 \\
\infty & \infty & 0 & 3 & \infty \\
\infty & \infty & \infty & 0 & 1 \\
\infty & \infty & \infty & \infty & 0 \\
\end{pmatrix}
$$

（函数空间迭代法）记$f_1(i)$为由城市$i$出发至多经过$1$个城市到达城市$5$的最短路程，那么
$$
\small{
f_1(1)=d_{15}=\infty,\quad 
f_1(2)=d_{25}=4,\quad
f_1(3)=d_{35}=\infty,\quad
f_1(4)=d_{45}=1,\quad
f_1(5)=d_{55}=0
}
$$

记$f_2(i)$为由城市$i$出发至多经过$2$个城市到达城市$5$的最短路程，那么
$$
\begin{align}
& f_2(1)
=\min_{1\le j \le 5}\{ d_{1j}+f_1(j) \}
=\min\{ 0+\infty, 3+4, 4+\infty, \infty+1, \infty+0 \}
=7\\
& f_2(2)
=\min_{1\le j \le 5}\{ d_{2j}+f_1(j) \}
=\min\{ \infty+\infty, 0+4, 5+\infty, 2+1, 4+0 \}
=3\\
& f_2(3)=\min_{1\le j \le 5}\{ d_{3j}+f_1(j) \}
=\min\{ \infty+\infty, \infty+4, 0+\infty, 3+1, \infty+0 \}
=4\\
& f_2(4)=\min_{1\le j \le 5}\{ d_{4j}+f_1(j) \}
=\min\{ \infty+\infty, \infty+4, \infty+\infty, 0+1, 1+0 \}
=1\\
& f_2(5)=0
\end{align}
$$

记$f_3(i)$为由城市$i$出发至多经过$3$个城市到达城市$5$的最短路程，那么
$$
\begin{align}
& f_3(1)
=\min_{1\le j \le 5}\{ d_{1j}+f_2(j) \}
=\min\{ 0+7, 3+3, 4+4, \infty+1, \infty+0 \}
=6\\
& f_3(2)
=\min_{1\le j \le 5}\{ d_{2j}+f_2(j) \}
=\min\{ \infty+7, 0+3, 5+4, 2+1, 4+0 \}
=3\\
& f_3(3)
=\min_{1\le j \le 5}\{ d_{3j}+f_2(j) \}
=\min\{ \infty+7, \infty+3, 0+4, 3+1, \infty+0 \}
=4\\
& f_3(4)
=\min_{1\le j \le 5}\{ d_{4j}+f_2(j) \}
=\min\{ \infty+7, \infty+3, \infty+4, 0+1, 1+0 \}
=1\\
& f_3(5)=0
\end{align}
$$

记$f_4(i)$为由城市$i$出发至多经过$4$个城市到达城市$5$的最短路程，那么
$$
\small{
\begin{align}
& f_4(1)
=\min_{1\le j \le 5}\{ d_{1j}+f_3(j) \}
=\min\{ 0+6, 3+3, 4+4, \infty+1, \infty+0 \}
=6,&&
s(1)=2\\
& f_4(2)
=\min_{1\le j \le 5}\{ d_{2j}+f_3(j) \}
=\min\{ \infty+6, 0+3, 5+4, 2+1, 4+0 \}
=3,&&
s(2)=4\\
& f_4(3)
=\min_{1\le j \le 5}\{ d_{3j}+f_3(j) \}
=\min\{ \infty+6, \infty+3, 0+4, 3+1, \infty+0 \}
=4,&&s(3)=4\\
& f_4(4)
=\min_{1\le j \le 5}\{ d_{4j}+f_3(j) \}
=\min\{ \infty+6, \infty+3, \infty+4, 0+1, 1+0 \}
=1,&&
s(4)=5\\
& f_4(5)=0
\end{align}
}
$$

因此各城市到城市$5$的最短路线及最短路程为

| 城市 |      最短路线      | 最短路程 |
| :--: | :----------------: | :------: |
| $1$  | $1\to 2\to 4\to 5$ |   $6$    |
| $2$  |   $2\to 4 \to 5$   |   $3$    |
| $3$  |   $3\to 4\to 5$    |   $4$    |
| $4$  |      $4\to 5$      |   $1$    |

（策略空间迭代法）由于初始策略为
$$
s_0(1)=2,\qquad
s_0(2)=3,\qquad
s_0(3)=4,\qquad
s_0(4)=5,\qquad
s_0(5)=5
$$
作方程组
$$
\begin{cases}
f_0(1)=d_{1,s_0(1)}+f_0(s_0(1))\\
f_0(2)=d_{2,s_0(2)}+f_0(s_0(2))\\
f_0(3)=d_{3,s_0(3)}+f_0(s_0(3))\\
f_0(4)=d_{4,s_0(4)}+f_0(s_0(4))\\
f_0(5)=0
\end{cases}
\iff
\begin{cases}
f_0(1)=3+f_0(2)\\
f_0(2)=5+f_0(3)\\
f_0(3)=3+f_0(4)\\
f_0(4)=1+f_0(5)\\
f_0(5)=0
\end{cases}
\iff
\begin{cases}
f_0(1)=12\\
f_0(2)=9\\
f_0(3)=4\\
f_0(4)=1\\
f_0(5)=0
\end{cases}
$$
求解
$$
\begin{align}
& \min_{1\le  j \le 5}\{ d_{1j}+f_0(j) \}
=\min\{ 0+12, 3+9, 4+4, \infty+1, \infty+0 \}
=8,&&
s_1(1)=3\\
& \min_{1\le  j \le 5}\{ d_{2j}+f_0(j) \}
=\min\{ \infty+12, 0+9, 5+4, 2+1, 4+0 \}
=3,&&
s_1(2)=4\\
& \min_{1\le  j \le 5}\{ d_{3j}+f_0(j) \}
=\min\{ \infty+12, \infty+9, 0+4, 3+1, \infty+0 \}
=4,&&
s_1(3)=4\\
& \min_{1\le  j \le 5}\{ d_{4j}+f_0(j) \}
=\min\{ \infty+12, \infty+9, \infty+4, 0+1, 1+0 \}
=1,&&
s_1(4)=5
\end{align}
$$
由此得到策略
$$
s_1(1)=3,\qquad
s_1(2)=4,\qquad
s_1(3)=4,\qquad
s_1(4)=5,\qquad
s_1(5)=5
$$

作方程组
$$
\begin{cases}
f_1(1)=d_{1,s_1(1)}+f_1(s_1(1))\\
f_1(2)=d_{2,s_1(2)}+f_1(s_1(2))\\
f_1(3)=d_{3,s_1(3)}+f_1(s_1(3))\\
f_1(4)=d_{4,s_1(4)}+f_1(s_1(4))\\
f_1(5)=0
\end{cases}
\iff
\begin{cases}
f_1(1)=4+f_1(3)\\
f_1(2)=2+f_1(4)\\
f_1(3)=3+f_1(4)\\
f_1(4)=1+f_1(5)\\
f_1(5)=0
\end{cases}
\iff
\begin{cases}
f_1(1)=8\\
f_1(2)=3\\
f_1(3)=4\\
f_1(4)=1\\
f_1(5)=0
\end{cases}
$$
求解
$$
\begin{align}
& \min_{1\le  j \le 5}\{ d_{1j}+f_1(j) \}
=\min\{ 0+8, 3+3, 4+4, \infty+1, \infty+0 \}
=6,&&
s_2(1)=2\\
& \min_{1\le  j \le 5}\{ d_{2j}+f_1(j) \}
=\min\{ \infty+8, 0+3, 5+4, 2+1, 4+0 \}
=3,&&
s_2(2)=4\\
& \min_{1\le  j \le 5}\{ d_{3j}+f_1(j) \}
=\min\{ \infty+8, \infty+3, 0+4, 3+1, \infty+0 \}
=4,&&
s_2(3)=4\\
& \min_{1\le  j \le 5}\{ d_{4j}+f_1(j) \}
=\min\{ \infty+8, \infty+3, \infty+4, 0+1, 1+0 \}
=1,&&
s_2(4)=5
\end{align}
$$
由此得到策略
$$
s_2(1)=2,\qquad
s_2(2)=4,\qquad
s_2(3)=4,\qquad
s_2(4)=5,\qquad
s_2(5)=5
$$

作方程组
$$
\begin{cases}
f_2(1)=d_{1,s_2(1)}+f_1(s_2(1))\\
f_2(2)=d_{2,s_2(2)}+f_1(s_2(2))\\
f_2(3)=d_{3,s_2(3)}+f_1(s_2(3))\\
f_2(4)=d_{4,s_2(4)}+f_1(s_2(4))\\
f_2(5)=0
\end{cases}
\iff
\begin{cases}
f_2(1)=3+f_1(2)\\
f_2(2)=2+f_1(4)\\
f_2(3)=3+f_1(4)\\
f_2(4)=1+f_1(5)\\
f_2(5)=0
\end{cases}
\iff
\begin{cases}
f_2(1)=6\\
f_2(2)=3\\
f_2(3)=4\\
f_2(4)=1\\
f_2(5)=0
\end{cases}
$$
求解
$$
\begin{align}
& \min_{1\le  j \le 5}\{ d_{1j}+f_2(j) \}
=\min\{ 0+6, 3+3, 4+4, \infty+1, \infty+0 \}
=6,&&
s_3(1)=2\\
& \min_{1\le  j \le 5}\{ d_{2j}+f_2(j) \}
=\min\{ \infty+6, 0+3, 5+4, 2+1, 4+0 \}
=3,&&
s_3(2)=4\\
& \min_{1\le  j \le 5}\{ d_{3j}+f_2(j) \}
=\min\{ \infty+6, \infty+3, 0+4, 3+1, \infty+0 \}
=4,&&
s_3(3)=4\\
& \min_{1\le  j \le 5}\{ d_{4j}+f_2(j) \}
=\min\{ \infty+6, \infty+3, \infty+4, 0+1, 1+0 \}
=1,&&
s_3(4)=5
\end{align}
$$
由此得到策略
$$
s_3(1)=2,\qquad
s_3(2)=4,\qquad
s_3(3)=4,\qquad
s_3(4)=5,\qquad
s_3(5)=5
$$

因此各城市到城市$5$的最短路线及最短路程为

| 城市 |      最短路线      | 最短路程 |
| :--: | :----------------: | :------: |
| $1$  | $1\to 2\to 4\to 5$ |   $6$    |
| $2$  |   $2\to 4 \to 5$   |   $3$    |
| $3$  |   $3\to 4\to 5$    |   $4$    |
| $4$  |      $4\to 5$      |   $1$    |


## 第二题

证明：图中次为奇数的点数为偶数。

证明：对于图$G=(N,E)$，若次为奇数的点数为奇数，那么$\displaystyle \sum_{n\in N}\deg(n)$为奇数。但是
$$
\sum_{n\in N}\deg(n)=2|E|
$$
为偶数，因此矛盾！进而次为奇数的点数为偶数。

# 第十二周

## 第一题

分别用Kruskal算法、Dijkstra算法求解下图所示网络的最小树。

![12.1.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.1.1.svg)

解：（Kruskal算法）边依权排列如下

|   边   | $e_{12}$ | $e_{45}$ | $e_{14}$ | $e_{25}$ | $e_{35}$ | $e_{23}$ | $e_{13}$ | $e_{34}$ |
| :----: | :------: | :------: | :------: | :------: | :------: | :------: | :------: | :------: |
| **权** |   $1$    |   $2$    |   $3$    |   $4$    |   $5$    |   $6$    |   $7$    |   $8$    |

在不产生圈的前提下依次加边，直至得到最小树。

选取$e_{12}$，构成如下图

![12.1.2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.1.2.svg)

选取$e_{45}$，构成如下图

![12.1.3](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.1.3.svg)

选取$e_{14}$，构成如下图

![12.1.4](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.1.4.svg)

若选取$e_{25}$，则构成回路$1\to 2\to 5\to 4\to 1$。选取$e_{35}$，构成如下图

![12.1.5](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.1.5.svg)

此时已构成树，因此为最小树。

（Dijkstra算法）选取点$1$为起始点，作割集

![12.2.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.2.1.svg)

选取边$e_{12}$，作割集

![12.2.2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.2.2.svg)

选取边$e_{14}$，作割集

![12.2.3](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.2.3.svg)

选取边$e_{45}$，作割集

![12.2.4](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.2.4.svg)

选取边$e_{35}$，构成最小树

![12.2.5](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\12.2.5.svg)

# 第十三周

## 第一题

用Dijkstra算法求解下图所示有向网络中自点$1$到其他各点的最短有向路。

![13.1.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.1.1.svg)

解：作临时标号

![13.1.2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.1.2.svg)

选择点$2$的临时标号为永久标号，并更新其他点的临时标号。

![13.1.3](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.1.3.svg)

选择点$3$​的临时标号为永久标号，并更新其他点的临时标号。

![13.1.4](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.1.4.svg)

选择点$4$​的临时标号为永久标号，并更新其他点的临时标号。

![13.1.5](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.1.5.svg)

选择点$5,8$的临时标号为永久标号，因此自点$1$到其他各点的最短有向路为

![13.1.6](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.1.6.svg)

| 城市 |      最短路线      | 最短路程 |
| :--: | :----------------: | :------: |
| $2$  |      $1\to 2$      |   $1$    |
| $3$  |      $1\to 3$      |   $3$    |
| $4$  |   $1\to 2\to 4$    |   $5$    |
| $5$  |   $1\to 3\to 5$    |   $8$    |
| $6$  | $1\to 2\to 4\to 6$ |   $8$    |

## 第二题

使用Ford-Fulkerson算法求如下图所示的有向网络中从$s$到$t$的最大流。

![13.2.1](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.2.1.svg)

解：作零流

![13.2.2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.2.2.svg)

依次标号

![13.2.3](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.2.3.svg)

更新流量

![13.2.4](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.2.4.svg)

依次标号

![13.2.5](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.2.5.svg)

更新流量

![13.2.6](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.2.6.svg)

依次标号

![13.2.7](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\13.2.7.svg)

此时流量最大，流量如下

|  有向边  | $(s,a)$ | $(s,b)$ | $(a,c)$ | $(b,d)$ | $(c,t)$ | $(d,t)$ | 其他 |
| :------: | :-----: | :-----: | :-----: | :-----: | :-----: | :-----: | :--: |
| **流量** |   $1$   |   $3$   |   $1$   |   $3$   |   $1$   |   $3$   | $0$  |

最大流为$v=4$。

# 第十四周

## 第一题

某单人理发店，顾客到达服从最简单流，平均每小时到达$3$人，理发时间服从负指数分布，平均为$15$​分钟，试求如下问题。

解：由题意可知
$$
\lambda=3\text{人/h},\qquad
\mu=4\text{人/h}
$$
因此服务强度为
$$
\rho=\frac{\lambda}{\mu}=\frac{3}{4}
$$

### 第一问

顾客来理发店不必等待的概率。

解：顾客来理发店不必等待的概率为
$$
p_0=1-\rho=1-\frac{3}{4}=\frac{1}{4}
$$

### 第二问

理发店内顾客平均数。

解：理发店内顾客平均数为
$$
L=\frac{\rho}{1-\rho}
=\frac{\frac{3}{4}}{1-\frac{3}{4}}
=3\text{人}
$$

### 第三问

顾客在理发店内平均停留时间。

解：顾客在理发店内平均停留时间为
$$
W=\frac{1}{\mu-\lambda}
=\frac{1}{4-3}=1\text{h/人}
$$

### 第四问

平均到达率提高到多少时，顾客在店内平均停留时间才超过$1.25$​小时。

解：若要顾客在店内平均停留时间才超过$1.25$​小时，则
$$
W=\frac{1}{\mu-\lambda}=\frac{1}{4-\lambda}>1.25
$$
从而$\lambda>3.2\text{人/小时}$，因此平均到达率提高到$4\text{人/小时}$时，顾客在店内平均停留时间才超过$1.25$小时。

## 第二题

某工程队承担一座桥梁的施工任务，由于施工地区夏季多雨，需停工三个月。在停工期间该工程队可将施工机械搬走或留在原处。如搬走，一种方案是搬到附近仓库里，需花费$2000$元；一种方案是搬到较远的城里，需花费$4000$元。但当发生洪水时第一种方案将遭受$50000$元的损失。如留在原处，一种方案是花$1500$元筑一护堤，防止河水上涨发生高水位的侵袭；若不筑护堤，发生高水位侵袭时将损失$10000$元。如发生洪水时，则不管是否筑护堤，施工机械留在原处都将遭受$60000$元的损失。根据历史资料，该地区夏季高水位发生的概率是$0.25$，洪水发生的概率是$0.02$​。试用决策树法找出最优方案。

解：![14.2](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\14.2.png)

因此选择留在原地且建筑护堤。

# 第十五周

## 第一题

某公司欲购进一种新产品,有三种可供选择的方案，即大批量购进、中批量购进、小批量购进，在各种市场需要下推销该产品的获利情况如下表所示，其中负数表示亏损。

![获利情况](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\获利情况.png)

分别用乐观法、悲观法、乐观系数法（乐观系数$\alpha=0.4$）、后悔值法和等可能法进行决策分析，找出最优方案。

解：状态集为
$$
S=\{ \text{畅销},\text{一般},\text{滞销} \}
$$
决策集为
$$
A=\{ \text{大批量购进},\text{中批量购进},\text{小批量购进} \}
$$
决策表为
![决策表](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\决策表.png)

1. 对于乐观法，乐观法决策表为
   ![乐观法决策表](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\乐观法决策表.png)
   由于
   $$
   \begin{align}
   \Phi:\qquad
   & \max_{a\in A}\{ \max_{x\in S}\{ R(a,x) \} \}\\
   = & \max\{ R(a_1,x_1),R(a_2,x_1),R(a_3,x_1) \}\\
   = & R(a_1,x_1)\\
   = & 600
   \end{align}
   $$
   因此最优方案为大批量购进。
2. 对于悲观法，悲观法决策表为
   ![悲观法决策表](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\悲观法决策表.png)
   由于
   $$
   \begin{align}
   \Phi:\qquad
   & \max_{a\in A}\{ \min_{x\in S}\{ R(a,x) \} \}\\
   = & \max\{ R(a_1,x_3),R(a_2,x_3),R(a_3,x_3) \}\\
   = & R(a_3,x_3)\\
   = & -10
   \end{align}
   $$
   因此最优方案为小批量购进。
3. 对于乐观系数法，乐观系数法决策表为
   ![乐观系数法决策表](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\乐观系数法决策表.png)
   由于
   $$
   \begin{align}
   \Phi:\qquad
   & \max_{a\in A}\{ \alpha\max_{x\in S}\{ R(a,x) \}+(1-\alpha)\min_{x\in S}\{ R(a,x) \} \}\\
   & \max_{a\in A}\{ 0.4\max_{x\in S}\{ R(a,x) \}+0.6\min_{x\in S}\{ R(a,x) \} \}\\
   = & \max\{ 192,148,74 \}\\
   = & 192
   \end{align}
   $$
   因此最优方案为大批量购进。
4. 对于后悔值法，求解后悔值函数为
   $$
   \text{RV}(a,x)=\max_{a\in A}\{ R(a,x) \}-R(a,x)
   $$
   后悔值表为
   ![后悔值表](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\后悔值表.png)
   由于
   $$
   \Phi:\qquad
   \min_{a\in A}\{ \max_{x\in S}\{ \text{RV}(a,x) \} \}
   =100
   $$
   因此最优方案为大批量购进。
5. 对于等可能法，等可能法决策表为
   ![等可能法决策表](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\3.2大三下\运筹学\图\等可能法决策表.png)
   由于
   $$
   \begin{align}
   \Phi:\qquad
   & \max_{a\in A}\left\{ \frac{1}{n}\sum_{k=1}^{n}R(a,x_k) \right\}\\
   & \max_{a\in A}\left\{ \frac{1}{3}\sum_{k=1}^{3}R(a,x_k) \right\}\\
   = & \max\{ 240,680/3,290/3 \}\\
   = & 240
   \end{align}
   $$
   因此最优方案为大批量购进。
