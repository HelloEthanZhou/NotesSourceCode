# 习题5.1

5.某厂生产的电容器的使用寿命服从指数分布，为了了解其平均寿命，从中抽出$n$件产品测其使用寿命，试说明什么是总体，什么是样本，并指出样本的分布。

**解：**总体：该厂生产的全部电容器的使用寿命，或指数分布

样本：抽出的$n$件产品的使用寿命

样本的分布：记样本为$x_1,\cdots,x_n$，那么对于任意$k=1,\cdots,n$，成立$x_k\sim \mathrm{Exp}(\lambda)$，进而样本的分布为
$$
\prod_{k=1}^{n}{\lambda\mathrm{e}^{-\lambda x_k}}=\lambda^n\mathrm{e}^{-\lambda(x_1+\cdots+x_n)}
$$

# 习题5.2

5.$40$​种刊物的月发行量（单位：百册）如下：
$$
\small{\begin{align}
&& 5954,\quad && 5022,\quad && 14667,\quad && 6582,\quad && 6870,\quad && 1840,\quad && 2662,\quad && 4508\\
&& 1208,\quad && 3852,\quad && 618,\quad && 3008,\quad && 1268,\quad && 19787,\quad && 7963,\quad && 2048\\
&& 3077,\quad && 993,\quad && 353,\quad && 14263,\quad && 1714,\quad && 11127,\quad && 6926,\quad && 2047\\
&& 714,\quad && 5923,\quad && 6006,\quad && 14267,\quad && 1697,\quad && 13876,\quad && 4001,\quad && 2280\\
&& 1223,\quad && 12579,\quad && 13588,\quad && 7315,\quad && 4538,\quad && 13304,\quad && 1615,\quad && 8612
\end{align}}
$$

1. 建立该批数据的频数分布表，取组距为$1700$（百册）；
2. 画出直方图。

### 第一问

**解：**画出频数分布表

```R
# 创建原始数据的向量
data <- c(5954, 5022, 14667, 6582, 6870, 1840, 2662, 4508,
          1208, 3852, 618, 3008, 1268, 19787, 7963, 2048,
          3077, 993, 353, 14263, 1714, 11127, 6926, 2047,
          714, 5923, 6006, 14267, 1697, 13876, 4001, 2280,
          1223, 12579, 13588, 7315, 4538, 13304, 1615, 8612)

# 确定组距
bin_width <- 1700

# 生成边界序列
bin_edges <- seq(min(data), max(data)+bin_width, by = bin_width)

# 将数据分到不同的组
grouped_data <- cut(data, breaks = bin_edges, right = FALSE)

# 计算数据频数
freq_table <- table(grouped_data)

# 输出数据频数
freq_table
```

输出结果为

```R
grouped_data
     [353,2.05e+03) [2.05e+03,3.75e+03) 
                 13                   4 
[3.75e+03,5.45e+03) [5.45e+03,7.15e+03) 
                  5                   6 
[7.15e+03,8.85e+03) [8.85e+03,1.06e+04) 
                  3                   0 
[1.06e+04,1.23e+04)  [1.23e+04,1.4e+04) 
                  1                   4 
 [1.4e+04,1.57e+04) [1.57e+04,1.74e+04) 
                  3                   0 
[1.74e+04,1.91e+04) [1.91e+04,2.08e+04) 
                  0                   1 
```

### 第二问

**解：**画出直方图

```R
# 创建原始数据的向量
data <- c(5954, 5022, 14667, 6582, 6870, 1840, 2662, 4508,
          1208, 3852, 618, 3008, 1268, 19787, 7963, 2048,
          3077, 993, 353, 14263, 1714, 11127, 6926, 2047,
          714, 5923, 6006, 14267, 1697, 13876, 4001, 2280,
          1223, 12579, 13588, 7315, 4538, 13304, 1615, 8612)

# 设置分组的数量
bins <- seq(floor(min(data) / 1700) * 1700, ceiling(max(data) / 1700) * 1700, by = 1700)

# 画出直方图
hist(data,
     breaks = bins,
     col = "lightblue",
     main = "频数直方图",
     xlab = "数据值",
     ylab = "频数")
```

输出结果如下

![频数直方图](D:\文件\我的大学\学习\学科\大二下\数理统计\File\画图\频数直方图.jpg)

# 习题5.3

## 第一题

1.在一本书上我们随机的检查了$10$页，发现每页上的错误数为：

4，5，6，0，3，1，4，2，1，4

试计算其样本均值、样本方差和样本标准差。

**解：**由样本均值、样本方差和样本标准差的定义可得
$$
\overline{x}=\frac{1}{10}\sum_{k=1}^{10}{x_k}=3
$$

$$
s^2=\frac{1}{10-1}\sum_{k=1}^{10}{(x_k-\overline{x})^2}=\frac{34}{9}
$$

$$
s=\sqrt{s^2}=\frac{\sqrt{34}}{3}
$$

## 第二题

5.从同一总体中抽取两个容量分别为$n,m$的样本，样本均值分别为$\overline{x}_1,\overline{x}_2$，样本方差分别为$s^2_1,s_2^2$，将两组样本合并，其均值、方差分别为$\overline{x},s^2$，证明：
$$
\overline{x}=\frac{n\overline{x}_1+m\overline{x}_2}{n+m}
$$

$$
s^2=\frac{(n-1)s_1^2+(m-1)s_2^2}{n-m+1}+\frac{nm(\overline{x}_1-\overline{x}_2)^2}{(n+m)(n+m-1)}
$$

**证明：**假设从总体抽取的两个样本分别为
$$
x_1,\cdots,x_n
$$

$$
y_1,\cdots,y_m
$$

因此
$$
\overline{x}_1=\frac{1}{n}\sum_{k=1}^{n}{x_k}
$$

$$
\overline{x}_2=\frac{1}{m}\sum_{k=1}^{n}{y_k}
$$

$$
s_1^2=\frac{1}{n-1}\left( \sum_{k=1}^{n}{x_k^2}-n\overline{x}_1^2 \right)
$$

$$
s_2^2=\frac{1}{m-1}\left( \sum_{k=1}^{m}{y_k^2}-m\overline{x}_2^2 \right)
$$

将两个样本合并为样本
$$
x_1,\cdots,x_n,y_1,\cdots,y_m
$$

那么样本均值为
$$
\begin{align}
\overline{x}&=\frac{1}{n+m}\left(\sum_{k=1}^{n}{x_k}+\sum_{k=1}^{m}{y_k}\right)\\
&=\frac{n\overline{x}_1+m\overline{x}_2}{n+m}
\end{align}
$$

注意到
$$
\sum_{k=1}^{n}{x_k^2}=(n-1)s_1^2+n\overline{x}_1^2
$$

$$
\sum_{k=1}^{m}{y_k^2}=(m-1)s_2^2+m\overline{x}_2^2
$$

因此样本方差为
$$
\begin{align}
s^2=&\frac{1}{n+m-1}\left( \sum_{k=1}^{n}{x_k^2}+\sum_{k=1}^{m}{y_k^2}-(n+m)\overline{x}^2 \right)\\
=&\frac{1}{n+m-1}\left( (n-1)s_1^2+n\overline{x}_1^2+(m-1)s_2^2+m\overline{x}_2^2-(n+m)\overline{x}^2 \right)\\
=&\frac{1}{n+m-1}\left( (n-1)s_1^2+n\overline{x}_1^2+(m-1)s_2^2+m\overline{x}_2^2-(n+m)\left(\frac{n\overline{x}_1+m\overline{x}_2}{n+m}\right)^2 \right)\\
=&\frac{(n-1)s_1^2+(m-1)s_2^2}{n-m+1}+\frac{nm(\overline{x}_1-\overline{x}_2)^2}{(n+m)(n+m-1)}
\end{align}
$$


## 第三题

24.设$X_1,\cdots,X_{16}$是来自$N(8,4)$的样本，试求下列概率

### 第一问

$P\{ X_{(16)}>10 \}$

**解：**记总体的密度函数为
$$
p(x)=\frac{1}{2\sqrt{2\pi}}\mathrm{e}^{-\frac{(x-8)^2}{8}}
$$

分布函数为
$$
F(x)=\frac{1}{2\sqrt{2\pi}}\int_{-\infty}^{x}{\mathrm{e}^{-\frac{(t-8)^2}{8}}\mathrm{d}t}
$$

$X_{(16)}$的密度函数为
$$
p_{16}(x)=16p(x)\left( F(x) \right)^{15}
$$

因此其分布函数为
$$
P_{16}(x)=(F(x))^{16}
$$
进而
$$
\begin{align}
&P\{ X_{(16)}>10 \}\\
=&1-P_{16}(10)\\
=&1-\left( F(10) \right)^{16}\\
=&1-\left( \frac{1}{2\sqrt{2\pi}}\int_{-\infty}^{10}{\mathrm{e}^{-\frac{(x-8)^2}{8}}\mathrm{d}x} \right)^{16}\\
\approx &0.9370
\end{align}
$$

### 第二问

$P\{ X_{(1)}>5 \}$

**解：**记总体的密度函数为
$$
p(x)=\frac{1}{2\sqrt{2\pi}}\mathrm{e}^{-\frac{(x-8)^2}{8}}
$$

分布函数为
$$
F(x)=\frac{1}{2\sqrt{2\pi}}\int_{-\infty}^{x}{\mathrm{e}^{-\frac{(t-8)^2}{8}}\mathrm{d}t}
$$

$X_{(1)}$​的密度函数为
$$
p_1(x)=16p(x)(1-F(x))^{n-1}
$$

因此其分布函数为
$$
P_1(x)=1-(1-F(x))^{16}
$$

$$
\begin{align}
&P\{ X_{(1)}>5 \}\\
=&1-P_{1}(5)\\
=&(1-F(5))^{16}\\
=&\left(1- \frac{1}{2\sqrt{2\pi}}\int_{-\infty}^{5}{\mathrm{e}^{-\frac{(x-8)^2}{8}}\mathrm{d}x} \right)^{16}\\
\approx &0.3308
\end{align}
$$

## 第四题

35.对下列数据构造箱线图。
$$
\begin{align}
472,\quad 425,\quad 447,\quad 377,\quad 341,\quad 369,\quad 412,\quad 419\\

400,\quad 382,\quad 366,\quad 425,\quad 399,\quad 398,\quad 423,\quad 384\\

418,\quad 392,\quad 372,\quad 418,\quad 374,\quad 385,\quad 439,\quad 428\\

429,\quad 428,\quad 430,\quad 413,\quad 405,\quad 381,\quad 403,\quad 479\\

381,\quad 443,\quad 441,\quad 433,\quad 419,\quad 379,\quad 386,\quad 387\\
\end{align}
$$
**解：**运行如下代码：

```R
# 创建数据向量
data <- c(472, 425, 447, 377, 341, 369, 412, 419,
          400, 382, 366, 425, 399, 398, 423, 384,
          418, 392, 372, 418, 374, 385, 439, 428,
          429, 428, 430, 413, 405, 381, 403, 479,
          381, 443, 441, 433, 419, 379, 386, 387)

# 绘制箱线图
boxplot(data, 
        main = "箱线图",
        ylab = "数据值",
        col = "lightblue",
        border = "black")
```

得到如下箱线图：

![箱线图](D:\文件\我的大学\学习\学科\大二下\数理统计\File\画图\箱线图.jpg)

# 习题5.4

## 第一题

2.设$x_1,\cdots,x_n$是来自$N(\mu,16)$的样本，问$n$多大时才能使得
$$
P\left\{ \left| \overline{x}-\mu \right|<1 \right\}\ge 0.95
$$
**解：**样本均值满足分布
$$
\overline{x}\sim N\left(\mu,\frac{16}{n}\right)
$$
那么
$$
\frac{\sqrt{n}(\overline{x}-\mu)}{4}\sim N(0,1)
$$
记
$$
\Phi(x)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{x}\mathrm{e}^{-\frac{t^2}{2}}\mathrm{d}t
$$
那么
$$
\begin{align}
P\left\{ \left| \overline{x}-\mu \right|<1 \right\}
&=P\left\{ -\frac{\sqrt{n}}{4}<\frac{\sqrt{n}(\overline{x}-\mu)}{4}<\frac{\sqrt{n}}{4} \right\}\\
&=\Phi\left(\frac{\sqrt{n}}{4}\right)-\Phi\left(-\frac{\sqrt{n}}{4}\right)\\
&=2\Phi\left(\frac{\sqrt{n}}{4}\right)-1
\end{align}
$$
如果
$$
P\left\{ \left| \overline{x}-\mu \right|<1 \right\}\ge 0.95
$$
等价于
$$
\Phi\left(\frac{\sqrt{n}}{4}\right)\ge 0.975
$$
查表可知
$$
\frac{\sqrt{n}}{4}\ge 1.96
$$
即
$$
n\ge 61.4656
$$
因此取$n=62$即可满足
$$
P\left\{ \left| \overline{x}-\mu \right|<1 \right\}\ge 0.95
$$

## 第二题

9.设$x_1,x_2$是来自$N(0,\sigma^2)$的样本，试求$Y=\left( \frac{x_1+x_2}{x_1-x_2} \right)^2$的分布。

**解：**由于$x_1,x_2$是相互独立的，那么
$$
\frac{x_1+x_2}{\sqrt{2}\sigma}\sim N(0,1)
$$

$$
\frac{x_1-x_2}{\sqrt{2}\sigma}\sim N(0,1)
$$

进而
$$
\left( \frac{x_1+x_2}{\sqrt{2}\sigma} \right)^2\sim \chi^2(1)
$$

$$
\left( \frac{x_1-x_2}{\sqrt{2}\sigma} \right)^2\sim \chi^2(1)
$$

考虑到
$$
\mathrm{cov}\left( \frac{x_1+x_2}{\sqrt{2}\sigma},\frac{x_1-x_2}{\sqrt{2}\sigma} \right)=
\frac{1}{2\sigma^2}(D(x_1)-D(x_2))=0
$$
因此$\frac{x_1+x_2}{\sqrt{2}\sigma}$和$\frac{x_1-x_2}{\sqrt{2}\sigma}$是不相关的。注意到$(x_1,x_2)$服从二维正态分布，那么$\left( \frac{x_1+x_2}{\sqrt{2}\sigma},\frac{x_1-x_2}{\sqrt{2}\sigma} \right)$服从二维正态分布，因此$\frac{x_1+x_2}{\sqrt{2}\sigma}$和$\frac{x_1-x_2}{\sqrt{2}\sigma}$是相互独立的。

进而
$$
Y=\left( \frac{x_1+x_2}{x_1-x_2} \right)^2=\frac{\left( \frac{x_1+x_2}{\sqrt{2}\sigma} \right)^2}{\left( \frac{x_1-x_2}{\sqrt{2}\sigma} \right)^2}\sim F(1,1)
$$

## 第三题

19.设$x_1,\cdots,x_n$是来自某连续总体的一个样本。该总体的分布函数$F(x)$是连续严格单增函数，证明
$$
T=-2\sum_{k=1}^{n}{\ln{F(x_k)}}\sim \chi^2(2n)
$$
**证明：**由课本112页定理2.6.5可知
$$
F(x_i)\sim U(0,1),\quad i=1,\cdots,n
$$
注意到
$$
P\{ -2\ln F(x_i)<x \}=P\{ F(x_i)>\mathrm{e}^{-\frac{x}{2}} \}=\begin{cases}
1-\mathrm{e}^{-\frac{x}{2}},&\quad x>0\\
0,&\quad x\le 0
\end{cases}
$$
因此
$$
-2\ln F(x_i)\sim \chi^2(2)
$$
由于独立性，进而
$$
T=-2\sum_{k=1}^{n}{\ln{F(x_k)}}\sim \chi^2(2n)
$$

# 习题5.5

## 第一题

12.设$x_1,\cdots,x_n$是来自均匀分布$U(\theta,2\theta),\theta>0$的样本，试给出充分统计量。

**解：**总体概率函数为
$$
p(x_1,\cdots,x_n;\theta)=
\frac{1}{\theta^n}I_{\theta<x_{(1)}\le x_{(n)}<2\theta}
$$
因此取
$$
g(x_{(1)},x_{(n)};\theta)=\frac{1}{\theta^n}I_{\theta<x_{(1)}\le x_{(n)}<2\theta}
$$

$$
h(x_1,\cdots,x_n)=1
$$

那么
$$
p(x_1,\cdots,x_n;\theta)=g(x_{(1)},x_{(n)};\theta)h(x_1,\cdots,x_n)
$$
由因子分解定理，$(x_{(1)},x_{(n)})$为$\theta$的充分统计量。

## 第二题

19.设$x_1,\cdots,x_n$是来自两参数指数分布
$$
p(x;\theta,\mu)=\frac{1}{\theta}\mathrm{e}^{-\frac{x-\mu}{\theta}},\quad x>\mu,\theta>0
$$
的样本，证明$(\overline{x},x_{(1)})$是充分统计量。

**证明：**总体概率密度函数为
$$
p(x_1,\cdots,x_n;\theta,\mu)=\frac{1}{\theta^n}\mathrm{e}^{-\frac{n(\overline{x}-\mu)}{\theta}}I_{x_{(1)}>\mu}
$$
因此取
$$
g(\overline{x},x_{(1)};\theta,\mu)=\frac{1}{\theta^n}\mathrm{e}^{-\frac{n(\overline{x}-\mu)}{\theta}}I_{x_{(1)}>\mu}
$$

$$
h(x_1,\cdots,x_n)=1
$$

那么
$$
p(x_1,\cdots,x_n;\theta,\mu)=g(\overline{x},x_{(1)};\theta)h(x_1,\cdots,x_n)
$$
由因子分解定理，$(\overline{x},x_{(1)})$为$\theta$的充分统计量。

## 第三题

试用统计软件计算$N(0,1),t(10),\chi^2(10),F(8,10)$分布函数在$3$点处的值；计算上述随机变量的$0.93$分位数。

**解：**

对于分布函数在$3$点处的值：

```R
# 标准正态分布
pnorm(3)

# t分布（自由度为10）
pt(3, df = 10)

# 卡方分布（自由度为10）
pchisq(3, df = 10)

# F分布（自由度为8和10）
pf(3, df1 = 8, df2 = 10)
```

输出结果为

```R
[1] 0.9986501
[1] 0.9933282
[1] 0.01857594
[1] 0.9464874
```

对于上述随机变量的$0.93$​分位数：

```R
# 标准正态分布
qnorm(0.93)

# t分布（自由度为10）
qt(0.93, df = 10)

# 卡方分布（自由度为10）
qchisq(0.93, df = 10)

# F分布（自由度为8和10）
qf(0.93, df1 = 8, df2 = 10)
```

输出结果为

```R
[1] 1.475791
[1] 1.603075
[1] 17.20257
[1] 2.724553
```

# 习题6.1

## 第一题

3.设$\hat{\theta}$是参数$\theta$的无偏估计，且有$\mathrm{Var}( \hat{\theta} )>0$，试证$\hat{\theta}^2$不是$\theta^2$的无偏估计。

**解：**由于$\hat{\theta}$是参数$\theta$的无偏估计，那么
$$
E( \hat{\theta} )=\theta
$$
注意到
$$
E( \hat{\theta}^2 )=\mathrm{Var}( \hat{\theta} )+(E( \hat{\theta} ))^2>\theta^2
$$
因此$\hat{\theta}^2$不是$\theta^2$的无偏估计。

## 第二题

7.设从均值为$\mu$，方差为$\sigma^2>0$的总体中，分别抽取容量为$n_1$和$n_2$的两独立样本，$\overline{x}_1$和$\overline{x}_2$分别是这两个样本的均值，试证，对于任意常数$a,b$满足$a+b=1$，$Y=a\overline{x}_1+b\overline{x}_2$都是$\mu$的无偏估计，并确定常数$a,b$使得$\mathrm{Var}(Y)$达到最小。

**解：**注意到
$$
E\left(\overline{x}_1\right)=E\left(\overline{x}_2\right)=\mu
$$

$$
\mathrm{Var}\left(\overline{x}_1\right)=\frac{\sigma^2}{n_1},\qquad \mathrm{Var}\left(\overline{x}_2\right)=\frac{\sigma^2}{n_2}
$$

由于两样本是独立的，因此$\overline{x}_1$和$\overline{x}_2$是独立的，因此
$$
E\left(Y\right)=E\left(a\overline{x}_1+b\overline{x}_2\right)=aE\left(\overline{x}_1\right)+bE\left(\overline{x}_2\right)=(a+b)\mu=\mu
$$
因此$Y=a\overline{x}_1+b\overline{x}_2$是$\mu$的无偏估计。

考虑到
$$
\mathrm{Var}\left(Y\right)=\mathrm{Var}\left(a\overline{x}_1+b\overline{x}_2\right)=a^2\mathrm{Var}\left(\overline{x}_1\right)+b^2\mathrm{Var}\left(\overline{x}_2\right)=\sigma^2\left(\frac{a^2}{n_1}+\frac{b^2}{n_2}\right)\ge \sigma^2\frac{(a+b)^2}{n_1+n_2}=\frac{\sigma^2}{n_1+n_2}
$$
当且仅当$(a,b)=\left( \frac{n_1}{n_1+n_2},\frac{n_2}{n_1+n_2} \right)$时等号成立。其中不等式成立是因为Cauchy不等式。

# 习题6.2

4.设总体密度函数如下，$x_1,\cdots,x_n$是样本，试求未知参数的矩估计。

(4)$p(x;\theta,\mu)=\frac{1}{\theta}\mathrm{e}^{-\frac{x-\mu}{\theta}},\quad x>\mu,\theta>0$

**解：**总体的一阶和二阶原点矩分别为
$$
E(X)=\int_{\mu}^{+\infty}{xp(x;\theta,\mu)}=\theta+\mu
$$

$$
E(X^2)=\int_{\mu}^{+\infty}{x^2p(x;\theta,\mu)}=\theta^2+(\theta+\mu)^2
$$

进而
$$
\theta=\sqrt{E(X^2)-(E(X))^2}=\sqrt{\mathrm{Var}(X)},\qquad \mu=E(X)-\sqrt{\mathrm{Var}(X)}
$$
考虑替换原理，那么
$$
\theta=s,\qquad \mu=\overline{x}-s
$$
那么$\theta$和$\mu$的矩估计分别为
$$
\hat{\theta}=s,\qquad \hat{\mu}=\overline{x}-s
$$

# 习题6.3

## 第一题

1.设总体概率函数如下，$x_1,\cdots,x_n$是样本，试求未知参数的最大似然估计。

(2)$p(x;\theta)=\theta c^{\theta}x^{-(\theta+1)},\quad x>c>0,\theta>1$，$c$为已知参数。

**解：**似然函数为
$$
L(\theta)=\theta^n c^{n\theta}\left(\prod_{k=1}^{n}{x_k}\right)^{-(\theta+1)}
$$
记对数似然函数为
$$
f(\theta)=\ln{L(\theta)}
$$
那么
$$
f'(\theta)=\frac{n}{\theta}+\left(n\ln{c}-\sum_{k=1}^{n}{\ln{x_k}}\right)
$$
注意到，当$\theta=\frac{n}{\sum_{k=1}^{n}{\ln{x_k}}-n\ln{c}}$时，$f'(\theta)=0$。那么$\hat{\theta}=\frac{n}{\sum_{k=1}^{n}{\ln{x_k}}-n\ln{c}}$为$\theta$的最大似然估计。

## 第二题

2.设总体概率函数如下，$x_1,\cdots,x_n$是样本，试求未知参数的最大似然估计。

(2)$p(x;\theta,\mu)=\frac{1}{\theta}\mathrm{e}^{-\frac{x-\mu}{\theta}},\quad x>\mu,\theta>0$

**解：**似然函数为
$$
L(\theta,\mu)=\frac{1}{\theta^n}\mathrm{e}^{-\frac{n}{\theta}(\overline{x}-\mu)}I_{x_{(1)}>\mu}
$$
因此当$\mu<x_{(1)},\theta>0$时，记对数似然函数为
$$
f(\theta,\mu)=\ln{L(\theta,\mu)}=n\left( \frac{\mu-\overline{x}}{\theta}-\ln{\theta} \right)
$$
若$f(\theta,\mu)$取最大值，那么$\mu=x_{(1)}$，此时
$$
\frac{\part f}{\part \theta}=\frac{n}{\theta^2}(\overline{x}-x_{(1)}-\theta)
$$
那么当$\theta=\overline{x}-x_{(1)}$时$f(\theta,\mu)$取最大值。

综上，$\hat{\theta}=\overline{x}-x_{(1)}$和$\hat{\mu}=x_{(1)}$分别为$\theta$和$\mu$的最大似然估计。

## 第三题

7.设总体$X\sim U(\theta,2\theta)$，其中$\theta>0$是未知参数，$x_1,\cdots,x_n$为取自该总体的样本，$\overline{x}$为样本均值。

### 第一问

证明$\hat{\theta}=\frac{2}{3}\overline{x}$是参数$\theta$的无偏估计和相合估计。

**证明：**由于总体$X\sim U(\theta,2\theta)$，那么
$$
E(X)=\frac{3}{2}\theta,\qquad \mathrm{Var}(X)=\frac{\theta^2}{12}
$$
对于无偏性，注意到
$$
E(\hat{\theta})=E\left( \frac{2}{3}\overline{x} \right)=\frac{2}{3}E(\overline{x})=\frac{2}{3}E(X)=\theta
$$
因此$\hat{\theta}=\frac{2}{3}\overline{x}$是参数$\theta$的无偏估计。

对于相合性，注意到
$$
\mathrm{Var}(\hat{\theta})=\mathrm{Var}(\frac{2}{3}\overline{x})=\frac{\theta^2}{27n}\to0
$$
因此$\hat{\theta}=\frac{2}{3}\overline{x}$是参数$\theta$的相合估计。

### 第二问

求$\theta$的最大似然估计，它是无偏估计吗？是相合估计吗？

**解：**似然函数为
$$
L(\theta)=\frac{1}{\theta^n}I_{\theta<x_{(1)}\le x_{(n)}<2\theta}
$$
因此当$\frac{1}{2}x_{(n)}<\theta<x_{(1)}$时，$L(\theta)$在$\theta=\frac{1}{2}x_{(n)}$时取最大值，因此$\theta$的最大似然估计为
$$
\hat{\theta}=\frac{1}{2}x_{(n)}
$$
考察其无偏性和相合性。注意到$x_{(n)}$​的密度函数为
$$
p(x)=\frac{n}{\theta^n}(x-\theta)^{n-1},\quad \theta<x<2\theta
$$
因此
$$
E(x_{(n)})=\int_{\theta}^{2\theta}{xp(x)\mathrm{d}x}=\frac{2n+1}{n+1}\theta
$$

$$
E(x^2_{(n)})=\int_{\theta}^{2\theta}{x^2p(x)\mathrm{d}x}=\frac{4n^2+8n+2}{(n+2)(n+1)}\theta^2
$$

进而
$$
\mathrm{Var}(x_{(n)})=E(x^2_{(n)})-(E(x_{(n)}))^2=\frac{n}{(n+2)(n+1)^2}\theta^2
$$
对于无偏性，考虑到
$$
E(\hat{\theta})=E\left( \frac{1}{2}x_{(n)} \right)=\frac{1}{2}E(x_{(n)})=\frac{2n+1}{2(n+1)}\theta\ne\theta
$$
因此$\hat{\theta}=\frac{1}{2}x_{(n)}$不是参数$\theta$的无偏估计。

对于相合性，考虑到
$$
E(\hat{\theta})=\frac{2n+1}{2(n+1)}\theta\to\theta
$$

$$
\mathrm{Var}(\hat{\theta})=\mathrm{Var}\left( \frac{1}{2}x_{(n)} \right)=\frac{1}{4}\mathrm{Var}(x_{(n)})=\frac{n}{4(n+2)(n+1)^2}\theta^2\to0
$$
因此$\hat{\theta}=\frac{1}{2}x_{(n)}$是参数$\theta$的相合估计。

# 习题6.4

## 第一题

2.设$T_1,T_2$分别是$\theta_1,\theta_2$的最小方差无偏估计，证明：对于任意非零常数$a,b$，$aT_1+bT_2$是$a\theta_1+b\theta_2$的最小方差无偏估计。

**证明：**由于$T_1,T_2$分别是$\theta_1,\theta_2$的最小方差无偏估计，那么
$$
E(T_1)=\theta_1,\qquad E(T_2)=\theta_2
$$
且对于任意满足$E(\varphi)=0$的关于总体的函数$\varphi$成立
$$
\mathrm{Cov}(T_1,\varphi)=\mathrm{Cov}(T_2,\varphi)=0
$$
注意到
$$
E(aT_1+bT_2)=aE(T_1)+bE(T_2)=a\theta_1+b\theta_2
$$
且
$$
\mathrm{Cov}(aT_1+bT_2,\varphi)=a\mathrm{Cov}(T_1,\varphi)+b\mathrm{Cov}(T_2,\varphi)=0
$$
因此$aT_1+bT_2$是$a\theta_1+b\theta_2$的最小方差无偏估计。

## 第二题

4.设总体$X\sim N(\mu,\sigma^2)$，$X=(x_1,\cdots,x_n)$是样本，证明$\overline{x}=\frac{1}{n}\sum_{k=1}^{n}{x_k}$和$s^2=\frac{1}{n-1}\sum_{k=1}^{n}(x_k-\overline{x})^2$分别是$\mu$和$\sigma^2$的最小方差无偏估计。

**证明：**首先由定理5.3.2可知$\overline{x}$和$s^2$分别是$\mu$和$\sigma^2$的无偏估计。

任取$\varphi(X)$，满足$E(\varphi)=0$。由于$x_1,\cdots,x_n$的联合密度函数为
$$
p(X)=\prod_{k=1}^{n}{\frac{1}{\sqrt{2\pi}\sigma}\mathrm{e}^{-\frac{(x_k-\mu)^2}{2\sigma^2}}}
=\frac{1}{(2\pi)^{\frac{n}{2}}\sigma^n}\mathrm{e}^{-\frac{\sum_{k=1}^{n}{x_k^2}-2n\mu\overline{x}+n\mu^2}{2\sigma^2}}
$$
由于$E(\varphi)=0$，那么
$$
\label{引用1}\int_{\R^n}{\varphi(X) p(X)\mathrm{d}X}=0\tag{*}
$$
其次证明$\overline{x}=\frac{1}{n}\sum_{k=1}^{n}{x_k}$是$\mu$的UMVUE，即证明
$$
\mathrm{Cov}(\overline{x},\varphi)
=E(\overline{x}\varphi)-E(\overline{x})E(\varphi)
=E(\overline{x}\varphi)
=0
$$
$(\ref{引用1})$式两边对$\mu$求导，可得
$$
\label{引用2}
\int_{\R^n}{\overline{x}\varphi(X) p(X)\mathrm{d}X}
=\mu\int_{\R^n}{\varphi(X) p(X)\mathrm{d}X}
\tag{**}
$$
即
$$
E(\overline{x}\varphi)=\mu E(\varphi)=0
$$
进而
$$
\mathrm{Cov}(\overline{x},\varphi)=E(\overline{x}\varphi)-E(\overline{x})E(\varphi)=0
$$
于是$\overline{x}=\frac{1}{n}\sum_{k=1}^{n}{x_k}$是$\mu$的UMVUE。

最后证明$s^2=\frac{1}{n-1}\sum_{k=1}^{n}(x_k-\overline{x})^2$是$\sigma^2$的UMVUE，即证明
$$
\mathrm{Cov}(s^2,\varphi)
=E(s^2\varphi)-E(s^2)E(\varphi)
=E(s^2\varphi)
=0
$$
$(\ref{引用2})$式两边对$\mu$​求导，可得
$$
n\int_{\R^n}{\overline{x}^2\varphi(X)p(X)\mathrm{d}X}
=(\sigma^2-n\mu^2)\int_{\R^n}{\varphi(X)p(X)\mathrm{d}X}
+2n\mu\int_{\R^n}{\overline{x}\varphi(X)p(X)\mathrm{d}X}
$$
即
$$
nE(\overline{x}^2\varphi)=(\sigma^2-n\mu^2)E(\varphi)+2n\mu E(\overline{x}\varphi)=0
$$
$(\ref{引用1})$式变形可得
$$
\label{引用3}
\int_{\R^n}{\varphi(X) \mathrm{e}^{-\frac{\sum_{k=1}^{n}{x_k^2}-2n\mu\overline{x}+n\mu^2}{2\sigma^2}}\mathrm{d}X}=0\tag{***}
$$
$(\ref{引用3})$式两边对$\sigma^2$​求导，可得
$$
\int_{\R^n}{\sum_{k=1}^{n}{x_k^2}\varphi(X)p(X)\mathrm{d}X}
=2n\mu\int_{\R^n}{\overline{x}\varphi(X)p(X)\mathrm{d}X}
-n\mu^2\int_{\R^n}{\varphi(X)p(X)\mathrm{d}X}
$$
即
$$
E\left(\sum_{k=1}^{n}{x_k^2}\varphi\right)=
2n\mu E(\overline{x}\varphi)
-n\mu^2E(\varphi)=0
$$

进而
$$
\begin{align}
\mathrm{Cov}(s^2,\varphi)
&=E(s^2\varphi)-E(s^2)E(\varphi)\\
&=\frac{1}{n-1}E\left( \left( \sum_{k=1}^{n}{x_k^2}-n\overline{x}^2 \right)\varphi \right)\\
&=\frac{1}{n-1}\left( E\left(\sum_{k=1}^{n}{x_k^2}\varphi\right)-nE(\overline{x}^2\varphi) \right)\\
&=0
\end{align}
$$
于是$s^2=\frac{1}{n-1}\sum_{k=1}^{n}(x_k-\overline{x})^2$是$\sigma^2$的最小方差无偏估计。

综上所述，$\overline{x}=\frac{1}{n}\sum_{k=1}^{n}{x_k}$和$s^2=\frac{1}{n-1}\sum_{k=1}^{n}(x_k-\overline{x})^2$分别是$\mu$和$\sigma^2$的最小方差无偏估计！

## 第三题

6.设总体密度函数为$p(x;\theta)=\theta x^{\theta-1},0<x<1,\theta>0$，$x_1,\cdots,x_n$是样本。

### 第一问

(1)求$g(\theta)=\frac{1}{\theta}$的最大似然估计。

**解：**似然函数为
$$
L(\theta)=\theta^n\left(\prod_{k=1}^{n}{x_k}\right)^{\theta-1}
$$
记对数似然函数为
$$
f(\theta)=\ln{L(\theta)}=n\ln\theta+(\theta-1)\sum_{k=1}^{n}{\ln{x_k}}
$$
注意到
$$
f'(\theta)=\frac{n}{\theta}+\sum_{k=1}^{n}{\ln{x_k}}
$$
因此当$\theta=-\frac{n}{\sum_{k=1}^{n}{\ln{x_k}}}$时，$f(\theta)$取得最大值，因此$\hat{\theta}=-\frac{n}{\sum_{k=1}^{n}{\ln{x_k}}}$为$\theta$的最大似然估计，进而
$$
\hat{g}(\theta)=-\frac{1}{n}\sum_{k=1}^{n}{\ln{x_k}}
$$
为$g(\theta)=\frac{1}{\theta}$的最大似然估计。

### 第二问

(2)求$g(\theta)$的有效估计。

**解：**首先考察
$$
\hat{g}(\theta)=-\frac{1}{n}\sum_{k=1}^{n}{\ln{x_k}}
$$
令$Y=-\ln{X}$，注意到
$$
P(Y<y)=P(-\ln{X}<y)=P(X>\mathrm{e}^{-y})=
\begin{cases}
1-\mathrm{e}^{-\theta y},\quad & y>0\\
0,\quad & y\le 0
\end{cases}
$$
因此$Y\sim\Gamma(1,\theta)$，进而$\hat{g}(\theta)\sim\Gamma(n,n\theta)$，于是
$$
E(\hat{g}(\theta))=\frac{1}{\theta},\qquad 
\mathrm{Var}(\hat{g}(\theta))=\frac{1}{n\theta^2}
$$
进而$\hat{g}(\theta)$为$g(\theta)=\frac{1}{\theta}$的无偏估计。

下面验证$p(x;\theta)$满足Fisher信息量的定义。

- 参数空间$\Theta=(0,\infty)$为开区间。

- 支撑$S=\{ x:p(x;\theta)>0 \}=\R$与$\theta$无关。

- 导数
  $$
  \frac{\part}{\part\theta}p(x;\theta)=
  x^{\theta-1}+\theta x^{\theta-1}\ln{x}
  $$
  对任意$\theta\in\Theta$均存在。

- 注意到
  $$
  \frac{\part}{\part \theta}\int_{0}^{1}{p(x;\theta)\mathrm{d}x}=0
  $$

  $$
  \int_{0}^{1}{\frac{\part}{\part \theta}p(x;\theta)\mathrm{d}x}=0
  $$

  因此
  $$
  \frac{\part}{\part \theta}\int_{0}^{1}{p(x;\theta)\mathrm{d}x}=\int_{0}^{1}{\frac{\part}{\part \theta}p(x;\theta)\mathrm{d}x}
  $$
  于是对于$p(x;\theta)$，积分与微分运算可交换次序。

- 注意到
  $$
  E\left( \frac{\part}{\part \theta}\ln{p(x;\theta)} \right)^2
  =\int_0^1{(\frac{1}{\theta}+\ln{x})^2\theta x^{\theta-1}\mathrm{d}x}=\frac{1}{\theta^2}
  $$
  于是
  $$
  I(\theta)=\frac{1}{\theta^2}
  $$
  为总体的Fisher信息量。

  又$g'(\theta)=-\frac{1}{\theta^2}$，那么
  $$
  \mathrm{Var}(\hat{g}(\theta))=\frac{1}{n\theta^2}=\frac{(g'(\theta))^2}{nI(\theta)}
  $$
  为$g(\theta)$的无偏估计的方差的C-R下界，因此$\hat{g}(\theta)$的方差达到了$g(\theta)$的无偏估计的方差的C-R下界，于是$\hat{g}(\theta)$为$g(\theta)$的有效估计。

# 习题6.5

## 第一题

2.设总体为均匀分布$U(\theta,\theta+1)$，$\theta$的先验分布是均匀分布$U(10,16)$，现有三个观测值：$11.7,12.1,12.0$，求$\theta$的后验分布。

**解：**样本$x_1,x_2,x_3$的联合条件密度函数为
$$
P(x_1,x_2,x_3\mid \theta)=\prod_{k=1}^{3}{p(x_k\mid\theta)}=1,\quad 
\theta<x_{(1)}\le x_{(3)}<\theta+1
$$
由于$\theta$的先验分布为
$$
\pi(\theta)=\frac{1}{6},\quad 10<\theta<16
$$
那么$x_1,x_2,x_3$和$\theta$的联合分布为
$$
h(x_1,x_2,x_3,\theta)=\frac{1}{6},\quad
10<\theta<x_{(1)}\le x_{(3)}<\theta+1<17
$$
此时$x_{(3)}-1<\theta<x_{(1)}$，由观测值，即$11.1<\theta<11.7$，因此$x_1,x_2,x_3$的边际概率函数为
$$
m(x_1,x_2,x_3)=\int_{11.1}^{11.7}{h(x_1,x_2,x_3,\theta)\mathrm{d}\theta}=\frac{1}{10}
$$
进而$\theta$的后验分布为
$$
\pi(\theta\mid x_1,x_2,x_3)=\frac{h(x_1,x_2,x_3,\theta)}{m(x_1,x_2,x_3)}=\frac{5}{3}
$$
于是$\theta$的后验分布为均匀分布$U(11.1,11.7)$。

## 第二题

8.设$X=(x_1,\cdots,x_n)$是来自均匀分布$U(0,\theta)$的样本，$\theta$的先验分布为Pareto分布$\mathrm{Pa}(\theta_0,\beta)$，其密度函数为
$$
\pi(\theta)=\frac{\beta\theta_0^\beta}{\theta^{\beta+1}},\quad \theta>\theta_0
$$
其中$\theta_0$和$\beta$为已知常数。

### 第一问

(1)验证：Pareto分布是$\theta$的共轭先验分布。

**解：**样本$X$的联合条件概率函数为
$$
P(X\mid\theta)=\frac{1}{\theta^n},\quad 0<x_{(1)}\le x_{(n)}<\theta
$$
由于$\theta$的先验分布为
$$
\pi(\theta)=\frac{\beta\theta_0^\beta}{\theta^{\beta+1}},\quad \theta>\theta_0
$$
那么$X$和$\theta$的联合分布为
$$
h(X,\theta)=P(X\mid\theta)\pi(\theta)=
\frac{\beta\theta_0^\beta}{\theta^{n+\beta+1}},\quad
\theta>\max\{\theta_0,x_{(n)}\}
$$
因此$X$的边际概率函数为
$$
m(X)=\int_{\max\{\theta_0,x_{(n)}\}}^{\infty}{h(X,\theta)\mathrm{d}\theta}=\frac{\beta\theta_0^\beta}{(n+\beta)(\max\{\theta_0,x_{(n)}\})^{n+\beta}}
$$
进而$\theta$的后验分布为
$$
\pi(\theta\mid X)=\frac{h(X,\theta)}{m(X)}=\frac{(n+\beta)(\max\{\theta_0,x_{(n)}\})^{n+\beta}}{\theta^{n+\beta+1}},\quad
\theta>\max\{\theta_0,x_{(n)}\}
$$

注意到
$$
\pi(\theta\mid X)\sim\mathrm{Pa}(\max\{\theta_0,x_{(n)}\},n+\beta)
$$
因此Pareto分布是$\theta$的共轭先验分布。

### 第二问

求$\theta$的Bayes估计。

**解：**由于后验分布为
$$
\pi(\theta\mid X)=\frac{(n+\beta)(\max\{\theta_0,x_{(n)}\})^{n+\beta}}{\theta^{n+\beta+1}},\quad
\theta>\max\{\theta_0,x_{(n)}\}
$$
进而Bayes估计为
$$
\hat{\theta}=
\int_{\max\{\theta_0,x_{(n)}\}}^{\infty}{\theta\pi(\theta\mid X)\mathrm{d}\theta}=
\frac{(n+\beta)\max\{\theta_0,x_{(n)}\}}{n+\beta+1}
$$

# 习题6.6

## 第一题

5.已知某种材料的抗压强度$X\sim N(\mu,\sigma^2)$，现随机抽取$10$个试件进行抗压试验，测得数据如下：
$$
482,493,457,471,510,446,435,418,394,469
$$

**解：**我们先来做一些准备工作。

注意到$n=10$，样本均值为
$$
\overline{x}=\frac{1}{10}{\sum_{k=1}^{10}{x_k}}=\frac{915}{2}=457.5
$$
样本标准差为
$$
s=\sqrt{\frac{1}{10-1}\sum_{k=1}^{10}{(x_k-\overline{x})^2}}=\frac{5}{6}\sqrt{1786}\approx 35.2176
$$

### 第一问

(1)求平均抗压强度$\mu$的置信水平为$95\%$的置信区间。

**解：**枢轴量为
$$
T=\frac{\sqrt{n}(\overline{x}-\mu)}{s}\sim T(n-1)
$$
取$\alpha=5\%$，于是$\mu$的置信水平为$1-\alpha$的置信区间为
$$
\left[\overline{x}-\frac{s}{\sqrt{n}}t_{1-\frac{\alpha}{2}},\quad 
\overline{x}+\frac{\sigma}{\sqrt{n}}t_{1-\frac{\alpha}{2}}\right]
$$
其中$t_{1-\frac{\alpha}{2}}$为$T$的$1-\frac{\alpha}{2}$分位数，即$t_{1-\frac{\alpha}{2}}=2.2622$，代入数据，得到$\mu$的置信水平为$95\%$的置信区间为$[432.3064,482.6936]$。

### 第二问

(2)若已知$\sigma=30$，求平均抗压强度$\mu$的置信水平为$95\%$的置信区间。

**解：**枢轴量为
$$
N=\frac{\sqrt{n}(\overline{x}-\mu)}{\sigma}\sim N(0,1)
$$
取$\alpha=5\%$，于是$\mu$的置信水平为$1-\alpha$的置信区间为
$$
\left[\overline{x}-\frac{\sigma}{\sqrt{n}}n_{1-\frac{\alpha}{2}},\quad
\overline{x}+\frac{\sigma}{\sqrt{n}}n_{1-\frac{\alpha}{2}}\right]
$$
其中$n_{1-\frac{\alpha}{2}}$为$N$的$1-\frac{\alpha}{2}$分位数，即$n_{1-\frac{\alpha}{2}}=1.96$，代入数据，得到$\mu$的置信水平为$95\%$的置信区间为$[438.9058,476.0942]$。

### 第三问

(3)求$\sigma$的置信水平为$95\%$的置信区间。

**解：**枢轴量为
$$
\chi=\frac{(n-1)s}{\sigma^2}\sim \chi^2(n-1)
$$
取$\alpha=5\%$，于是$\sigma^2$的置信水平为$1-\alpha$的同等置信区间为
$$
\left[s\left(\frac{(n-1)}{\chi^2_{1-\frac{\alpha}{2}}}\right)^{\frac{1}{2}},\quad 
s\left(\frac{(n-1)}{\chi^2_{\frac{\alpha}{2}}}\right)^{\frac{1}{2}}\right]
$$
其中$\chi^2_{1-\frac{\alpha}{2}}$和$\chi^2_{\frac{\alpha}{2}}$分别为为$\chi$的$1-\frac{\alpha}{2}$分位数和$\frac{\alpha}{2}$分位数，即$\chi^2_{1-\frac{\alpha}{2}}=19.02$和$\chi^2_{\frac{\alpha}{2}}=2.70$，代入数据，得到$\sigma$的置信水平为$95\%$的置信区间为$[24.2257,64.2982]$。

## 第二题

10.假设人体身高服从正态分布，今抽测甲、乙两地区18岁~25岁女青年身高得数据如下：甲地区抽取$10$名，样本均值$1.64\mathrm{m}$，样本标准差$0.2\mathrm{m}$；乙地区抽取$10$名，样本均值$1.62\mathrm{m}$，样本标准差$0.4\mathrm{m}$。

**解：**我们现在做一些准备工作。

记甲地区样本均值、样本标准差、样本容量、总体均值、总体方差为
$$
\overline{x}=1.64,\quad 
s_x=0.2,\quad 
n_1=10,\quad 
\mu_1,\quad 
\sigma^2_1
$$

记乙地区样本均值、样本标准差、样本容量、总体均值、总体方差为
$$
\overline{y}=1.62,\quad 
s_y=0.4,\quad 
n_2=10,\quad 
\mu_2,\quad 
\sigma^2_2
$$

### 第一问

(1)两正态总体方差比的置信水平为$95\%$的置信区间。

**解：**枢轴量为
$$
\frac{s_x^2/\sigma^2_1}{s_y^2/\sigma^2_2}\sim F(n_1-1,n_2-1)
$$
取$\alpha=5\%$，于是$\frac{\sigma^2_2}{\sigma^2_1}$的置信水平为$1-\alpha$的同等置信区间为
$$
\left[\frac{s_x^2}{s_y^2}\frac{1}{f_{1-\frac{\alpha}{2}}},\quad 
\frac{s_x^2}{s_y^2}\frac{1}{f_{\frac{\alpha}{2}}}\right]
$$
其中$f_{1-\frac{\alpha}{2}}$和$f_{\frac{\alpha}{2}}$分别为为$F$的$1-\frac{\alpha}{2}$分位数和$\frac{\alpha}{2}$分位数，即$f_{1-\frac{\alpha}{2}}=4.03$和$f_{\frac{\alpha}{2}}=0.25$，代入数据，得到两正态总体方差比$\frac{\sigma^2_2}{\sigma^2_1}$的置信水平为$95\%$的置信区间为$[0.0620,1.0000]$。

### 第二问

(2)两正态总体均值差的置信水平为$95\%$的置信区间。

**解：**记
$$
s_0^2=\frac{s_x^2}{n_1}+\frac{s_y^2}{n_2}=\frac{1}{50}=0.02
$$

$$
l=\left[ \frac{s_0^4}{\frac{s_x^4}{n_1^2(n_1-1)}+\frac{s_y^4}{n_2^2(n_2-1)}} \right]=\left[\frac{225}{17}\right]=13
$$

其中$[*]$表示最近整数，于是
$$
T=\frac{(\overline{x}-\overline{y})-(\mu_1-\mu_2)}{s_0}\dot{\sim} T(l)
$$
取$\alpha=5\%$，因此$\mu_1-\mu_2$的置信水平为$1-\alpha$的同等置信区间为
$$
\left[ (\overline{x}-\overline{y})-s_0t_{1-\frac{\alpha}{2}},(\overline{x}-\overline{y})+s_0t_{1-\frac{\alpha}{2}} \right]
$$
其中$t_{1-\frac{\alpha}{2}}$为$T$的$1-\frac{\alpha}{2}$分位数，即$t_{1-\frac{\alpha}{2}}=2.16$，代入数据，得到两正态总体均值差$\mu_1-\mu_2$的置信水平为$95\%$的置信区间为$[-0.2855,0.3255]$。

## 第三题

12.设某电子产品的寿命服从指数分布，其密度函数为$\lambda\mathrm{e}^{-\lambda x}I_{x>0}$，现从此批产品中抽取容量为$9$的样本，测得寿命为（单位：千小时）
$$
15,45,50,53,60,65,70,83,90
$$
求平均寿命$\frac{1}{\lambda}$的置信水平为$90\%$的置信区间和置信上、下限。

**解：**注意到指数分布和$\Gamma$分布的关系为
$$
\exp(\lambda)=\Gamma(1,\lambda)
$$
于是枢轴量为
$$
2\lambda\sum_{k=1}^{n}{x_k}\sim\chi^2(2n)
$$
其中$n=9$为样本容量。

对于置信区间，取$\alpha=10\%$，注意到
$$
P(\chi^2_{\frac{\alpha}{2}}\le 2\lambda\sum_{k=1}^{n}{x_k}\le \chi^2_{1-\frac{\alpha}{2}})=1-\alpha
$$
其中$\chi^2_{1-\frac{\alpha}{2}}$和$\chi^2_{\frac{\alpha}{2}}$分别为$\chi^2(2n)$的$1-\frac{\alpha}{2}$分位数和$\frac{\alpha}{2}$分位数，即$(\chi^2_{\frac{\alpha}{2}},\chi^2_{1-\frac{\alpha}{2}})=(9.39，28.87)$，于是
$$
\frac{2}{\chi^2_{1-\frac{\alpha}{2}}}\sum_{k=1}^{n}{x_k}\le\frac{1}{\lambda}\le\frac{2}{\chi^2_{\frac{\alpha}{2}}}\sum_{k=1}^{n}{x_k}
$$
于是平均寿命$\frac{1}{\lambda}$的置信水平为$90\%$的置信区间为
$$
\left[\frac{2}{\chi^2_{1-\frac{\alpha}{2}}}\sum_{k=1}^{n}{x_k},\quad
\frac{2}{\chi^2_{\frac{\alpha}{2}}}\sum_{k=1}^{n}{x_k}\right]=[36.7856,113.0990]
$$

对于单侧置信下限，取$\alpha=10\%$，注意到
$$
P(2\lambda\sum_{k=1}^{n}{x_k}\le \chi^2_{1-\alpha})=1-\alpha
$$
其中$\chi^2_{1-\alpha}$为$\chi^2(2n)$的$1-\alpha$分位数，即$\chi^2_{1-\alpha}=25.99$，于是
$$
\frac{1}{\lambda}\ge\frac{2}{\chi^2_{1-\alpha}}\sum_{k=1}^{n}{x_k}
$$
于是平均寿命$\frac{1}{\lambda}$的置信水平为$90\%$的置信下限为
$$
\frac{2}{\chi^2_{1-\alpha}}\sum_{k=1}^{n}{x_k}=40.8619
$$

对于单侧置信上限，取$\alpha=10\%$，注意到
$$
P(2\lambda\sum_{k=1}^{n}{x_k}\ge \chi^2_{\alpha})=1-\alpha
$$
其中$\chi^2_{\alpha}$为$\chi^2(2n)$的$\alpha$分位数，即$\chi^2_{\alpha}=10.86$，于是
$$
\frac{1}{\lambda}\le\frac{2}{\chi^2_{\alpha}}\sum_{k=1}^{n}{x_k}
$$
于是平均寿命$\frac{1}{\lambda}$的置信水平为$90\%$的置信上限为
$$
\frac{2}{\chi^2_{\alpha}}\sum_{k=1}^{n}{x_k}=97.7900
$$

综上所述，平均寿命$\frac{1}{\lambda}$的置信水平为$90\%$的置信区间为$[36.7856,113.0990]$，置信上、下限分别是$40.8619$和$97.7900$。

# 习题7.1

## 第一题

1.设$x_1,\cdots,x_n$是来自$N(\mu,1)$的样本，考虑如下假设检验问题
$$
H_0:\mu=2\qquad \mathrm{vs}\qquad H_1:\mu=3
$$
若检验由拒绝域为$W=\{ \overline{x}\ge 2.6 \}$确定。

**解：**我们先来做一些准备工作。

由于$x_1,\cdots,x_n$是来自$N(\mu,1)$的样本，那么$\overline{x}\sim N(\mu,\frac{1}{n})$，于是$\sqrt{n}(\overline{x}-\mu)\sim N(0,1)$。

记
$$
\Phi(x)=\int_{-\infty}^{x}{\frac{1}{\sqrt{2\pi}}\mathrm{e}^{-\frac{x^2}{2}}},\quad -\infty<x<\infty
$$
进而得到
$$
\alpha(n)=P(\overline{x}\ge2.6\mid H_0)=P(\sqrt{n}(\overline{x}-2)\ge0.6\sqrt{n})=1-\Phi(0.6\sqrt{n})
$$
$$
\beta(n)=P(\overline{x}<2.6\mid H_1)=P(\sqrt{n}(\overline{x}-3)<-0.4\sqrt{n})=1-\Phi(0.4\sqrt{n})
$$

### 第一问

(1)当$n=20$时求检验犯两类错误的概率。

**解：**当$n=20$时
$$
\alpha=0.0037,\qquad \beta=0.0368
$$

### 第二问

(2)如果要使得检验犯第二类错误的概率$\beta\le0.01$，$n$最小应取多少？

**解：**若使检验犯第二类错误的概率$\beta\le0.01$，那么
$$
1-\Phi(0.4\sqrt{n})\le 0.01
$$
即
$$
\Phi(0.4\sqrt{n})\ge0.99
$$
于是
$$
0.4\sqrt{n}\ge 2.3263
$$
进而
$$
n\ge33.8229
$$
即$n$最小应取$34$。

### 第三问

(3)证明：当$n\to\infty$时，$\alpha\to0$且$\beta\to0$。

**证明：**注意到
$$
\lim_{x\to\infty}{\Phi(x)}=1
$$
于是
$$
\lim_{n\to\infty}{\alpha(n)}=\lim_{n\to\infty}{\beta(n)}=0
$$

## 第二题

5.在假设检验问题中，若检验结果是接受原假设，则检验可能犯哪一类错误？若检验结果是拒绝原假设，则又有可能犯哪一类错误？

**解：**若检验结果是接受原假设，则检验可能犯第二类错误。若检验结果是拒绝原假设，则又有可能犯第一类错误。

# 习题7.2

## 第一题

6.从一批钢管抽取$10$根，测得其内径（单位：mm）为：
$$
100.36,\quad 100.31,\quad 99.99,\quad 100.11,\quad 100.64,\quad 100.85,\quad 99.42,\quad 99.91,\quad 99.35,\quad 100.10
$$
设这批钢管内直径服从正态分布$N(\mu,\sigma^2)$，试分别在下列条件下检验假设，$\alpha=0.05$。
$$
H_0:\mu=100\qquad\mathrm{vs}\qquad H_1:\mu>100
$$

### 第一问

(1)已知$\sigma=0.5$。

**解：**待检验假设为
$$
H_0:\mu=100\qquad\mathrm{vs}\qquad H_1:\mu>100
$$
采用$u$检验，样本均值为$\overline{x}=100.104$，检验统计量为
$$
u=\frac{\sqrt{n}(\overline{x}-\mu_0)}{\sigma}
$$
拒绝域为$\{ u\ge u_{1-\alpha} \}$，其中$u_{1-\alpha}=1.6449$为$N(0,1)$的$1-\alpha$分位数。由样本观测值，$u_0=0.6578$，由于$u_0<u_{1-\frac{\alpha}{2}}$，因此接受原假设。

我们还可以采用检验的$p$值来判断是否拒绝原假设，此时$p$值为
$$
p=1-\Phi(u_0)=0.2553
$$
因为$p>\alpha$，因此在显著性水平$\alpha$​下接受原假设。

使用R语言，利用拒绝域给出检验结果：

```R
# 钢管内径数据
x <- c(100.36, 100.31, 99.99, 100.11, 100.64, 100.85, 99.42, 99.91, 99.35, 100.10)
# 原假设中的均值
mu0 <- 100
# 已知的总体标准差
sigma <- 0.5
# 显著性水平
alpha <- 0.05
# 样本数量
n <- length(x)
# 计算u检验统计量
u <- (mean(x) - mu0) / (sigma / sqrt(n))
cat("u检验统计量为：", u, "\n") # cat()函数中的意思是“concatenate”，即“连接”
# 计算拒绝域临界值
u_critical <- qnorm(1 - alpha)
cat("拒绝域临界值为：", u_critical, "\n")
# 输出拒绝域
cat(paste("拒绝域为: u >", u_critical), "\n")
# 做出决策
if (u > u_critical) {
  cat("拒绝原假设，接受备择假设")
} else {
  cat("不能拒绝原假设")
}
```

输出结果为：

```R
u检验统计量为： 0.6577538 
拒绝域临界值为： 1.644854 
拒绝域为: u > 1.64485362695147 
不能拒绝原假设
```

利用$p$值给出检验结果：

```R
# 钢管内径数据
x <- c(100.36, 100.31, 99.99, 100.11, 100.64, 100.85, 99.42, 99.91, 99.35, 100.10)
# 原假设中的均值
mu0 <- 100
# 已知的总体标准差
sigma <- 0.5
# 显著性水平
alpha <- 0.05
# 样本数量
n <- length(x)
# 计算u检验统计量
u <- (mean(x) - mu0) / (sigma / sqrt(n))
# 计算p值
p_value <- 1 - pnorm(u)
cat("p值为：", p_value, "\n")
# 做出决策
if (p_value < alpha) {
  cat("拒绝原假设，接受备择假设")
} else {
  cat("不能拒绝原假设")
}
```

输出结果为：

```R
p值为： 0.2553482 
不能拒绝原假设
```

使用R语言中的`z.test`函数：

```R
# 安装BSDA包
# install.packages("BSDA")
library(BSDA)

# 设置数据参数
x <- c(100.36, 100.31, 99.99, 100.11, 100.64, 
       100.85, 99.42, 99.91, 99.35, 100.10)

# 进行单样本z检验，mu为100，sigma为0.5，备择假设为均值>100
z.test(x, mu = 100, sigma.x = 0.5, alternative = "greater")
```

输出结为：

```R

	One-sample z-Test

data:  x
z = 0.65775, p-value = 0.2553 # z值和p值
alternative hypothesis: true mean is greater than 100 # 备择假设为均值>100
95 percent confidence interval:
 99.84393       NA # 有95%的把握认为均值>99.84393
sample estimates: # 样本均值
mean of x 
  100.104 
```

置信区间的上限是`NA`。这是因为`z.test`函数默认计算双侧置信区间，而我们的备择假设是单侧的（均值大于100）。因此，置信区间的上限没有被正确计算。

### 第二问

(2)$\sigma$未知。

**解：**
$$
H_0:\mu=100\qquad\mathrm{vs}\qquad H_1:\mu>100
$$
采用$t$检验，样本标准差为$s=0.4760$，检验统计量为
$$
t=\frac{\sqrt{n}(\overline{x}-\mu_0)}{s}
$$
拒绝域为$\{ t\ge t_{1-\alpha} \}$，其中$t_{1-\alpha}=1.8331$为$T(9)$的$1-\alpha$分位数。由样本观测值，$t_0=0.6909$，由于$t_0<t_{1-\alpha}$，因此接受原假设。

我们还可以采用检验的$p$值来判断是否拒绝原假设，此时$p$值为
$$
p=P(t\ge t_0)=0.2535
$$
因为$p>\alpha$，因此在显著性水平$\alpha$下接受原假设。

使用R语言中的`t.test`函数：

```R
# 设置数据参数
x <- c(100.36, 100.31, 99.99, 100.11, 100.64, 
       100.85, 99.42, 99.91, 99.35, 100.10)
# 进行t检验，mu为100，备择假设为均值>100
t.test(x, mu = 100, alternative = "greater")
```

输出结果为：

```R

	One Sample t-test

data:  x
t = 0.69098, df = 9, p-value = 0.2535 # t值，自由度，p值
alternative hypothesis: true mean is greater than 100 # 备择假设为均值>100
95 percent confidence interval:
 99.8281     Inf # 有95%的把握认为mu>99.8281
sample estimates:
mean of x 
  100.104  # 样本均值
```

## 第二题

12.下面给出两种型号的计算器充电以后所能使用的时间（单位：h）的观测值。
$$
\begin{align}
&\mathrm{A}:5.5,\quad 5.6,\quad 6.3,\quad 4.6,\quad 5.3,\quad 5.0,\quad 6.2,\quad 5.8,\quad 5.1,\quad 5.2,\quad 5.9\\
&\mathrm{B}:3.8,\quad 4.3,\quad 4.2,\quad 4.0,\quad 4.9,\quad 4.5,\quad 5.2,\quad 4.8,\quad 4.5,\quad 3.9,\quad 3.7,\quad 4.6
\end{align}
$$
设两样本独立且数据所属的两总体的密度函数至多差一个平移量。试问能否认为型号$\mathrm{A}$的计算器平均使用时间明显比型号$\mathrm{B}$来得长（取$\alpha=0.01$）？

**解：**待检验假设为
$$
H_0:\mu_1=\mu_2\quad\mathrm{vs}\quad H_1:\mu_1>\mu_2
$$
由于两者方差相等，所以采用$t$检验。容易知道，两样本均值为$\overline{x}=5.5,\overline{y}=4.3667$，两样本方差为$s_x^2=0.2740,s_y^2=0.2188$，因此样本检验量为
$$
t=\frac{\overline{x}-\overline{y}}{s_w\sqrt{\frac{1}{m}+\frac{1}{n}}}
$$
其中
$$
s_w^2=\frac{(m-1)s_x^2+(n-1)s_y^2}{m+n-2}
$$
拒绝域为$\{ t\ge t_{1-\alpha} \}$，其中$t_{1-\alpha}=2.5176$为$T(21)$的$1-\alpha$分位数。由样本观测值，$t_0=5.4835$，由于$t_0>t_{1-\alpha}$，因此拒绝原假设，即认为型号$\mathrm{A}$的计算器平均使用时间明显比型号$\mathrm{B}$来得长。

我们还可以采用检验的$p$值来判断是否拒绝原假设，此时$p$值为
$$
p=P(t\ge t_0)=0.000009
$$
因为$p\le\alpha$，因此在显著性水平$\alpha$下拒绝原假设，即认为型号$\mathrm{A}$的计算器平均使用时间明显比型号$\mathrm{B}$来得长。

使用R语言中的`t.test`函数：

```R
# 设置参数
A <- c(5.5, 5.6, 6.3, 4.6, 5.3, 5.0, 6.2, 5.8, 5.1, 5.2, 5.9)
B <- c(3.8, 4.3, 4.2, 4.0, 4.9, 4.5, 5.2, 4.8, 4.5, 3.9, 3.7, 4.6)

# 双样本t检验，假设两个总体方差相等，备择假设为>0，置信水平为99%
t.test(A, B, var.equal = TRUE, alternative = "greater", conf.level = 0.99)
```

输出结果为：

```R

	Two Sample t-test

data:  A and B
t = 5.4844, df = 21, p-value = 9.64e-06 # t值，自由度，p值
alternative hypothesis: true difference in means is greater than 0 # 备择假设为均值差>0
99 percent confidence interval:
 0.6130675       Inf # 有99%的把握认为均值差>0.6130675
sample estimates:
mean of x mean of y 
 5.500000  4.366667 # 样本均值
```

## 第三题

15.一药厂生产一种新的止痛片，厂方希望验证服用新药片后至开始起作用的时间间隔较原有止痛片至少缩短一半，因此厂方提出需检验假设
$$
H_0:\mu_1=2\mu_2\qquad\mathrm{vs}\qquad H_1:\mu_1>2\mu_2
$$
此处$\mu_1,\mu_2$分别是服用原有止痛片和服用新止痛片后至开始起作用的时间间隔的总体的均值。设两总体均为正态分布且方差分别为已知值$\sigma_1^2,\sigma_2^2$，现分别在两总体中取一样本$x_1,\cdots,x_n$和$y_1,\cdots,y_m$，设两个样本独立，试给出上述假设检验问题的检验统计量及拒绝域。

**解：**待检验假设为
$$
H_0:\mu_1=2\mu_2\qquad\mathrm{vs}\qquad H_1:\mu_1>2\mu_2
$$
由于$\overline{x}-2\overline{y}\sim N(\mu_1-2\mu_2,\frac{\sigma_1^2}{n}+\frac{4\sigma_2^2}{m})$，因此统计检验量为
$$
u=\frac{\overline{x}-2\overline{y}}{\sqrt{\frac{\sigma_1^2}{n}+\frac{4\sigma_2^2}{m}}}
$$

当$H_0$成立时，$u\sim N(0,1)$，对于显著性水平$\alpha$，拒绝域为$\{ u\ge u_{1-\alpha} \}$，其中$u_{1-\alpha}$为$N(0,1)$的$1-\alpha$分位数。

## 第四题

20.为比较不同季节出生的女婴体重的方差，从去年12月和6月出生的女婴中分别随机地抽取6名及10名，测其体重如下(单位:g)：
$$
\begin{align}
&12月:3520,\quad 2960,\quad 2560,\quad 2960,\quad 3260,\quad 3960\\
&6月: 3220,\quad 3220,\quad 3760,\quad 3000,\quad 2920,\quad 3740,\quad 3060,\quad 3080,\quad 2940,\quad 3060
\end{align}
$$
假定新生女婴体重服从正态分布，问新生女婴体重的方差是否是冬季的比夏季的小（取$\alpha=0.05$）？

**解：**待检验假设为
$$
H_0:\sigma_1^2\ge\sigma_2^2\quad\mathrm{vs}\quad H_1:\sigma_1^2<\sigma_2^2
$$
采用$F$检验。容易知道，两样本方差为$s_x^2=241666.6667,s_y^2=93955.5556$，因此样本检验量为
$$
F=\frac{s_x^2}{s_y^2}
$$
拒绝域为$\{ F\le F_\alpha \}$，其中$F_\alpha=0.2095$为$F(5,9)$的$\alpha$分位数。由样本观测值，$F_0=2.5721$，由于$F_0>F_\alpha$，因此接受原假设，即不认为新生女婴体重的方差是冬季的比夏季的小。

我们还可以采用检验的$p$值来判断是否拒绝原假设，此时$p$值为
$$
p=P(F\le F_0)=0.8967
$$
因为$p>\alpha$，因此在显著性水平$\alpha$下接受原假设，即不认为新生女婴体重的方差是冬季的比夏季的小。

使用R语言中的`var.test`函数：

```R
# 设置参数
december <- c(3520, 2960, 2560, 2960, 3260, 3960)
june <- c(3220, 3220, 3760, 3000, 2920, 3740, 3060, 3080, 2940, 3060)

# 进行方差检验，备择假设为方差比值<1
var.test(december,june, alternative = "less")
```

输出结果为：

```R

	F test to compare two variances

data:  december and june
F = 2.5721, num df = 5, denom df = 9, p-value = 0.8967 # F值，两个自由度，p值
alternative hypothesis: true ratio of variances is less than 1 # 备择假设为方差比值<1
95 percent confidence interval:
  0.00000 12.27544 # 有95%的把握认为方差比值小于12.27544
sample estimates:
ratio of variances 
          2.572138 # 样本方差比值
```

## 第五题

24.两台车床生产同一种滚珠，滚珠直径服从正态分布，从中分别抽取8个和9个产品，测得其直径为
$$
\begin{align}
&甲:15.0,\quad 14.5,\quad 15.2,\quad 15.5,\quad 14.8,\quad 15.1,\quad 15.2,\quad 14.8\\
&乙:15.2,\quad 15.0,\quad 14.8,\quad 15.2,\quad 15.0,\quad 15.0,\quad 14.8,\quad 15.1,\quad 14.8
\end{align}
$$
比较两台车床生产的滚珠直径的方差是否有明显差异（取$\alpha=0.05$）。

**解：**待检验假设为
$$
H_0:\sigma_1^2=\sigma_2^2\quad\mathrm{vs}\quad H_1:\sigma_1^2\ne\sigma_2^2
$$
采用$F$检验。容易知道，两样本方差为$s_x^2=0.0955,s_y^2=0.0261$，因此样本检验量为
$$
F=\frac{s_x^2}{s_y^2}
$$
拒绝域为$\{ F\le F_{\frac{\alpha}{2}} \}$或$\{ F\ge F_{1-\frac{\alpha}{2}} \}$，其中$F_{\frac{\alpha}{2}}=0.2041$为$F(7,8)$的$\frac{\alpha}{2}$分位数,$F_{1-\frac{\alpha}{2}}=4.5286$为$F(7,8)$的$1-\frac{\alpha}{2}$分位数。由样本观测值，$F_0=3.6590$，由于$F_{\frac{\alpha}{2}}<F_0<F_{1-\frac{\alpha}{2}}$，因此接受原假设，即认为两台车床生产的滚珠直径的方差没有明显差异。

我们还可以采用检验的$p$值来判断是否拒绝原假设，此时$p$值为
$$
p=2\min\{ P(F\le F_0),P(F\ge F_0) \}=0.0892
$$
因为$p>\alpha$，因此在显著性水平$\alpha$下接受原假设，即认为两台车床生产的滚珠直径的方差没有明显差异。

使用R语言中的`var.test`函数：

```R
# 设置数据
a <- c(15.0, 14.5, 15.2, 15.5, 14.8, 15.1, 15.2, 14.8)
b <- c(15.2, 15.0, 14.8, 15.2, 15.0, 15.0, 14.8, 15.1, 14.8)
# 进行方差检验
var.test(a,b)
```

输出结果为：

```R

	F test to compare two variances

data:  a and b
F = 3.6588, num df = 7, denom df = 8, p-value = 0.08919 # F值，两个自由度，p值
alternative hypothesis: true ratio of variances is not equal to 1 # 备择假设为方差比值不为1
95 percent confidence interval:
  0.8079418 17.9257790 # 有95%的把握认为方差比值介于0.8079418和17.9257790之间
sample estimates:
ratio of variances 
          3.658815 # 样本方差比值
```

## 第六题

26.测得两批电子器件的样品的电阻（单位: $\Omega$）为
$$
\begin{align}
&\mathrm{A}:0.140,\quad 0.138,\quad 0.143,\quad 0.142,\quad 0.144,\quad 0.137\\
&\mathrm{B}:0.135,\quad 0.140,\quad 0.142,\quad 0.136,\quad 0.138,\quad 0.140
\end{align}
$$
设这两批器材的电阻值分别服从$N(\mu_1,\sigma_1^2)$和$N(\mu_2,\sigma_2^2)$，且两样本独立。

### 第一问

(1)试检验两个总体的方差是否相等（取$\alpha=0.05$）。

**解：**待检验假设为
$$
H_0:\sigma_1^2=\sigma_2^2\quad\mathrm{vs}\quad H_1:\sigma_1^2\ne\sigma_2^2
$$
采用$F$检验。容易知道，两样本均值为$\overline{x}=0.1407,\overline{y}=0.1385$，两样本标准差为$s_x=0.0028,s_y=0.0027$，因此样本检验量为
$$
F=\frac{s_x^2}{s_y^2}
$$
拒绝域为$\{ F\le F_{\frac{\alpha}{2}} \}$或$\{ F\ge F_{1-\frac{\alpha}{2}} \}$，其中$F_{\frac{\alpha}{2}}=0.1399$为$F(5,5)$的$\frac{\alpha}{2}$分位数,$F_{1-\frac{\alpha}{2}}=7.1464$为$F(5,5)$的$1-\frac{\alpha}{2}$分位数。由样本观测值，$F_0=1.0754$，由于$F_{\frac{\alpha}{2}}<F_0<F_{1-\frac{\alpha}{2}}$，因此接受原假设，即认为两个总体的方差相等。

我们还可以采用检验的$p$值来判断是否拒绝原假设，此时$p$值为
$$
p=2\min\{ P(F\le F_0),P(F\ge F_0) \}=0.9384
$$
因为$p>\alpha$，因此在显著性水平$\alpha$下接受原假设，即认为两个总体的方差相等。

使用R语言中的`var.test`函数：

```R
# 设置数据
A <- c(0.140, 0.138, 0.143, 0.142, 0.144, 0.137)
B <- c(0.135, 0.140, 0.142, 0.136, 0.138, 0.140)
# 进行方差检验
var.test(A,B)
```

输出结果为：

```R

	F test to compare two variances

data:  A and B
F = 1.2524, num df = 10, denom df = 11, p-value = 0.7145 # F值，两个自由度，p值
alternative hypothesis: true ratio of variances is not equal to 1 # 备择假设为方差比值不为1
95 percent confidence interval:
 0.3552102 4.5897718 # 有95%的把握认为方差比值介于0.3552102和4.5897718之间
sample estimates:
ratio of variances 
          1.252355 # 样本方差比值
```

### 第二问

(2)试检验两个总体的均值是否相等（取$\alpha=0.05$）。

**解：**待检验假设为
$$
H_0:\mu_1=\mu_2\quad\mathrm{vs}\quad H_1:\mu_1\ne\mu_2
$$
由(1)可认为两个总体方差相等，因此采用$t$检验。样本检验量为
$$
t=\frac{\overline{x}-\overline{y}}{s_w\sqrt{\frac{1}{m}+\frac{1}{n}}}
$$
其中
$$
s_w^2=\frac{(m-1)s_x^2+(n-1)s_y^2}{m+n-2}
$$
拒绝域为$\{ |t|\ge t_{1-\frac{\alpha}{2}} \}$，其中$t_{1-\frac{\alpha}{2}}=2.2281$为$T(10)$的$1-\frac{\alpha}{2}$分位数。由样本观测值，$t_0=1.3854$，由于$t_0<t_{1-\alpha}$，因此接受原假设，即认为两个总体的均值相等。

我们还可以采用检验的$p$值来判断是否拒绝原假设，此时$p$值为
$$
p=P(|t|\ge|t_0|)=0.1961
$$
因为$p>\alpha$，因此在显著性水平$\alpha$下接受原假设，即认为两个总体的均值相等。

使用R语言中的`t.test`函数：

```R
# 设置参数
A <- c(0.140, 0.138, 0.143, 0.142, 0.144, 0.137)
B <- c(0.135, 0.140, 0.142, 0.136, 0.138, 0.140)
# t检验，方差相等
t.test(A, B, var.equal = TRUE)
```

输出结果为：

```R

	Two Sample t-test

data:  A and B
t = 1.3718, df = 10, p-value = 0.2001 # t值，自由度，p值
alternative hypothesis: true difference in means is not equal to 0 # 备择假设为均值差不为0
95 percent confidence interval:
 -0.001352414  0.005685747 # 有95%的把握认为均值差介于-0.001352414和0.005685747之间
sample estimates:
mean of x mean of y 
0.1406667 0.1385000
```

# 习题7.3

## 第一题

2.某厂一种元件平均使用寿命为$1200\mathrm{h}$，偏低，现厂里进行技术革新，革新后任选$8$个元件进行寿命试验，测得寿命数据如下:
$$
2686,\quad 2001,\quad 2082,\quad 792,\quad 1660,\quad 4105,\quad 1416,\quad 2089
$$
假定元件寿命服从指数分布，取$\alpha=0.05$，问革新后元件的平均寿命是否有明显提高?

**解：**待检验假设为
$$
H_0:\lambda\le1200\quad\mathrm{vs}\quad H_1:\lambda>1200
$$
采用$\chi^2$检验。容易知道，样本均值为$\overline{x}=2103.875$，因此样本检验量为
$$
\chi^2=\frac{2n\overline{x}}{\lambda_0}
$$
由样本观测值，$\chi^2_0=28.0517$，检验的$p$值为
$$
p=P(\chi^2\ge \chi^2_0)=0.0312
$$
因为$p\le\alpha$，因此在显著性水平$\alpha$下拒绝原假设，即认为革新后元件的平均寿命有明显提高。

## 第二题

5.假定电话总机在单位时间内接到的呼叫次数服从泊松分布，现观测了$40$个单位时间，接到的呼叫次数如下:
$$
\begin{align}
0,\quad 2,\quad 3,\quad 2,\quad 3,\quad 2,\quad 1,\quad 0,\quad 2,\quad 2\\

1,\quad 2,\quad 2,\quad 1,\quad 3,\quad 1,\quad 1,\quad 4,\quad 1,\quad 1\\

5,\quad 1,\quad 2,\quad 2,\quad 3,\quad 3,\quad 1,\quad 3,\quad 1,\quad 3\\

4,\quad 0,\quad 6,\quad 1,\quad 1,\quad 1,\quad 4,\quad 0,\quad 1,\quad 3
\end{align}
$$
在显著性水平$\alpha=0.05$下能否认为单位时间内平均呼叫次数不低于$2.5$次？并给出检验的$p$值。

**解：**待检验假设为
$$
H_0:\lambda\ge2.5\quad\mathrm{vs}\quad H_1:\lambda<2.5
$$


采用大样本$u$检验。容易知道，样本均值为$\overline{x}=1.975$，因此样本检验量为
$$
u=\frac{\sqrt{n}(\overline{x}-\lambda)}{\sqrt{\lambda}}
$$
由样本观测值，$u_0=-2.1$，检验的$p$值为
$$
p=\Phi(u_0)=0.0179
$$
因为$p\le\alpha$，因此在显著性水平$\alpha$下拒绝原假设，即不认为单位时间内平均呼叫次数不低于$2.5$次。

# 习题7.4

## 第一题

2.设$x_1,\cdots,x_n$是来自正态分布$N(\mu,\sigma^2)$​的样本，试求如下假设的似然比检验。
$$
H_0:\sigma^2=\sigma^2_0\quad\mathrm{vs}\quad H_1:\sigma^2\ne\sigma^2_0
$$

**解：**记样本均值为$\overline{x}$，样本方差为$s^2$。

样本的联合密度函数为
$$
p(x_1,\cdots,x_n;\mu,\sigma^2)=\frac{1}{(2\pi)^{\frac{n}{2}}\sigma^n}\mathrm{e}^{-\frac{\sum_{k=1}^{n}{(x-\mu)^2}}{2\sigma^2}}
$$

$$
\ln{p(x_1,\cdots,x_n;\mu,\sigma^2)}=-\frac{\sum_{k=1}^{n}{(x-\mu)^2}}{2\sigma^2}-n\ln\sigma-\frac{n}{2}\ln{2\pi}
$$

参数空间为$\Theta_0=\{ (\mu,\sigma_0^2):\mu\in\R \}$，$\Theta=\{ (\mu,\sigma^2):\mu\in\R,\sigma^2\in\R^+ \}$。考察$\ln{p}$的偏导数
$$
\frac{\part \ln{p}}{\part\mu}=\frac{n(\overline{x}-\mu)}{\sigma^2}
$$
$$
\frac{\part \ln{p}}{\part\sigma^2}=\frac{\sum_{k=1}^{n}{(x-\mu)^2}}{2\sigma^4}-\frac{n}{2\sigma^2}=
\frac{1}{2\sigma^4}\left(\sum_{k=1}^{n}{(x-\mu)^2}-n\sigma^2\right)
$$

对于参数空间$\Theta_0$，$\hat{\mu}=\overline{x}$为$\mu$的最大似然估计；对于参数空间$\Theta$，$\hat{\mu}=\overline{x}$为$\mu$的最大似然估计，$\hat{\sigma}^2=\frac{n-1}{n}s^2$为$\sigma^2$的最大似然估计。记$\chi^2=\frac{(n-1)s^2}{\sigma_0^2}$代入上式可得似然比统计量为
$$
\Lambda=\left( \frac{\chi^2}{n}\mathrm{e}^{1-\frac{\chi^2}{n}} \right)^{-\frac{n}{2}}
$$
因此
$$
\Lambda\ge\lambda_0\iff\chi^2\le\chi^2_1\quad\mathrm{or}\quad\chi^2\ge\chi_2^2
$$
此时可以用$\chi^2$检验。

## 第二题

7.检查了一本书的$100$页，记录各页中的印刷错误的个数，其结果如下

| 错误个数 | 页数 |
| :------: | :--: |
|   $0$    | $35$ |
|   $1$    | $40$ |
|   $2$    | $19$ |
|   $3$    | $3$  |
|   $4$    | $2$  |
|   $5$    | $1$  |
| $\ge 6$  | $0$  |

问能否认为一页的印刷错误个数服从泊松分布（取$\alpha=0.05$）？试用R解决卡方拟合优度检验。

**解：**将错误个数分为如下$4$​类，分别记为$A_n$，其中$n=1,2,3,4$。
$$
0,\quad1,\quad2,\quad\ge 3
$$
考虑假设检验
$$
H_0:A_n所占的比率为p_n=\frac{\lambda^n}{n!}\mathrm{e}^{-\lambda},\quad n\in\N
$$
对于泊松分布的参数$\lambda$，容易知道$\lambda$的最大似然估计为
$$
\hat{\lambda}=\frac{1}{n}\sum_{k=0}^{\infty}{kn_k}=1
$$
那么对于原假设，每类出现的概率为
$$
\hat{p}_n=\frac{\hat{\lambda}^n}{n!}\mathrm{e}^{-\hat{\lambda}},\quad n=0,1,2
$$

$$
\hat{p}_3=1-\hat{p}_1-\hat{p}_2-\hat{p}_3
$$

代入数据可得
$$
\hat{p}_0=0.3679,\quad 
\hat{p}_1=0.3679,\quad 
\hat{p}_2=0.1839,\quad 
\hat{p}_3=0.0803
$$
考虑统计检验量
$$
\chi^2=\sum_{k=0}^{3}{\frac{(n_k-n\hat{p}_k)^2}{n\hat{p}_k}}
$$
当原假设成立时，
$$
\chi^2\xrightarrow{\mathrm{L}}\chi^2(2)
$$
代入数据可得$\chi^2_0=0.9006$，对于显著性水平$\alpha=0.05$，$\chi^2_{1-\alpha}=5.9915$为$\chi^2(2)$的$1-\alpha$分位数，因此拒绝域为$\{\chi^2\ge5.9915\}$，检验的$p$值为
$$
p=P(\chi^2\ge\chi_0^2)=0.6374
$$
因此不拒绝原假设。

使用R语言

```R
# 输入数据
# 原始数据
observed <- c(35, 40, 19, 3, 2, 1)
# 分组后的数据
observed_group <- c(35, 40, 19, 6)

# 计算泊松分布参数lambda的最大似然估计
lambda <- sum(observed * 0: 5) / sum(observed)
# lambda输出1

# 计算期望概率
expected <- dpois(0: 2, lambda) # dpois()计算泊松分布的密度函数
expected[4] <- 1 - sum(expected[1: 3])
# expected输出0.3678794 0.3678794 0.1839397 0.0803014

# 卡方拟合优度检验
test_result <- chisq.test(observed_group, p = expected)
# 这里test_result输出：
# 
# Chi-squared test for given probabilities
# 
# data:  observed_group
# X-squared = 0.90057, df = 3, p-value = 0.8253

# 赋值X-squared = 0.90057
Xsq <- test_result$statistic
# 重新赋值卡方分布的自由度
df <- length(observed_group) - 1 - 1
# 计算p值
p_value <- pchisq(Xsq, df, lower.tail = FALSE)
# 输出p值
cat("p值为：", p_value)
```

输出结果

```R
p值为： 0.6374476
```

## 第三题

15.在一项是否应提高小学生的计算机课程的比例的调查结果如下：

|         年龄         | $B_1$：同意 | $B_2$：不同意 | $B_3$：不知道 | 总和  |
| :------------------: | :---------: | :-----------: | :-----------: | :---: |
|  $A_1$：$55$岁以上   |    $32$     |     $28$      |     $14$      | $74$  |
| $A_2$：$36\sim 55$岁 |    $44$     |     $21$      |     $17$      | $82$  |
| $A_3$：$15\sim 35$岁 |    $47$     |     $12$      |     $13$      | $72$  |
|         总和         |    $123$    |     $61$      |     $44$      | $228$ |

问年龄因素是否影响了对问题的回答（取$\alpha=0.05$）？试用R解决卡方拟合优度检验。

**解：**将$A$属性记为年龄，$B$属性记为同意与否。$A$和$B$均分为$3$​类，记总体中的个体仅属于$A_i$和仅属于$B_j$的概率分别为$p_{i\cdot}$和$p_{\cdot j}$，总体中的个体同时属于$A_i$和$B_j$的概率为$p_{ij}$，那么得到二维离散分布表$\{p_{ij}\}_{3\times 3}$，$A$和$B$两属性度量的假设可表述为
$$
H_0:p_{ij}=p_{i\cdot}p_{\cdot j},\quad
i,j=1,2,3
$$
$H_0$成立时$p_{ij}$的最大似然估计为
$$
\hat{p}_{ij}=\frac{1}{228^2}\sum_{k=1}^{3}{n_{kj}}\sum_{k=1}^{3}{n_{ik}}
$$
代入数据，得到最大似然估计矩阵
$$
\hat{P}=\begin{pmatrix}
0.1751&0.0868&0.0626\\
0.1940&0.0962&0.0694\\
0.1704&0.0845&0.0609
\end{pmatrix}
$$
那么检验统计量为
$$
\chi^2=\sum_{i,j=1}^{3}{\frac{(n_{ij}-n\hat{p}_{ij})^2}{n\hat{p}_{ij}}}
$$
当原假设成立时
$$
\chi^2\xrightarrow{\mathrm{L}}\chi^2(4)
$$
代入数据可得$\chi^2_0=9.6175$，对于显著性水平$\alpha=0.05$，$\chi^2_{1-\alpha}=9.4877$为$\chi^2(4)$的$1-\alpha$分位数，因此拒绝域为$\{\chi^2\ge9.4877\}$，检验的$p$值为
$$
p=P(\chi^2\ge\chi_0^2)=0.0474
$$
因此拒绝原假设，认为年龄因素影响了对问题的回答。

使用R语言

```R
data <- matrix(c(32, 28, 14, 44, 21, 17, 47, 12, 13), nrow = 3)
chisq.test(data)
```

输出结果

```R

	Pearson's Chi-squared test

data:  data
X-squared = 9.6132, df = 4, p-value = 0.04747
```

# 习题7.5

1.在检验了一个车间生产的$20$个轴承外座圈的内径后得到下面数据 (单位：mm)
$$
\begin{align}
15.04,\quad 15.36,\quad 14.57,\quad 14.53,\quad 15.57\\
14.69,\quad 15.37,\quad 14.66,\quad 14.52,\quad 15.41\\
15.34,\quad 14.28,\quad 15.01,\quad 14.76,\quad 14.38\\
15.87,\quad 13.66,\quad 14.97,\quad 15.29,\quad 14.95
\end{align}
$$

### 第一问

使用R语言作正态概率图，并作初步判断。

**解：**代码如下

```R
par(mfrow=c(1,1)) # 设置绘图窗口为1行1列
par(mar=c(5,4,4,2)+0.1) # 设置图形边距为默认值

data <- c(15.04, 15.36, 14.57, 14.53, 15.57,
          14.69, 15.37, 14.66, 14.52, 15.41,
          15.34, 14.28, 15.01, 14.76, 14.38,
          15.87, 13.66, 14.97, 15.29, 14.95) # 定义数据集

qqnorm(data) # 绘制正态概率图
qqline(data) # 在正态概率图上添加参考线
```

输出图像

![正态概率图](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大二下\数理统计\File\W检验\正态概率图.jpg)

### 第二问

使用R语言进行W检验，判断这组数据是否来自正态分布（$\alpha=0.05$）？

**解：**代码如下

```R
data <- c(15.04, 15.36, 14.57, 14.53, 15.57,
          14.69, 15.37, 14.66, 14.52, 15.41,
          15.34, 14.28, 15.01, 14.76, 14.38,
          15.87, 13.66, 14.97, 15.29, 14.95)

shapiro.test(data)
```

输出结果

```R

	Shapiro-Wilk normality test

data:  data
W = 0.97442, p-value = 0.8439
```

由于$p\ge \alpha$，因此不拒绝原假设。

# 习题7.6

5.$9$​名学生到英语培训班学习，培训前后各进行了一次水平测验，成绩为

|   学生编号$i$   | $1$  |  $2$  | $3$  | $4$  | $5$  | $6$  |  $7$  | $8$  | $9$  |
| :-------------: | :--: | :---: | :--: | :--: | :--: | :--: | :---: | :--: | :--: |
| 入学前成绩$x_i$ | $76$ | $71$  | $70$ | $57$ | $49$ | $69$ | $65$  | $26$ | $59$ |
| 入学后成绩$y_i$ | $81$ | $85$  | $70$ | $52$ | $52$ | $63$ | $83$  | $33$ | $62$ |
|  $z_i=x_i-y_i$  | $-5$ | $-14$ | $0$  | $5$  | $-3$ | $6$  | $-18$ | $-7$ | $-3$ |

### 第一问

假设测验成绩服从正态分布，问学生的培训效果是否显著？

**解：**采用配对$t$检验

```R
# 定义入学前成绩
x <- c(76, 71, 70, 57, 49, 69, 65, 26, 59)
# 定义入学后成绩
y <- c(81, 85, 70, 52, 52, 63, 83, 33, 62)
# 进行配对t检验，备择假设为入学后的成绩比入学前的成绩有显著提升
t.test(x, y, paired=TRUE, alternative="less")
```

输出结果为

```R
	Paired t-test

data:  x and y
t = -1.6378, df = 8, p-value = 0.07004
alternative hypothesis: true mean difference is less than 0
95 percent confidence interval:
      -Inf 0.5865683
sample estimates:
mean difference 
      -4.333333 
```

如果$\alpha=0.05$，那么不能拒绝原假设，培训效果并不明显。

### 第二问

不假定总体分布，采用符号检验方法检验学生的培训效果是否显著？

**解：**代码如下

```R
# 定义入学前成绩向量x
x <- c(76, 71, 70, 57, 49, 69, 65, 26, 59)
# 定义入学后成绩向量y
y <- c(81, 85, 70, 52, 52, 63, 83, 33, 62)
# 计算入学后成绩大于入学前成绩的次数
n <- sum(y > x)
# 进行符号检验
binom.test(n, length(x), alternative="greater")
```

输出如下

```R
	Exact binomial test # 精确二项检验

data:  n and length(x)
number of successes = 6, number of trials = 9, p-value = 0.2539 # 成功次数，试验次数，p值
alternative hypothesis: true probability of success is greater than 0.5 # 备择假设为成功概率大于0.5
95 percent confidence interval:
 0.3449414 1.0000000 # 表示在95%的置信水平下，成功概率的真实值落在该区间内的概率为95%
sample estimates:
probability of success 
             0.6666667  # 成功概率的估计值
```

如果$\alpha=0.05$，那么不能拒绝原假设，培训效果并不明显。

### 第三问

采用符号秩和检验方法检验学生的培训效果是否显著，三种检验方法结论相同吗？

**解：**代码如下

```R
# 定义入学前成绩向量x
x <- c(76, 71, 70, 57, 49, 69, 65, 26, 59)
# 定义入学后成绩向量y
y <- c(81, 85, 70, 52, 52, 63, 83, 33, 62)
# 进行符号秩和检验
wilcox.test(x, y, paired=TRUE, alternative="less")
```

输入如下

```R
	Wilcoxon signed rank test with continuity correction
#   连续性校正的Wilcoxon符号秩检验

data:  x and y
V = 8.5, p-value = 0.1032
alternative hypothesis: true location shift is less than 0

# 由于数据中存在重复值或0值，无法精确计算p值
Warning messages:
1: In wilcox.test.default(x, y, paired = TRUE, alternative = "less") :
  无法精确计算带连结的p值
2: In wilcox.test.default(x, y, paired = TRUE, alternative = "less") :
  有0时无法计算精确的p值
```

如果$\alpha=0.05$，那么不能拒绝原假设，培训效果并不明显。

# 习题8.1

7.某粮食加工厂试验三种储藏方法对粮食含水率有无显著影响，现取一批粮食分成若干份，分别用三种不同的方法储藏，过一段时间后测得的含水率（单位：%）如下表：

| 储藏方法 |                     含水率                     |
| :------: | :--------------------------------------------: |
|  $A_1$   | $7.3,\quad 8.3,\quad 7.6,\quad 8.4,\quad 8.3$  |
|  $A_2$   | $5.4,\quad 7.4,\quad 7.1,\quad 6.8,\quad 5.3$  |
|  $A_3$   | $7.9,\quad 9.5,\quad 10.0,\quad 9.8,\quad 8.4$ |

### 第一问

假定各种方法储藏的粮食的含水率服从正态分布，且方差相等，试在$\alpha=0.05$下检验这三种方法对含水率有无显著影响。

**解：**代码如下

```R
# 定义数据
# method是变量名，表示储藏方法，有三种取值：A1，A2，A3
# rep是函数名，表示重复，可以用来生成重复的序列
# 例如，rep(c("A1", "A2", "A3"), each = 5)
# 表示重复向量c("A1", "A2", "A3")中的每个元素5次，得到一个长度为15的向量
# moisture是变量名，表示含水率，是一个数值型变量
data <- data.frame(
  method = rep(c("A1", "A2", "A3"), each = 5),
  moisture = c(7.3, 8.3, 7.6, 8.4, 8.3, 
               5.4, 7.4, 7.1, 6.8, 5.3, 
               7.9, 9.5, 10.0, 9.8, 8.4)
)

# 单因子方差分析
# aov是函数名，表示analysis of variance，方差分析
# moisture ~ method是一个公式，表示以含水率为因变量，以储藏方法为自变量
# data = data是一个参数，表示使用名为data的数据框作为数据来源
model <- aov(moisture ~ method, data = data)

# 查看方差分析结果
summary(model)
```

输出结果

```R
            Df   Sum Sq   Mean Sq   F value   Pr(>F)    
method      2    18.657   9.329     13.59     0.000825 ***
Residuals   12   8.236    0.686                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
```

- `Df`表示自由度，即数据中可以自由变化的部分的个数。`method`的自由度为$2$，表示储藏方法有$3$种水平，自由度等于水平数减$1$。`Residuals`的自由度为$12$，表示误差项的自由度，等于总观测数减去因素水平数。
- `Sum Sq`表示平方和，即各部分对总变异的贡献。`method`的平方和为$18.657$，表示储藏方法对含水率的变异贡献了$18.657$。`Residuals`的平方和为$8.236$，表示误差项对含水率的变异贡献了$8.236$。
- `Mean Sq`表示均方，即各部分的平方和除以对应的自由度。`method`的均方为$9.329$，表示储藏方法对含水率的平均变异。`Residuals`的均方为$0.686$，表示误差项对含水率的平均变异。
- `F value`表示$F$统计量，即各部分的均方之比。`method`的$F$统计量为$13.59$，表示储藏方法对含水率的平均变异是误差项对含水率的平均变异的$13.59$倍。
- `Pr(>F)`表示$F$统计量的$p$值，即在原假设（储藏方法对含水率无显著影响）成立时，观察到这样或更极端情况的概率。`method`的$p$值为$0.000825$，远小于显著性水平$\alpha=0.05$，因此拒绝原假设，接受备择假设（储藏方法对含水率有显著影响）。
- `Signif. codes`表示显著性代码，即根据$p$值划分不同程度的显著性。例如，\*\*\*表示$p$值小于0.001，\*\*表示$p$值在$0.001$到$0.01$之间，\*表示$p$值在$0.01$到$0.05$之间，等等。

### 第二问

对每种方法的平均含水率给出置信水平为$0.95$的置信区间。

**解：**代码如下

```R
# 定义数据
# method是变量名，表示储藏方法，有三种取值：A1，A2，A3
# rep是函数名，表示重复，可以用来生成重复的序列
# 例如，rep(c("A1", "A2", "A3"), each = 5)
# 表示重复向量c("A1", "A2", "A3")中的每个元素5次，得到一个长度为15的向量
# moisture是变量名，表示含水率，是一个数值型变量
data <- data.frame(
  method = rep(c("A1", "A2", "A3"), each = 5),
  moisture = c(7.3, 8.3, 7.6, 8.4, 8.3, 
               5.4, 7.4, 7.1, 6.8, 5.3, 
               7.9, 9.5, 10.0, 9.8, 8.4)
)

# 单因子方差分析
# aov是函数名，表示analysis of variance，方差分析
# moisture ~ method是一个公式，表示以含水率为因变量，以储藏方法为自变量
# data = data是一个参数，表示使用名为data的数据框作为数据来源
model <- aov(moisture ~ method, data = data)

# 查看置信区间
confint(model)
```

输出结果

```R
              2.5 %         97.5 %
(Intercept)   7.172760383   8.7872396
methodA2     -2.721609214   -0.4383908
methodA3     -0.001609214   2.2816092
```

- `(Intercept)`表示截距项，也就是当储藏方法为$A_1$时的平均含水率的估计值，它的置信区间为$(7.17, 8.79)$，也就是说，我们有$95\%$的把握认为$A_1$方法的真实平均含水率在这个区间内。
- `methodA2`表示储藏方法为$A_2$时相对于$A_1$时的平均含水率的差异，它的置信区间为$(-2.72, -0.44)$，也就是说，我们有$95\%$的把握认为$A_2$方法的平均含水率比$A_1$方法低$2.72\%$到$0.44\%$之间。
- `methodA3`表示储藏方法为$A_3$时相对于$A_1$时的平均含水率的差异，它的置信区间为$(-0.00, 2.28)$，也就是说，我们有$95\%$的把握认为$A_3$方法的平均含水率比$A_1$方法高$0\%$到$2.28\%$之间。

# 习题8.2

1.某粮食加工厂试验三种储藏方法对粮食含水率有无显著影响，现取一批粮食分成若干份，分别用三种不同的方法储藏，过一段时间后测得的含水率（单位：%）如下表。对三种储藏方法的平均含水率在$\alpha=0.05$下做多重比较。

| 储藏方法 |                     含水率                     |
| :------: | :--------------------------------------------: |
|  $A_1$   | $7.3,\quad 8.3,\quad 7.6,\quad 8.4,\quad 8.3$  |
|  $A_2$   | $5.4,\quad 7.4,\quad 7.1,\quad 6.8,\quad 5.3$  |
|  $A_3$   | $7.9,\quad 9.5,\quad 10.0,\quad 9.8,\quad 8.4$ |

**解：**容易得到
$$
r=3,\quad m=5,\quad n=15
$$

各水平均值为
$$
\overline{y}_1=7.98,\quad \overline{y}_2=6.4,\quad \overline{y}_3=9.12
$$

误差平方和和自由量为
$$
S_e=\sum_{i,j}{y_{ij}^2}-\frac{1}{m}\sum_{i=1}^{r}{T_i^2}=8.236,\quad f_e=n-r=12
$$

$\sigma$的最大似然估计为
$$
\hat{\sigma}=\sqrt{\frac{S_r}{f_e}}=0.8285
$$

$t$化极差统计量为$q(3,12)$，其$1-\alpha$分位数为$q_{1-\alpha}=3.67$，因此
$$
c=q_{1-\alpha}\frac{\hat{\sigma}}{\sqrt{m}}=1.3598
$$
而
$$
\begin{align}
|\overline{y}_1-\overline{y}_2|=1.58\ge c\\
|\overline{y}_2-\overline{y}_3|=2.72\ge c\\
|\overline{y}_3-\overline{y}_1|=1.14<c
\end{align}
$$
因此$A_1$和$A_2$存在显著差异，$A_2$和$A_3$存在显著差异，$A_3$和$A_1$不存在显著差异。

使用R语言

```R
# 定义数据
# method是变量名，表示储藏方法，有三种取值：A1，A2，A3
# rep是函数名，表示重复，可以用来生成重复的序列
# 例如，rep(c("A1", "A2", "A3"), each = 5)
# 表示重复向量c("A1", "A2", "A3")中的每个元素5次，得到一个长度为15的向量
# moisture是变量名，表示含水率，是一个数值型变量
data <- data.frame(
  method = rep(c("A1", "A2", "A3"), each = 5),
  moisture = c(7.3, 8.3, 7.6, 8.4, 8.3, 
               5.4, 7.4, 7.1, 6.8, 5.3, 
               7.9, 9.5, 10.0, 9.8, 8.4)
)

# 单因子方差分析
# aov是函数名，表示analysis of variance，方差分析
# moisture ~ method是一个公式，表示以含水率为因变量，以储藏方法为自变量
# data = data是一个参数，表示使用名为data的数据框作为数据来源
model <- aov(moisture ~ method, data = data)

# 进行Tukey进行多重比较
TukeyHSD(model)
```

输出结果

```R
  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = moisture ~ method, data = data)

$method
       diff   lwr            upr           p adj
#      差      置信区间的下限   置信区间的上线  调整后的p值
A2-A1 -1.58    -2.9778519    -0.1821481    0.0269634
A3-A1  1.14    -0.2578519    2.5378519     0.1161470
A3-A2  2.72    1.3221481     4.1178519     0.0006092
```

# 习题8.3

4.在入户推销上有五种方法，某大公司相比较这五种方法有无显著的效果差异，设计了一项实验：从应聘的且无推销经验的人员中随机挑选一部分人，将他们随机地分为五个组，每一组用一种推销方法进行培训，培训相同时间后观察他们在一个月内的推销额（单位：千元），数据如下。分别使用Hartley检验和Bartlett检验在显著性水平$\alpha=0.05$下对五个总体作方差齐性检验。

|  组别  |                            推销额                            |
| :----: | :----------------------------------------------------------: |
| 第一组 | $20.0,\quad 16.8,\quad 17.9,\quad 21.2,\quad 23.9,\quad 26.8,\quad 22.4$ |
| 第二组 | $24.9,\quad 21.3,\quad 22.6,\quad 30.2,\quad 29.9,\quad 22.5,\quad 20.7$ |
| 第三组 | $16.0,\quad 20.1,\quad 17.3,\quad 20.9,\quad 22.0,\quad 26.8,\quad 20.8$ |
| 第四组 | $17.5,\quad 18.2,\quad 20.2,\quad 17.7,\quad 19.1,\quad 18.4,\quad 16.5$ |
| 第五组 | $25.2,\quad 26.2,\quad 26.9,\quad 29.3,\quad 30.4,\quad 29.7,\quad 28.2$ |

**解：**原假设为
$$
H_0:\sigma_1^2=\cdots=\sigma_r^2
$$
Hartley检验

容易知道$m=7$，$r=5$，且
$$
\overline{y}_1=21.3,\quad 
\overline{y}_2=24.6,\quad 
\overline{y}_3=20.6,\quad 
\overline{y}_4=18.2,\quad 
\overline{y}_5=28.0
$$
于是由
$$
s_i^2=\frac{1}{m-1}\sum_{k=1}^{m}(y_{ij}-\overline{y}_i)^2
$$
可知
$$
s_1^2=11.9548,\quad 
s_2^2=15.6748,\quad 
s_3^2=12.1362,\quad 
s_4^2=1.4124,\quad 
s_5^2=3.7781
$$

检验统计量为
$$
H=\frac{\max\{ s_i^2 \}}{\min\{s_i^2\}}\sim H(5,6)
$$
代入数据，$H_0=11.0980$，而拒绝域为$W=\{ H\ge 12.1 \}$，因此不拒绝原假设。

Bartlett检验

由
$$
Q_i=\sum_{k=1}^{m_i}(y_{ij}-\overline{y}_i)^2=f_i s_i^2
,\qquad f_i=m-1
$$
可知
$$
Q_1=71.7286,\quad  
Q_2=94.0486,\quad 
Q_3=72.8171,\quad 
Q_4=8.4743,\quad
Q_5=22.6686
$$
$$
f_1=f_2=f_3=f_4=f_5=6
$$
而$f_e=30$，于是$s_i^2$的算术加权平均为
$$
\mathrm{MS}_e=\frac{1}{f_e}\sum_{i=1}^{r}Q_i=8.9912
$$
加权几何平均为
$$
\mathrm{GMS}_e=\left( \prod_{i=1}^{r}(s_i^2)^{f_i} \right)^{\frac{1}{f_e}}=6.5586
$$
又
$$
C=1+\frac{1}{3(r-1)}\left( \sum_{i=1}^{r}\frac{1}{f_i}-\frac{1}{f_e} \right)=1.0667
$$
从而检验统计量为
$$
B=\frac{f_e}{C}\ln\frac{\mathrm{MS}_e}{\mathrm{GMS}_e}\dot{\sim} \chi^2(4)
$$
代入数据，$B_0=8.8723$，而拒绝域为$W=\{ B\ge 9.4877 \}$，因此不拒绝原假设。

使用R语言

```R
# 创建一个数据框，包含推销额和组别
data <- data.frame(
  sales = c(20.0, 16.8, 17.9, 21.2, 23.9, 26.8, 22.4,
            24.9, 21.3, 22.6, 30.2, 29.9, 22.5, 20.7,
            16.0, 20.1, 17.3, 20.9, 22.0, 26.8, 20.8,
            17.5, 18.2, 20.2, 17.7, 19.1, 18.4, 16.5,
            25.2, 26.2, 26.9, 29.3, 30.4, 29.7, 28.2),
  group = factor(rep(1: 5, each = 7))
)
# 进行Bartlett检验，检验五个总体的方差是否相等
bartlett.test(sales ~ group, data = data)
```

输出结果

```R

	Bartlett test of homogeneity of variances

data:  sales by group
Bartlett's K-squared = 8.8728, df = 4, p-value = 0.06436
```

# 习题8.4

## 第一题

1.假设回归直线过原点，记回归模型为
$$
\begin{cases}
y_i=\beta x_i+\varepsilon_i\\
\varepsilon_i相互独立\\
\varepsilon_i\sim N(0,\sigma^2)
\end{cases}
$$

### 第一问

写出$\beta$的最小二乘估计，和$\sigma^2$的无偏估计。

**解：**设$\beta$的最小二乘估计为$\hat{\beta}$，那么成立
$$
\hat{\beta}=\inf\left\{ \beta\in\R:\sum_{i=1}^{n}(y_i-\beta x_i)^2 \right\}
$$
考察此下确界，注意到
$$
\sum_{i=1}^{n}(y_i-\beta x_i)^2=\left(\sum_{i=1}^{n}{x_i^2}\right)\beta^2-2\left(\sum_{i=1}^{n}{x_iy_i}\right)\beta+\left(\sum_{i=1}^{n}{y_i^2}\right)
$$
因此


$$
\hat{\beta}=\frac{\sum{x_iy_i}}{\sum{x_i^2}}
$$
容易知道
$$
E(\hat{\beta})=\frac{\sum{x_iE(y_i)}}{\sum{x_i^2}}=\beta
$$

$$
\mathrm{Var}(\hat{\beta})=\frac{\sum{x_i^2\mathrm{Var}(y_i)}}{\left(\sum{x_i^2}\right)^2}=\frac{\sigma^2}{\sum{x_i^2}}
$$

而残差平方和为
$$
S_e
=\sum_{i=1}^{n}(y_i-\hat{y}_i)^2
=\sum_{i=1}^{n}(\beta-\hat{\beta})^2x_i^2
+\sum_{i=1}^{n}\varepsilon_i^2
+2\sum_{i=1}^{n}(\beta-\hat{\beta})x_i\varepsilon_i
$$
又对于固定的$k$，当$i\ne k$时，由$y_i$和$\varepsilon_k$的独立性
$$
E(\hat{\beta}\varepsilon_k)=\frac{x_k\sigma^2}{\sum{x_i^2}}
$$
于是
$$
E(S_e)=(n-1)\sigma^2
$$
进而$\sigma^2$的无偏估计为$\frac{S_e}{n-1}$。

### 第二问

对给定的$x_0$，其对应的因变量的均值的估计为$\hat{y}_0$，求$\mathrm{Var}(\hat{y}_0)$。

**解：**由$\hat{y}_0=\hat{\beta}x_0$，可知
$$
\mathrm{Var}(\hat{y}_0)=x_0^2\mathrm{Var}(\hat{\beta})=\frac{x_0^2\sigma^2}{\sum{x_i^2}}
$$

## 第二题

2.设回归模型为
$$
\begin{cases}
y_i=\beta_0+\beta x_i+\varepsilon_i\\
\varepsilon_i相互独立\\
\varepsilon_i\sim N(0,\sigma^2)
\end{cases}
$$
试求$\beta_0$和$\beta$的最大似然估计，它们与其最小二乘估计一致吗?

**解：**似然函数为
$$
L=\frac{1}{(2\pi)^{\frac{n}{2}}\sigma^n}\mathrm{e}^{-\frac{\sum{(y_i-(\beta_0+\beta x_i))^2}}{2\sigma^2}}
$$
对数似然函数为
$$
\ln L=-\frac{\sum{(y_i-(\beta_0+\beta x_i))^2}}{2\sigma^2}-\frac{n}{2}\ln{2\pi}-n\ln\sigma
$$
当$\ln L$取最大值时，$\sum{(y_i-(\beta_0+\beta x_i))^2}$取最小，此为最小二乘误差项，于是$\beta_0$和$\beta$​的最大似然估计与其最小二乘估计一致，即
$$
\begin{align}
&\hat{\beta}=\frac{l_{xy}}{l_{xx}}\\
& \hat{\beta}_0=\overline{y}-\hat{\beta}\overline{x}
\end{align}
$$

## 第三题

8.现收集了$16$组合金钢中的碳含量$x$及强度$y$的数据，求得
$$
\overline{x}=0.125,\quad 
\overline{y}=45.7886,\quad 
l_{xx}=0.3024,\quad 
l_{xy}=25.5218,\quad 
l_{yy}=2432.4566
$$

### 第一问

建立$y$关于$x$的一元线性回归方程$\hat{y}=\hat{\beta}_0+\hat{\beta}x$。

**解：**由最小二乘估计
$$
\begin{align}
&\hat{\beta}=\frac{l_{xy}}{l_{xx}}=84.3975\\
& \hat{\beta}_0=\overline{y}-\hat{\beta}\overline{x}=37.2389
\end{align}
$$
于是$y$关于$x$的一元线性回归方程为
$$
\hat{y}=37.2389+84.3975x
$$

### 第二问

写出$\hat{\beta}_0$和$\hat{\beta}$的分布。

**解：**
$$
\begin{align}
&\hat{\beta}_0\sim N\left( \beta_0,\left(\frac{1}{n}+\frac{\overline{x}^2}{l_{xx}}\right)\sigma^2 \right)=N(\beta_0,0.1142\sigma^2)\\

&\hat{\beta}\sim N\left( \beta,\frac{\sigma^2}{l_{xx}} \right)=N(\beta,3.3069\sigma^2)
\end{align}
$$

### 第三问

求$\hat{\beta}_0$和$\hat{\beta}$的相关系数。

**解：**由于
$$
\mathrm{Cov}(\hat{\beta}_0,\hat{\beta})=-\frac{\overline{x}}{l_{xx}}\sigma^2=-0.4134\sigma^2
$$
那么
$$
\rho=\frac{\mathrm{Cov}(\hat{\beta}_0,\hat{\beta})}{\sqrt{\mathrm{Var}(\hat{\beta}_0)\mathrm{Var}(\hat{\beta})}}=-0.6727
$$

### 第四问

列出对回归方程作显著性检验的方差分析表，取$\alpha=0.05$。

**解：**显著性假设检验：
$$
H_0:\beta=0\quad \mathrm{vs} \quad H_a:\beta\ne0
$$

方差分析表为

| 来源 |     平方和      |  自由度  |           均方            |    $F$比     |
| :--: | :-------------: | :------: | :-----------------------: | :----------: |
| 回归 | $S_R=2153.9758$ | $f_R=1$  | $\mathrm{MS}_R=2153.9758$ | $F=108.2862$ |
| 残差 | $S_e=278.4808$  | $f_e=14$ |  $\mathrm{MS}_e=19.8915$  |              |
| 总和 | $S_T=2432.4566$ | $f_T=15$ |                           |              |

而$F(1,14)$的$1-\alpha$分位数为$4.6001$，于是拒绝域为$W=\{ F\ge 4.6001 \}$，因此拒绝原假设，认为在显著性$\alpha=0.05$下回归方程是显著的。

### 第五问

给出$\beta$的$0.95$置信区间。

**解：**由于
$$
\hat{\beta}\sim N\left( \beta,\frac{\sigma^2}{l_{xx}} \right),\qquad \frac{S_e}{\sigma^2}\sim \chi^2(n-2)
$$
且$\hat{\beta}$与$\frac{S_e}{n-2}$相互独立，那么
$$
\sqrt{\frac{(n-2)l_{xx}}{S_e}}(\hat{\beta}-\beta)\sim T(n-2)
$$
于是当$\alpha=0.05$时，$\beta$的$1-\alpha$置信区间为
$$
\left[
\hat{\beta}-t_{1-\frac{\alpha}{2}}\sqrt{\frac{S_e}{(n-2)l_{xx}}},\quad 
\hat{\beta}+t_{1-\frac{\alpha}{2}}\sqrt{\frac{S_e}{(n-2)l_{xx}}}
\right]
$$
代入数据，并注意到$t_{1-\frac{\alpha}{2}}=2.1448$，可知$\beta$的$0.95$置信区间为$[67.0023,101.7927]$。

### 第六问

在$x_0=0.15$时求对应的$y_0$的$0.95$预测区间。

**解：**由于
$$
\frac{y_0-\hat{y}_0}{\sqrt{\frac{S_e}{n-2}}\sqrt{1+\frac{1}{n}+\frac{(x_0-\overline{x})^2}{l_{xx}}}}\sim T(n-2)
$$
那么$y_0$的$1-\alpha$​预测区间为
$$
\left[
\hat{y}_0-t_{1-\frac{\alpha}{2}}\sqrt{\frac{S_e}{n-2}}\sqrt{1+\frac{1}{n}+\frac{(x_0-\overline{x})^2}{l_{xx}}},\quad 
\hat{y}_0+t_{1-\frac{\alpha}{2}}\sqrt{\frac{S_e}{n-2}}\sqrt{1+\frac{1}{n}+\frac{(x_0-\overline{x})^2}{l_{xx}}}
\right]
$$
代入数据可知，$y_0$的$0.95$预测区间为$[38.0287,57.7683]$。


## 第四题

11.我们知道营业税税收总额$y$与社会商品零售总额$x$有关为能从社会商品零售总额去预测税收总额,需要了解两者之间的关系现收集了如下$9$组数据（单位：亿元）：

| 序号 | 社会商品零售额$x$ | 营业税税收总额$y$ |
| :--: | :---------------: | :---------------: |
| $1$  |     $142.08$      |      $3.93$       |
| $2$  |     $177.30$      |      $5.96$       |
| $3$  |     $204.68$      |      $7.85$       |
| $4$  |     $242.68$      |      $9.82$       |
| $5$  |     $316.24$      |      $12.50$      |
| $6$  |     $341.99$      |      $15.55$      |
| $7$  |     $332.69$      |      $15.79$      |
| $8$  |     $389.29$      |      $16.39$      |
| $9$  |     $453.40$      |      $18.45$      |

### 第一问

画散点图。

**解：**代码如下

```R
# 定义数据
x <- c(142.08, 177.30, 204.68, 242.68, 316.24, 341.99, 332.69, 389.29, 453.40)
y <- c(3.93, 5.96, 7.85, 9.82, 12.50, 15.55, 15.79, 16.39, 18.45)

# 绘制散点图
plot(x, y, xlab = "社会商品零售额", ylab = "营业税税收总额", main = "散点图")
```

输出图像

![散点图](D:\OneDrive - stu.hebut.edu.cn\文件\我的大学\学习\学科\大二下\数理统计\File\一元线性回归\散点图.jpg)

### 第二问

建立一元线性回归方程，并作显著性检验取$\alpha=0.05$，列出方差分析表。

**解：**代码如下

```R
# 定义数据
x <- c(142.08, 177.30, 204.68, 242.68, 316.24, 341.99, 332.69, 389.29, 453.40)
y <- c(3.93, 5.96, 7.85, 9.82, 12.50, 15.55, 15.79, 16.39, 18.45)

# 构建线性回归模型
model <- lm(y ~ x)

# 输出回归方程
cat("回归方程: ")
print(model)

# 进行方差分析
anova_result <- anova(model)

# 输出方差分析表
cat("\n方差分析表:")
print(anova_result)
```

输出结果

```R
回归方程: 
Call:
lm(formula = y ~ x)

# 最小二乘估计
Coefficients:
(Intercept)            x  
   -2.25822      0.04867 
#  常数项         一次项


方差分析表:Analysis of Variance Table

Response: y
#          自由度 平凡和    均方和     F统计量    p值
           Df    Sum Sq   Mean Sq   F value   Pr(>F)    
x          1     203.403  203.403   179.65    3.017e-06 *** # 自变量
Residuals  7     7.925    1.132                             # 残差
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
```

### 第三问

若已知某年社会商品零售额为$300$亿元，试给出营业税税收总额的概率为$0.95$的预测区间。

**解：**代码如下

```R
# 定义数据
x <- c(142.08, 177.30, 204.68, 242.68, 316.24, 341.99, 332.69, 389.29, 453.40)
y <- c(3.93, 5.96, 7.85, 9.82, 12.50, 15.55, 15.79, 16.39, 18.45)

# 构建线性回归模型
model <- lm(y ~ x)

# 预测社会商品零售总额为300亿元时的营业税税收总额
newdata <- data.frame(x = 300)
prediction <- predict(model, newdata)

# 计算预测区间
alpha <- 0.95  # 置信水平
n <- length(x)  # 样本数量
t_value <- qt(1 - (1 - alpha) / 2, df = n - 2)  # t分布的临界值
SE <- summary(model)$sigma  # 残差标准误
prediction_interval <- prediction + c(-1, 1) * t_value * SE

# 输出结果
print(paste0("预测的营业税税收总额的", alpha*100, "%置信区间为:"))
print(prediction_interval)
```

输出结果

```R
"预测的营业税税收总额的95%置信区间为:"
9.82726 14.85944
```


### 第四问

若已知回归直线过原点，试求回归方程并在显著性水平$\alpha=0.05$下作显著性检验。

**解：**代码如下

```R
# 定义数据
x <- c(142.08, 177.30, 204.68, 242.68, 316.24, 341.99, 332.69, 389.29, 453.40)
y <- c(3.93, 5.96, 7.85, 9.82, 12.50, 15.55, 15.79, 16.39, 18.45)

# 构建线性回归模型（不包含截距）
model <- lm(y ~ x - 1)

# 输出回归方程
cat("回归方程: ")
print(model)

# 进行显著性检验
summary_result <- summary(model)

# 输出显著性检验结果
cat("\n显著性检验结果:")
print(summary_result)
```

输出结果

```R
回归方程: 
Call:
lm(formula = y ~ x - 1)

# 最小二乘估计
Coefficients:
      x  
0.04166  


显著性检验结果:
Call:
lm(formula = y ~ x - 1)

Residuals: # 残差
# 最小值     第一四分位数 中位数     第三四分位数 最大值
  Min       1Q         Median    3Q         Max 
  -1.9887   -0.6765    -0.4376   0.1731     1.9309 

Coefficients:
#   估计值      标准误差      t统计量     p值
    Estimate   Std. Error   t value   Pr(>|t|)    
x   0.041658   0.001373     30.33     1.52e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.257 on 8 degrees of freedom # 残差标准误差与自由度
Multiple R-squared:  0.9914,	Adjusted R-squared:  0.9903 # 多重R平方与调整R平方
F-statistic:   920 on 1 and 8 DF,  p-value: 1.515e-09 # F统计量，自由度和p值
```
